
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Proof Graph Visualization</title>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
        <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.css" rel="stylesheet" type="text/css" />
        <style>
            body {
                margin: 0;
                padding: 0;
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
                height: 100vh;
                overflow: hidden;
            }
            
            .container {
                display: flex;
                height: 100vh;
                background: #f0f0f0;
            }
            
            #left-panel {
                flex: 1;
                display: flex;
                flex-direction: column;
                background: white;
                border-right: 2px solid #ddd;
                height: 100vh;
                overflow: hidden;
            }
            
            #proof-str-panel {
                background: #f8f9fa;
                border-bottom: 2px solid #ddd;
                padding: 15px;
                height: 200px;
                overflow-y: auto;
                flex-shrink: 0;
            }
            
            #proof-str-title {
                font-weight: 600;
                color: #2d3748;
                margin-bottom: 10px;
                font-size: 14px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
            
            #proof-str-content {
                color: #4a5568;
                line-height: 1.6;
                white-space: pre-wrap;
                word-wrap: break-word;
                font-family: 'Monaco', 'Courier New', monospace;
                font-size: 13px;
                background: white;
                padding: 12px;
                border-radius: 4px;
                border: 1px solid #e2e8f0;
            }
            
            #graph-container {
                flex: 1;
                position: relative;
                background: white;
                min-height: 0;
                overflow: hidden;
            }
            
            #mynetwork {
                width: 100%;
                height: 100%;
            }
            
            #info-panel {
                width: 40%;
                max-width: 600px;
                background: white;
                overflow-y: auto;
                padding: 20px;
                box-shadow: -2px 0 10px rgba(0,0,0,0.1);
            }
            
            #info-panel.hidden {
                display: none;
            }
            
            .info-header {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                padding: 15px;
                border-radius: 8px;
                margin-bottom: 20px;
            }
            
            .info-header h2 {
                margin: 0;
                font-size: 24px;
            }
            
            .info-header .node-type {
                opacity: 0.9;
                font-size: 14px;
                margin-top: 5px;
            }
            
            .field-group {
                background: #f8f9fa;
                border-left: 4px solid #667eea;
                padding: 15px;
                margin-bottom: 15px;
                border-radius: 4px;
            }
            
            .field-name {
                font-weight: 600;
                color: #2d3748;
                margin-bottom: 8px;
                font-size: 14px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
            
            .field-value {
                color: #4a5568;
                line-height: 1.6;
                white-space: pre-wrap;
                word-wrap: break-word;
                font-family: 'Monaco', 'Courier New', monospace;
                font-size: 13px;
            }
            
            .field-value.code {
                color: #4a5568;
                padding: 12px;
                border-radius: 4px;
                overflow-x: auto;
            }
            
            .sub-dict {
                background: #ffffff;
                border: 1px solid #e2e8f0;
                border-radius: 4px;
                padding: 10px;
                margin: 8px 0;
                box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            }
            
            .sub-dict-title {
                font-weight: 600;
                color: #4a5568;
                margin-bottom: 8px;
                font-size: 12px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                border-bottom: 1px solid #e2e8f0;
                padding-bottom: 4px;
            }
            
            .sub-dict-content {
                color: #2d3748;
                line-height: 1.5;
                font-size: 12px;
            }
            
            .placeholder {
                text-align: center;
                color: #718096;
                padding: 40px;
                font-size: 18px;
            }
            
            .placeholder-icon {
                font-size: 48px;
                margin-bottom: 20px;
                opacity: 0.3;
            }
            
            #toggle-panel {
                position: absolute;
                right: 10px;
                top: 10px;
                z-index: 1000;
                background: #667eea;
                color: white;
                border: none;
                padding: 10px 20px;
                border-radius: 5px;
                cursor: pointer;
                font-size: 14px;
                transition: background 0.3s;
            }
            
            #toggle-panel:hover {
                background: #764ba2;
            }
            
            .legend {
                position: absolute;
                top: 20px;
                left: 20px;
                background: white;
                padding: 15px;
                border-radius: 8px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
                z-index: 100;
                max-width: 300px;
            }
            
            .legend-section {
                margin-bottom: 15px;
            }
            
            .legend-section:last-child {
                margin-bottom: 0;
            }
            
            .legend-title {
                font-weight: 600;
                font-size: 12px;
                color: #2d3748;
                margin-bottom: 8px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                border-bottom: 1px solid #e2e8f0;
                padding-bottom: 4px;
            }
            
            .legend-item {
                display: flex;
                align-items: center;
                margin-bottom: 8px;
            }
            
            .legend-item:last-child {
                margin-bottom: 0;
            }
            
            .legend-color {
                width: 20px;
                height: 20px;
                margin-right: 10px;
                border-radius: 3px;
            }
            
            .resizer {
                background: #ddd;
                cursor: col-resize;
                width: 4px;
                height: 100%;
                position: absolute;
                right: 0;
                top: 0;
                z-index: 1000;
            }
            
            .resizer:hover {
                background: #bbb;
            }
            
            .resizer-vertical {
                background: #ddd;
                cursor: row-resize;
                height: 4px;
                width: 100%;
                position: absolute;
                bottom: 0;
                left: 0;
                z-index: 1000;
            }
            
            .resizer-vertical:hover {
                background: #bbb;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div id="left-panel">
                <div id="proof-str-panel">
                    <div id="proof-str-title">Informal theorem and proof</div>
                    <div id="proof-str-content">Theorem: For any integer~$a$,
$$
\sum_{n=0}^{p-1} \zeta^{an} = \begin{cases}
        p & 	ext{\rm if $a \con 0\pmod{p}$,}\\
        0 & 	ext{\rm otherwise.}  \end{cases}
$$

Proof: If $a\con 0\pmod{p}$, then $\zeta^a=1$, so the sum equals the number of summands,
which is~$p$.  If $a
ot\con 0\pmod{p}$, then we use the
identity $$x^p - 1 = (x-1)(x^{p-1} + \cdots + x + 1)$$ with $x = \zeta^a$. We have
 $\zeta^a
eq 1$, so $\zeta^a - 1 
eq 0$ and
$$
\sum_{n=0}^{p-1} \zeta^{an} = \frac{\zeta^{ap}-1}{\zeta^a-1} =
\frac{1-1}{\zeta^a-1} = 0.
$$
</div>
                    <div class="resizer-vertical" id="vertical-resizer"></div>
                </div>
                <div id="graph-container">
                    <button id="toggle-panel" onclick="togglePanel()">Toggle Info Panel</button>
                    <div class="legend">
                        <div class="legend-section">
                            <div class="legend-title">Node Types</div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #eba0a0;"></div>
                                <span>Theorem Conditions (tc)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #cfb795 ;"></div>
                                <span>Theorem Definitions (def)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #8dafcc;"></div>
                                <span>Lemmas (l)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #a3c2a8;"></div>
                                <span>Theorem Solutions (ts)</span>
                            </div>

                        </div>
                        <div class="legend-section">
                            <div class="legend-title">Verification Status</div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #fa2c07;"></div>
                                <span>Formalization failed</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #FFA500;"></div>
                                <span>Formalization passed</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #00ff00;"></div>
                                <span>Fully verified</span>
                            </div>
                        </div>
                    </div>
                    <div id="mynetwork"></div>
                </div>
            </div>
            
            <div class="resizer" id="horizontal-resizer"></div>
            
            <div id="info-panel">
                <div id="info-content">
                    <div class="placeholder">
                        <div class="placeholder-icon">📊</div>
                        <p>Click on a node to view its details</p>
                    </div>
                </div>
            </div>
        </div>
        
        <script type="text/javascript">
            // Store node information
            var nodeInfo = {"tc_1": {"id": "tc_1", "natural_language": "The theorem concerns a sum involving \u03b6 and p, where the conditions on these variables are implicit. The proof's logic implies p is a prime and \u03b6 is a primitive p-th root of unity.", "statement": "Premise:\n\u2022 p is a prime number and \u03b6 is a primitive p-th root of unity, satisfying \u03b6^p = 1 and \u03b6^k \u2260 1 for 1 \u2264 k < p [tc_1].", "dependencies": [], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nvariable\n  (p : \u2115)\n  (tc_1 : p.Prime)\n  (\u03b6 : \u2102)\n  (h_zeta_p : \u03b6 ^ p = 1)\n  (h_zeta_ne_1 : \u2200 k : \u2115, 1 \u2264 k \u2192 k < p \u2192 \u03b6 ^ k \u2260 1)", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The Lean formalization `p.Prime` correctly captures that p is a prime number", "The Lean formalization declares \u03b6 as a complex number and the conditions `h_zeta_p` and `h_zeta_ne_1` together establish that \u03b6 is a primitive p-th root of unity, which perfectly matches the natural language statement", "The Lean condition `h_zeta_p : \u03b6 ^ p = 1` exactly matches the mathematical statement \u03b6^p = 1", "The Lean condition `h_zeta_ne_1 : \u2200 k : \u2115, 1 \u2264 k \u2192 k < p \u2192 \u03b6 ^ k \u2260 1` precisely captures the condition \u03b6^k \u2260 1 for 1 \u2264 k < p using universal quantification"]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "type": "condition"}, "tc_2": {"id": "tc_2", "natural_language": "For any integer a", "statement": "Premise:\n\u2022 p is a prime number and \u03b6 is a primitive p-th root of unity, satisfying \u03b6^p = 1 and \u03b6^k \u2260 1 for 1 \u2264 k < p [tc_1];\n\u2022 a is an integer [tc_2].", "dependencies": ["tc_1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nvariable\n  (p : \u2115)\n  (tc_1 : p.Prime)\n  (\u03b6 : \u2102)\n  (h_zeta_p : \u03b6 ^ p = 1)\n  (h_zeta_ne_1 : \u2200 k : \u2115, 1 \u2264 k \u2192 k < p \u2192 \u03b6 ^ k \u2260 1)\n  (a : \u2124)", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The Lean formalization `p.Prime` correctly captures that p is a prime number", "The Lean formalization declares \u03b6 as a complex number and the conditions h_zeta_p and h_zeta_ne_1 together establish that \u03b6 is a primitive p-th root of unity, which perfectly matches the natural language", "The Lean condition `h_zeta_p : \u03b6 ^ p = 1` exactly matches the mathematical statement \u03b6^p = 1", "The Lean condition `h_zeta_ne_1 : \u2200 k : \u2115, 1 \u2264 k \u2192 k < p \u2192 \u03b6 ^ k \u2260 1` precisely captures the condition \u03b6^k \u2260 1 for 1 \u2264 k < p", "The Lean declaration `(a : \u2124)` correctly states that a is an integer"]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "type": "condition"}, "def_1": {"id": "def_1", "natural_language": "If $a\\con 0\\pmod{p}$", "statement": "Definition:\n\u2022 We consider the case where a is a multiple of p, i.e., $a \\equiv 0 \\pmod{p}$ [def_1].", "dependencies": ["tc_1", "tc_2"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nvariable\n  (p : \u2115)\n  (tc_1 : p.Prime)\n  (\u03b6 : \u2102)\n  (h_zeta_p : \u03b6 ^ p = 1)\n  (h_zeta_ne_1 : \u2200 k : \u2115, 1 \u2264 k \u2192 k < p \u2192 \u03b6 ^ k \u2260 1)\n  (a : \u2124)\n  (def_1 : a \u2261 0 [ZMOD p])", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The condition 'a is a multiple of p' is perfectly captured by the Lean formalization. While the natural language uses the phrase 'multiple of p' and Lean uses the congruence notation 'a \u2261 0 [ZMOD p]', these are mathematically equivalent statements.", "The conclusion '$a \u2261 0 \\pmod{p}$' is perfectly matched by the Lean statement '(def_1 : a \u2261 0 [ZMOD p])'. The Lean notation '[ZMOD p]' is the standard way to express modular congruence and is equivalent to the mathematical notation."]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "type": "definition"}, "l1": {"id": "l1", "natural_language": "If $a\\con 0\\pmod{p}$, then $\\zeta^a=1$", "statement": "We assume:\n\u2022 p is a prime number and \u03b6 is a primitive p-th root of unity, satisfying \u03b6^p = 1 and \u03b6^k \u2260 1 for 1 \u2264 k < p [tc_1];\n\u2022 a is an integer [tc_2];\n\u2022 $a \\equiv 0 \\pmod{p}$ [def_1].\nTherefore, we conclude:\n\u2022 \u03b6^a = 1 [l1].", "dependencies": ["tc_1", "tc_2", "def_1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l1\n  (p : \u2115) (\u03b6 : \u2102) (a : \u2124)\n  (tc_1 : p.Prime \u2227 \u03b6 ^ p = 1 \u2227 (\u2200 k : \u2115, 1 \u2264 k \u2192 k < p \u2192 \u03b6 ^ k \u2260 1))\n  (tc_2 : True)\n  (def_1 : a \u2261 0 [ZMOD p]) :\n  \u03b6 ^ a = 1 := by\nsorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l1\n  (p : \u2115) (\u03b6 : \u2102) (a : \u2124)\n  (tc_1 : p.Prime \u2227 \u03b6 ^ p = 1 \u2227 (\u2200 k : \u2115, 1 \u2264 k \u2192 k < p \u2192 \u03b6 ^ k \u2260 1))\n  (tc_2 : True)\n  (def_1 : a \u2261 0 [ZMOD p]) :\n  \u03b6 ^ a = 1 := by\n  rcases tc_1 with \u27e8hp, h\u03b6, hprim\u27e9\n  obtain \u27e8k, hk\u27e9 := Int.modEq_iff_dvd.1 def_1\n  rw [\u2190 sub_eq_zero] at hk\n  rw [eq_neg_iff_add_eq_zero, add_zero] at hk\n  rw [hk]\n  simp [zpow_mul, h\u03b6, zpow_natCast, one_zpow]", "lean_pass": false, "lean_verify": false, "error_msg": [{"line": 14, "column": 6, "endLine": 14, "endColumn": 28, "data": "tactic 'rewrite' failed, did not find instance of the pattern in the target expression\n  ?m.732 = -?m.733\ncase intro.intro.intro\np : \u2115\n\u03b6 : \u2102\na : \u2124\ntc_2 : True\ndef_1 : a \u2261 0 [ZMOD \u2191p]\nhp : Nat.Prime p\nh\u03b6 : \u03b6 ^ p = 1\nhprim : \u2200 (k : \u2115), 1 \u2264 k \u2192 k < p \u2192 \u03b6 ^ k \u2260 1\nk : \u2124\nhk : 0 - a - \u2191p * k = 0\n\u22a2 \u03b6 ^ a = 1"}], "tries": 5}, "score": {"semantic_score": 0, "semantic_feedback": ["The Lean formalization correctly captures all mathematical components from the natural language. The prime condition, primitive root properties, integer constraint, modular arithmetic condition, and conclusion are all properly translated. The trivial condition (tc_2 : True) and explicit type declarations are standard Lean practices that don't alter the logical meaning.", "The tactics contained syntactic mistakes, so final score is 0."]}, "error_report": {"error_type": "Prover", "error_report": "Formalization appears correct (score=1.0 > 0.6), but the prover could neither prove the lemma nor its negation. This may be due to prover limitations, missing lemmas, or incomplete context."}, "solved_negation": {"lean_verify": false, "lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma not_l1 :\n  \u2203 (p : \u2115) (\u03b6 : \u2102) (a : \u2124),\n    p.Prime \u2227 \u03b6 ^ p = 1 \u2227 (\u2200 k : \u2115, 1 \u2264 k \u2192 k < p \u2192 \u03b6 ^ k \u2260 1) \u2227\n    a \u2261 0 [ZMOD p] \u2227 \u03b6 ^ a \u2260 1 := by\n  use 2, -1, 2\n  constructor\n  \u00b7 exact Nat.prime_two\n  constructor\n  \u00b7 norm_num\n  constructor\n  \u00b7 intro k hk hkp\n    have : k = 1 := by omega\n    subst this\n    simp\n    intro h\n    norm_num at h\n  constructor\n  \u00b7 rw [Int.modEq_iff_modEq_natAbs]\n    simp\n  \u00b7 norm_num"}, "type": "lemma"}, "ts_1": {"id": "ts_1", "natural_language": "so the sum equals the number of summands, which is p.", "statement": "We assume:\n\u2022 p is a prime number and \u03b6 is a primitive p-th root of unity, satisfying \u03b6^p = 1 and \u03b6^k \u2260 1 for 1 \u2264 k < p [tc_1];\n\u2022 a is an integer [tc_2];\n\u2022 $a \\equiv 0 \\pmod{p}$ [def_1];\n\u2022 \u03b6^a = 1 [l1].\nTherefore, we conclude:\n\u2022 The sum $\\sum_{n=0}^{p-1} \\zeta^{an}$ equals p [ts_1].", "dependencies": ["tc_1", "tc_2", "def_1", "l1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma ts_1\n  (p : \u2115) (\u03b6 : \u2102) (a : \u2124)\n  (tc_1 : p.Prime \u2227 \u03b6 ^ p = 1 \u2227 (\u2200 k : \u2115, 1 \u2264 k \u2192 k < p \u2192 \u03b6 ^ k \u2260 1))\n  (tc_2 : True)\n  (def_1 : a \u2261 0 [ZMOD p])\n  (l1 : \u03b6 ^ a = 1) :\n  \u2211 n : Fin p, \u03b6 ^ (a * n) = p := by\nsorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma ts_1\n  (p : \u2115) (\u03b6 : \u2102) (a : \u2124)\n  (tc_1 : p.Prime \u2227 \u03b6 ^ p = 1 \u2227 (\u2200 k : \u2115, 1 \u2264 k \u2192 k < p \u2192 \u03b6 ^ k \u2260 1))\n  (tc_2 : True)\n  (def_1 : a \u2261 0 [ZMOD p])\n  (l1 : \u03b6 ^ a = 1) :\n  \u2211 n : Fin p, \u03b6 ^ (a * n) = p := by\n  have h : (p : \u2124) \u2223 a := Int.modEq_zero_iff_dvd.mp def_1\n  obtain \u27e8k, rfl\u27e9 := h\n  simp [mul_comm, mul_assoc, pow_mul, l1, one_pow]\n  rw [Finset.sum_const, Finset.card_fin]\n  simp [nsmul_eq_mul]\n  norm_cast", "lean_pass": false, "lean_verify": false, "error_msg": [{"line": 15, "column": 6, "endLine": 15, "endColumn": 22, "data": "tactic 'rewrite' failed, did not find instance of the pattern in the target expression\n  \u2211 _x \u2208 ?m.8297, ?b\ncase intro\np : \u2115\n\u03b6 : \u2102\ntc_1 : Nat.Prime p \u2227 \u03b6 ^ p = 1 \u2227 \u2200 (k : \u2115), 1 \u2264 k \u2192 k < p \u2192 \u03b6 ^ k \u2260 1\ntc_2 : True\nk : \u2124\ndef_1 : \u2191p * k \u2261 0 [ZMOD \u2191p]\nl1 : \u03b6 ^ (\u2191p * k) = 1\n\u22a2 \u2211 x : Fin p, \u03b6 ^ (k * (\u2191p * \u2191\u2191x)) = \u2191p"}], "tries": 5}, "score": {"semantic_score": 0, "semantic_feedback": ["The conditions for p being prime and \u03b6 being a primitive p-th root of unity are correctly formalized with all necessary mathematical constraints.", "The integer type for a is properly declared, and the redundant tc_2 condition doesn't affect correctness.", "The modular arithmetic condition is correctly expressed using Lean's ZMOD notation.", "The power equation \u03b6^a = 1 is directly and correctly translated.", "The sum notation correctly captures the range 0 to p-1 using Fin p, the exponent a*n is properly formalized, and the equality with p is correct with appropriate type coercion.", "The tactics contained syntactic mistakes, so final score is 0."]}, "error_report": {"error_type": "Prover", "error_report": "Formalization appears correct (score=1.0 > 0.6), but the prover could neither prove the lemma nor its negation. This may be due to prover limitations, missing lemmas, or incomplete context."}, "solved_negation": {"lean_verify": false, "lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma neg_ts_1\n  (p : \u2115) (\u03b6 : \u2102) (a : \u2124)\n  (tc_1 : p.Prime \u2227 \u03b6 ^ p = 1 \u2227 (\u2200 k : \u2115, 1 \u2264 k \u2192 k < p \u2192 \u03b6 ^ k \u2260 1))\n  (tc_2 : True)\n  (def_1 : a \u2261 0 [ZMOD p])\n  (l1 : \u03b6 ^ a = 1) :\n  \u00ac (\u2211 n : Fin p, \u03b6 ^ (a * n) = p) := by\n  intro hsum\n  have h : \u03b6 ^ a = 1 := l1\n  have h' : a \u2261 0 [ZMOD p] := def_1\n  rw [Fin.sum_univ_eq_sum_range, sum_range] at hsum\n  simp [h] at hsum\n  norm_cast at hsum\n  have hp := tc_1.1\n  contradiction"}, "type": "solution"}, "def_2": {"id": "def_2", "natural_language": "If $a\\not\\con 0\\pmod{p}$", "statement": "Definition:\n\u2022 We consider the case where a is not a multiple of p, i.e., $a \\not\\equiv 0 \\pmod{p}$ [def_2].", "dependencies": ["tc_1", "tc_2", "def_1", "l1", "ts_1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nvariable\n  (p : \u2115)\n  (tc_1 : p.Prime)\n  (\u03b6 : \u2102)\n  (h_zeta_p : \u03b6 ^ p = 1)\n  (h_zeta_ne_1 : \u2200 k : \u2115, 1 \u2264 k \u2192 k < p \u2192 \u03b6 ^ k \u2260 1)\n  (a : \u2124)\n  (def_2 : \u00ac (a \u2261 0 [ZMOD p]))", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The condition 'a is not a multiple of p' is perfectly captured by the Lean formalization \u00ac (a \u2261 0 [ZMOD p]), as these statements are mathematically equivalent", "The conclusion $a \\not\\equiv 0 \\pmod{p}$ is directly and perfectly formalized as \u00ac (a \u2261 0 [ZMOD p]) in Lean"]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "type": "definition"}, "l2": {"id": "l2", "natural_language": "We have $\\zeta^a\\neq 1$, so $\\zeta^a - 1 \\neq 0$", "statement": "We assume:\n\u2022 p is a prime number and \u03b6 is a primitive p-th root of unity, satisfying \u03b6^p = 1 and \u03b6^k \u2260 1 for 1 \u2264 k < p [tc_1];\n\u2022 a is an integer [tc_2];\n\u2022 $a \\equiv 0 \\pmod{p}$ [def_1];\n\u2022 \u03b6^a = 1 [l1];\n\u2022 The sum $\\sum_{n=0}^{p-1} \\zeta^{an}$ equals p [ts_1];\n\u2022 $a \\not\\equiv 0 \\pmod{p}$ [def_2].\nTherefore, we conclude:\n\u2022 \u03b6^a - 1 \u2260 0 [l2].", "dependencies": ["tc_1", "tc_2", "def_1", "l1", "ts_1", "def_2"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l2\n  (p : \u2115) (\u03b6 : \u2102) (a : \u2124)\n  (tc_1 : p.Prime \u2227 \u03b6 ^ p = 1 \u2227 (\u2200 k : \u2115, 1 \u2264 k \u2192 k < p \u2192 \u03b6 ^ k \u2260 1))\n  (tc_2 : True)\n  (def_1 : a \u2261 0 [ZMOD p])\n  (l1 : \u03b6 ^ a = 1)\n  (ts_1 : \u2211 n : Fin p, \u03b6 ^ (a * n) = p)\n  (def_2 : \u00ac (a \u2261 0 [ZMOD p])) :\n  \u03b6 ^ a - 1 \u2260 0 := by\nsorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l2\n  (p : \u2115) (\u03b6 : \u2102) (a : \u2124)\n  (tc_1 : p.Prime \u2227 \u03b6 ^ p = 1 \u2227 (\u2200 k : \u2115, 1 \u2264 k \u2192 k < p \u2192 \u03b6 ^ k \u2260 1))\n  (tc_2 : True)\n  (def_1 : a \u2261 0 [ZMOD p])\n  (l1 : \u03b6 ^ a = 1)\n  (ts_1 : \u2211 n : Fin p, \u03b6 ^ (a * n) = p)\n  (def_2 : \u00ac (a \u2261 0 [ZMOD p])) :\n  \u03b6 ^ a - 1 \u2260 0 := by\n  intro h\n  have : \u03b6 ^ a = 1 := by linear_combination h + 1\n  rw [this] at ts_1\n  simp only [one_pow, Finset.sum_const, Finset.card_fin, nsmul_eq_mul, mul_one] at ts_1\n  contradiction", "lean_pass": false, "lean_verify": false, "error_msg": [{"line": 16, "column": 6, "endLine": 16, "endColumn": 10, "data": "tactic 'rewrite' failed, did not find instance of the pattern in the target expression\n  \u03b6 ^ a\np : \u2115\n\u03b6 : \u2102\na : \u2124\ntc_1 : Nat.Prime p \u2227 \u03b6 ^ p = 1 \u2227 \u2200 (k : \u2115), 1 \u2264 k \u2192 k < p \u2192 \u03b6 ^ k \u2260 1\ntc_2 : True\ndef_1 : a \u2261 0 [ZMOD \u2191p]\nl1 : \u03b6 ^ a = 1\nts_1 : \u2211 n : Fin p, \u03b6 ^ (a * \u2191\u2191n) = \u2191p\ndef_2 : \u00aca \u2261 0 [ZMOD \u2191p]\nh : \u03b6 ^ a - 1 = 0\nthis : \u03b6 ^ a = 1\n\u22a2 False"}], "tries": 5}, "score": {"semantic_score": 0, "semantic_feedback": ["The prime condition and primitive root properties are correctly formalized in Lean with equivalent logical meaning.", "The integer type constraint for 'a' is properly captured.", "Both the natural language and Lean contain contradictory assumptions: def_1 states a \u2261 0 (mod p) while def_2 states a \u2262 0 (mod p). This makes the premise logically inconsistent, though the Lean faithfully represents this contradiction.", "The condition \u03b6^a = 1 is identically represented in both versions.", "The sum condition is equivalent between versions, with Fin p being the appropriate Lean representation for the range 0 to p-1.", "The conclusion \u03b6^a - 1 \u2260 0 is identically stated in both versions.", "The tactics contained syntactic mistakes, so final score is 0."]}, "error_report": {"error_type": "Formalizer", "error_report": "Formalization is likely incorrect: semantic score is 0.0, below threshold 0.6.\nScorer feedback: ['The prime condition and primitive root properties are correctly formalized in Lean with equivalent logical meaning.', \"The integer type constraint for 'a' is properly captured.\", 'Both the natural language and Lean contain contradictory assumptions: def_1 states a \u2261 0 (mod p) while def_2 states a \u2262 0 (mod p). This makes the premise logically inconsistent, though the Lean faithfully represents this contradiction.', 'The condition \u03b6^a = 1 is identically represented in both versions.', 'The sum condition is equivalent between versions, with Fin p being the appropriate Lean representation for the range 0 to p-1.', 'The conclusion \u03b6^a - 1 \u2260 0 is identically stated in both versions.']"}, "solved_negation": null, "type": "lemma"}, "def_3": {"id": "def_3", "natural_language": "we use the identity $$x^p - 1 = (x-1)(x^{p-1} + \\cdots + x + 1)$$", "statement": "Definition:\n\u2022 For any complex number x \u2260 1, the sum of a geometric series is given by the identity $\\sum_{n=0}^{p-1} x^n = \\frac{x^p - 1}{x - 1}$. This is equivalent to $x^p - 1 = (x-1)(\\sum_{n=0}^{p-1} x^n)$ [def_3].", "dependencies": ["tc_1", "tc_2", "def_1", "l1", "ts_1", "def_2", "l2"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nvariable\n  (x : \u2102)\n  (p : \u2115)\n  (def_3 : x ^ p - 1 = (x - 1) * (\u2211 n in Finset.range p, x ^ n))", "lean_pass": true, "error_msg": [], "tries": 2}, "solved_lemma": {}, "score": {"semantic_score": 0.0, "semantic_feedback": ["Lean formalization correctly declares x as a complex number", "The Lean formalization is missing the crucial condition x \u2260 1, which is essential for the geometric series formula to be well-defined", "Lean uses \u2115 (natural numbers including 0) while the natural language specifies positive integer. This is a minor difference as the formula works for p = 0 as well", "The Lean formalization completely omits the first conclusion about the geometric series sum formula \u2211_{n=0}^{p-1} x^n = (x^p - 1)/(x - 1)", "The Lean formalization correctly captures the second conclusion with equivalent mathematical meaning using Finset.range p for the sum"]}, "error_report": {"error_type": "Formalizer", "error_report": "Formalization is likely incorrect: semantic score is 0.0, below threshold 0.6.\nScorer feedback: ['Lean formalization correctly declares x as a complex number', 'The Lean formalization is missing the crucial condition x \u2260 1, which is essential for the geometric series formula to be well-defined', 'Lean uses \u2115 (natural numbers including 0) while the natural language specifies positive integer. This is a minor difference as the formula works for p = 0 as well', 'The Lean formalization completely omits the first conclusion about the geometric series sum formula \u2211_{n=0}^{p-1} x^n = (x^p - 1)/(x - 1)', 'The Lean formalization correctly captures the second conclusion with equivalent mathematical meaning using Finset.range p for the sum']"}, "type": "definition"}, "l3": {"id": "l3", "natural_language": "with $x = \\zeta^a$. We have ... $\\sum_{n=0}^{p-1} \\zeta^{an} = \\frac{\\zeta^{ap}-1}{\\zeta^a-1}$", "statement": "We assume:\n\u2022 ... previous steps ...\n\u2022 $a \\not\\equiv 0 \\pmod{p}$ [def_2];\n\u2022 \u03b6^a - 1 \u2260 0 [l2];\n\u2022 The geometric series identity [def_3].\nTherefore, we conclude:\n\u2022 $\\sum_{n=0}^{p-1} \\zeta^{an} = \\frac{\\zeta^{ap}-1}{\\zeta^a-1}$ [l3].", "dependencies": ["tc_1", "tc_2", "def_1", "l1", "ts_1", "def_2", "l2", "def_3"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l3\n  (p : \u2115) (\u03b6 : \u2102) (a : \u2124)\n  (tc_1 : p.Prime)\n  (tc_2 : True)\n  (h_zeta_p : \u03b6 ^ p = 1)\n  (h_zeta_ne_1 : \u2200 k : \u2115, 1 \u2264 k \u2192 k < p \u2192 \u03b6 ^ k \u2260 1)\n  (def_2 : \u00ac (a \u2261 0 [ZMOD p]))\n  (l2 : \u03b6 ^ a - 1 \u2260 0)\n  (def_3 : \u2200 (x : \u2102), x ^ p - 1 = (x - 1) * (\u2211 n in Finset.range p, x ^ n)) :\n  \u2211 n : Fin p, \u03b6 ^ (a * n) = (\u03b6 ^ (a * p) - 1) / (\u03b6 ^ a - 1) := by\nsorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l3\n  (p : \u2115) (\u03b6 : \u2102) (a : \u2124)\n  (tc_1 : p.Prime)\n  (tc_2 : True)\n  (h_zeta_p : \u03b6 ^ p = 1)\n  (h_zeta_ne_1 : \u2200 k : \u2115, 1 \u2264 k \u2192 k < p \u2192 \u03b6 ^ k \u2260 1)\n  (def_2 : \u00ac (a \u2261 0 [ZMOD p]))\n  (l2 : \u03b6 ^ a - 1 \u2260 0)\n  (def_3 : \u2200 (x : \u2102), x ^ p - 1 = (x - 1) * (\u2211 n in Finset.range p, x ^ n)) :\n  \u2211 n : Fin p, \u03b6 ^ (a * n) = (\u03b6 ^ (a * p) - 1) / (\u03b6 ^ a - 1) := by\n  have h : \u03b6 ^ a \u2260 1 := by exact sub_ne_zero.1 l2\n  simp_rw [mul_comm a]\n  rw [Finset.sum_univ_eq_sum_range, \u2190 geom_sum_eq h, h_zeta_p, zpow_nat_cast, one_pow, sub_self, zero_sub, neg_div_neg_eq]\n  simp [h]", "lean_pass": false, "lean_verify": false, "error_msg": [{"line": 17, "column": 6, "endLine": 17, "endColumn": 34, "data": "unknown constant 'Finset.sum_univ_eq_sum_range'"}, {"line": 17, "column": 6, "endLine": 17, "endColumn": 34, "data": "tactic 'rewrite' failed, equality or iff proof expected\n  ?m.3965\np : \u2115\n\u03b6 : \u2102\na : \u2124\ntc_1 : Nat.Prime p\ntc_2 : True\nh_zeta_p : \u03b6 ^ p = 1\nh_zeta_ne_1 : \u2200 (k : \u2115), 1 \u2264 k \u2192 k < p \u2192 \u03b6 ^ k \u2260 1\ndef_2 : \u00aca \u2261 0 [ZMOD \u2191p]\nl2 : \u03b6 ^ a - 1 \u2260 0\ndef_3 : \u2200 (x : \u2102), x ^ p - 1 = (x - 1) * \u2211 n \u2208 Finset.range p, x ^ n\nh : \u03b6 ^ a \u2260 1\n\u22a2 \u2211 x : Fin p, \u03b6 ^ (\u2191\u2191x * a) = (\u03b6 ^ (\u2191p * a) - 1) / (\u03b6 ^ a - 1)"}], "tries": 5}, "score": {"semantic_score": 0, "semantic_feedback": ["The mathematical context, variable declarations, and conditions properly establish the setting with \u03b6 as a primitive p-th root of unity.", "The condition '\u00ac (a \u2261 0 [ZMOD p])' correctly formalizes 'a \u2262 0 (mod p)'.", "The condition '\u03b6 ^ a - 1 \u2260 0' directly matches the natural language premise.", "The geometric series identity is correctly formalized as the standard factorization formula.", "The main conclusion correctly formalizes the geometric series sum equality, with the understanding that both sides equal 0 when a \u2262 0 (mod p) due to \u03b6^p = 1.", "The tactics contained syntactic mistakes, so final score is 0."]}, "error_report": {"error_type": "Prover", "error_report": "Formalization appears correct (score=1.0 > 0.6), but the prover could neither prove the lemma nor its negation. This may be due to prover limitations, missing lemmas, or incomplete context."}, "solved_negation": {"lean_verify": false, "lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma neg_l3\n  (p : \u2115) (\u03b6 : \u2102) (a : \u2124)\n  (tc_1 : p.Prime)\n  (tc_2 : True)\n  (h_zeta_p : \u03b6 ^ p = 1)\n  (h_zeta_ne_1 : \u2200 k : \u2115, 1 \u2264 k \u2192 k < p \u2192 \u03b6 ^ k \u2260 1)\n  (def_2 : \u00ac (a \u2261 0 [ZMOD p]))\n  (l2 : \u03b6 ^ a - 1 \u2260 0)\n  (def_3 : \u2200 (x : \u2102), x ^ p - 1 = (x - 1) * (\u2211 n in Finset.range p, x ^ n)) :\n  \u00ac (\u2211 n : Fin p, \u03b6 ^ (a * n) = (\u03b6 ^ (a * p) - 1) / (\u03b6 ^ a - 1)) := by\n  intro h\n  have h1 : \u03b6 ^ (a * p) = (\u03b6 ^ p) ^ a := by rw [mul_comm, zpow_mul]\n  rw [h_zeta_p, one_zpow] at h1\n  simp [h1] at h\n  have h2 : \u2211 n : Fin p, \u03b6 ^ (a * n) = \u2211 n in Finset.range p, \u03b6 ^ (a * n) := by simp\n  rw [h2] at h\n  have h3 : \u03b6 - 1 \u2260 0 := by\n    intro h4\n    apply h_zeta_ne_1 1 (by linarith) (Nat.Prime.one_lt tc_1)\n    rw [\u2190sub_eq_zero, h4]\n  have h4 : \u03b6 ^ p - 1 = 0 := by rw [h_zeta_p, sub_self]\n  rw [def_3 \u03b6, h4] at h\n  simp [h3] at h\n  have h5 : \u2211 n in Finset.range p, \u03b6 ^ (a * n) = p := by\n    rw [h]\n    field_simp [l2]\n  have h6 : \u2211 n in Finset.range p, \u03b6 ^ (a * n) = \u2211 n in Finset.range p, (\u03b6 ^ a) ^ n := by\n    congr; ext n; rw [zpow_mul]\n  rw [h6] at h5\n  have h7 : \u03b6 ^ a \u2260 1 := by\n    intro h8\n    apply def_2\n    rw [\u2190ZMod.natCast_zmod_eq_zero_iff p]\n    apply h_zeta_ne_1 _ (by linarith) (Nat.Prime.one_lt tc_1)\n    rw [h8]\n  have h8 : \u2211 n in Finset.range p, (\u03b6 ^ a) ^ n = (1 - (\u03b6 ^ a) ^ p) / (1 - \u03b6 ^ a) := by\n    rw [geom_sum_eq]\n    exact h7\n  rw [h8] at h5\n  simp [h_zeta_p] at h5\n  have h9 : (1 - 1) / (1 - \u03b6 ^ a) = 0 := by simp\n  rw [h9] at h5\n  simp at h5\n  exact tc_1.ne_zero h5"}, "type": "lemma"}, "l4": {"id": "l4", "natural_language": "= \\frac{1-1}{\\zeta^a-1}", "statement": "We assume:\n\u2022 ... previous steps ...\n\u2022 \u03b6 is a p-th root of unity [tc_1];\n\u2022 $\\sum_{n=0}^{p-1} \\zeta^{an} = \\frac{\\zeta^{ap}-1}{\\zeta^a-1}$ [l3].\nTherefore, we conclude:\n\u2022 $\\sum_{n=0}^{p-1} \\zeta^{an} = \\frac{1-1}{\\zeta^a-1}$ [l4].", "dependencies": ["tc_1", "tc_2", "def_1", "l1", "ts_1", "def_2", "l2", "def_3", "l3"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l4\n  (p : \u2115) (\u03b6 : \u2102) (a : \u2124)\n  (tc_1 : p.Prime)\n  (h_zeta_p : \u03b6 ^ p = 1)\n  (l3 : \u2211 n : Fin p, \u03b6 ^ (a * n) = (\u03b6 ^ (a * p) - 1) / (\u03b6 ^ a - 1)) :\n  \u2211 n : Fin p, \u03b6 ^ (a * n) = (1 - 1) / (\u03b6 ^ a - 1) := by\nsorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l4\n  (p : \u2115) (\u03b6 : \u2102) (a : \u2124)\n  (tc_1 : p.Prime)\n  (h_zeta_p : \u03b6 ^ p = 1)\n  (l3 : \u2211 n : Fin p, \u03b6 ^ (a * n) = (\u03b6 ^ (a * p) - 1) / (\u03b6 ^ a - 1)) :\n  \u2211 n : Fin p, \u03b6 ^ (a * n) = (1 - 1) / (\u03b6 ^ a - 1) := by\n  rw [l3]\n  rw [\u2190 zpow_mul, mul_comm, zpow_mul, h_zeta_p, zpow_one, one_zpow]", "lean_pass": false, "lean_verify": false, "error_msg": [{"line": 12, "column": 6, "endLine": 12, "endColumn": 16, "data": "tactic 'rewrite' failed, did not find instance of the pattern in the target expression\n  (?a ^ ?m) ^ ?n\np : \u2115\n\u03b6 : \u2102\na : \u2124\ntc_1 : Nat.Prime p\nh_zeta_p : \u03b6 ^ p = 1\nl3 : \u2211 n : Fin p, \u03b6 ^ (a * \u2191\u2191n) = (\u03b6 ^ (a * \u2191p) - 1) / (\u03b6 ^ a - 1)\n\u22a2 (\u03b6 ^ (a * \u2191p) - 1) / (\u03b6 ^ a - 1) = (1 - 1) / (\u03b6 ^ a - 1)"}], "tries": 5}, "score": {"semantic_score": 0, "semantic_feedback": ["Variable types are appropriately declared with \u2115 for p, \u2102 for \u03b6, and \u2124 for a. The use of Fin p for the summation index correctly captures the range n=0 to p-1.", "The explicit prime condition tc_1 : p.Prime is mathematically consistent with the context of p-th roots of unity, even though not explicitly stated in the natural language.", "The condition h_zeta_p : \u03b6 ^ p = 1 is the precise mathematical definition of \u03b6 being a p-th root of unity.", "The premise l3 correctly translates the mathematical equation, with proper handling of multiplication order (a * n vs an) and exponentiation (a * p vs ap).", "The Lean formalization correctly captures the implicit mathematical reasoning that \u03b6^(ap) = (\u03b6^p)^a = 1^a = 1, leading to the numerator becoming (1-1).", "The conclusion perfectly matches the natural language statement, showing the sum equals (1-1)/(\u03b6^a-1), which simplifies to 0.", "The tactics contained syntactic mistakes, so final score is 0."]}, "error_report": {"error_type": "Prover", "error_report": "Formalization appears correct (score=1.0 > 0.6), but the prover could neither prove the lemma nor its negation. This may be due to prover limitations, missing lemmas, or incomplete context."}, "solved_negation": {"lean_verify": false, "lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma neg_l4\n  (p : \u2115) (\u03b6 : \u2102) (a : \u2124)\n  (tc_1 : p.Prime)\n  (h_zeta_p : \u03b6 ^ p = 1)\n  (l3 : \u2211 n : Fin p, \u03b6 ^ (a * n) = (\u03b6 ^ (a * p) - 1) / (\u03b6 ^ a - 1)) :\n  \u00ac (\u2211 n : Fin p, \u03b6 ^ (a * n) = (1 - 1) / (\u03b6 ^ a - 1)) := by\n  intro h\n  have h1 : \u03b6 ^ (a * p) = (\u03b6 ^ p) ^ a := by rw [\u2190 zpow_mul]\n  rw [h_zeta_p, zpow_one] at h1\n  rw [h1] at l3\n  simp at l3\n  rw [l3] at h\n  simp at h\n  have h2 : \u03b6 ^ a \u2260 1 := by\n    intro h'\n    rw [h'] at l3\n    simp at l3\n    exact (sum_ne_zero_of_ne_zero p \u03b6 a tc_1 h_zeta_p) l3\n  apply h2\n  rw [\u2190h]\n  simp\nwhere\n  sum_ne_zero_of_ne_zero (p : \u2115) (\u03b6 : \u2102) (a : \u2124) (hp : p.Prime) (h\u03b6 : \u03b6 ^ p = 1) :\n    \u2211 n : Fin p, \u03b6 ^ (a * n) \u2260 0 := by\n    sorry"}, "type": "lemma"}, "ts_2": {"id": "ts_2", "natural_language": "= 0.", "statement": "We assume:\n\u2022 ... previous steps ...\n\u2022 \u03b6^a - 1 \u2260 0 [l2];\n\u2022 $\\sum_{n=0}^{p-1} \\zeta^{an} = \\frac{1-1}{\\zeta^a-1}$ [l4].\nTherefore, we conclude:\n\u2022 $\\sum_{n=0}^{p-1} \\zeta^{an} = 0$ [ts_2].", "dependencies": ["tc_1", "tc_2", "def_1", "l1", "ts_1", "def_2", "l2", "def_3", "l3", "l4"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma ts_2\n  (p : \u2115) (\u03b6 : \u2102) (a : \u2124)\n  (tc_1 : p.Prime)\n  (h_zeta_p : \u03b6 ^ p = 1)\n  (h_zeta_ne_1 : \u2200 k : \u2115, 1 \u2264 k \u2192 k < p \u2192 \u03b6 ^ k \u2260 1)\n  (def_2 : \u00ac(a \u2261 0 [ZMOD p]))\n  (l2 : \u03b6 ^ a - 1 \u2260 0)\n  (l4 : \u2211 n : Fin p, \u03b6 ^ (a * n) = (1 - 1) / (\u03b6 ^ a - 1)) :\n  \u2211 n : Fin p, \u03b6 ^ (a * n) = 0 := by\nsorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma ts_2\n  (p : \u2115) (\u03b6 : \u2102) (a : \u2124)\n  (tc_1 : p.Prime)\n  (h_zeta_p : \u03b6 ^ p = 1)\n  (h_zeta_ne_1 : \u2200 k : \u2115, 1 \u2264 k \u2192 k < p \u2192 \u03b6 ^ k \u2260 1)\n  (def_2 : \u00ac(a \u2261 0 [ZMOD p]))\n  (l2 : \u03b6 ^ a - 1 \u2260 0)\n  (l4 : \u2211 n : Fin p, \u03b6 ^ (a * n) = (1 - 1) / (\u03b6 ^ a - 1)) :\n  \u2211 n : Fin p, \u03b6 ^ (a * n) = 0 := by\n  rw [l4]\n  simp", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The mathematical setup correctly captures the context of primitive p-th roots of unity with appropriate conditions", "The assumption l2 is perfectly translated with identical mathematical meaning", "The assumption l4 correctly represents the sum equation, with Fin p being equivalent to the range 0 to p-1, and a*n equivalent to an", "The conclusion ts_2 accurately captures the target equality with equivalent mathematical notation", "The logical flow from assumptions to conclusion is preserved, with the key insight that (1-1)/(\u03b6^a-1) = 0 when \u03b6^a-1 \u2260 0"]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "solution"}};
            
            // Create nodes and edges
            var nodes = new vis.DataSet([{"id": "tc_1", "label": "tc_1", "color": {"background": "#eba0a0", "border": "#00ff00", "highlight": {"background": "#eba0a0", "border": "#00ff00"}}, "shape": "box", "size": 30, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "tc_2", "label": "tc_2", "color": {"background": "#eba0a0", "border": "#00ff00", "highlight": {"background": "#eba0a0", "border": "#00ff00"}}, "shape": "box", "size": 30, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "def_1", "label": "def_1", "color": {"background": "#cfb795", "border": "#00ff00", "highlight": {"background": "#cfb795", "border": "#00ff00"}}, "shape": "box", "size": 30, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l1", "label": "l1", "color": {"background": "#8dafcc", "border": "#FFA500", "highlight": {"background": "#8dafcc", "border": "#FFA500"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "ts_1", "label": "ts_1", "color": {"background": "#a3c2a8", "border": "#FFA500", "highlight": {"background": "#a3c2a8", "border": "#FFA500"}}, "shape": "star", "size": 40, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "def_2", "label": "def_2", "color": {"background": "#cfb795", "border": "#00ff00", "highlight": {"background": "#cfb795", "border": "#00ff00"}}, "shape": "box", "size": 30, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l2", "label": "l2", "color": {"background": "#8dafcc", "border": "#FFA500", "highlight": {"background": "#8dafcc", "border": "#FFA500"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "def_3", "label": "def_3", "color": {"background": "#cfb795", "border": "#00ff00", "highlight": {"background": "#cfb795", "border": "#00ff00"}}, "shape": "box", "size": 30, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l3", "label": "l3", "color": {"background": "#8dafcc", "border": "#FFA500", "highlight": {"background": "#8dafcc", "border": "#FFA500"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l4", "label": "l4", "color": {"background": "#8dafcc", "border": "#FFA500", "highlight": {"background": "#8dafcc", "border": "#FFA500"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "ts_2", "label": "ts_2", "color": {"background": "#a3c2a8", "border": "#00ff00", "highlight": {"background": "#a3c2a8", "border": "#00ff00"}}, "shape": "star", "size": 40, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}]);
            var edges = new vis.DataSet([{"from": "tc_1", "to": "tc_2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "def_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "l1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "def_2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "l2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "def_3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "l3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "l4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "ts_2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_2", "to": "def_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_2", "to": "l1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_2", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_2", "to": "def_2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_2", "to": "l2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_2", "to": "def_3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_2", "to": "l3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_2", "to": "l4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_2", "to": "ts_2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_1", "to": "l1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_1", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_1", "to": "def_2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_1", "to": "l2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_1", "to": "def_3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_1", "to": "l3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_1", "to": "l4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_1", "to": "ts_2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "def_2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "l2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "def_3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "l3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "l4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "ts_2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "ts_1", "to": "def_2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "ts_1", "to": "l2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "ts_1", "to": "def_3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "ts_1", "to": "l3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "ts_1", "to": "l4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "ts_1", "to": "ts_2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_2", "to": "l2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_2", "to": "def_3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_2", "to": "l3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_2", "to": "l4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_2", "to": "ts_2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l2", "to": "def_3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l2", "to": "l3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l2", "to": "l4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l2", "to": "ts_2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_3", "to": "l3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_3", "to": "l4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_3", "to": "ts_2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l3", "to": "l4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l3", "to": "ts_2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l4", "to": "ts_2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}]);
            
            // Create network
            var container = document.getElementById('mynetwork');
            var data = {
                nodes: nodes,
                edges: edges
            };
            
            var options = {
                physics: {
                    enabled: true,
                    solver: 'hierarchicalRepulsion',
                    hierarchicalRepulsion: {
                        centralGravity: 0.0,
                        springLength: 200,
                        springConstant: 0.01,
                        nodeDistance: 150,
                        damping: 0.09
                    }
                },
                edges: {
                    smooth: {
                        type: 'continuous',
                        forceDirection: 'none'
                    },
                    color: {
                        color: '#666666',
                        highlight: '#666666',
                        hover: '#666666'
                    },
                    width: 2
                },
                interaction: {
                    hover: true,
                    tooltipDelay: 100,
                    navigationButtons: true,
                    keyboard: true
                },
                nodes: {
                    font: {
                        size: 14,
                        color: '#000000'
                    },
                    labelHighlightBold: false,
                    chosen: false,
                    shapeProperties: {
                        useBorderWithImage: false
                    },
                    scaling: {
                        label: {
                            enabled: true,
                            min: 8,
                            max: 20,
                            maxVisible: 20,
                            drawThreshold: 5
                        }
                    }
                }
            };
            
            var network = new vis.Network(container, data, options);
            
            // Format field value for display
            function formatFieldValue(value, fieldName) {
                if (value === null || value === undefined) {
                    return 'N/A';
                }
                
                // Handle objects (dictionaries) as sub-boxes
                if (typeof value === 'object' && !Array.isArray(value)) {
                    var html = '';
                    for (var key in value) {
                        if (value.hasOwnProperty(key)) {
                            var subValue = value[key];
                            var subValueStr = '';
                            
                            if (typeof subValue === 'object' &&
                                    !Array.isArray(subValue)) {
                                // Nested object - show as JSON
                                subValueStr = JSON.stringify(subValue, null, 2);
                            } else if (Array.isArray(subValue)) {
                                // Array - show as JSON
                                subValueStr = JSON.stringify(subValue, null, 2);
                            } else {
                                // Primitive value
                                subValueStr = String(subValue);
                            }
                            
                            // Replace escaped newlines and tabs with actual characters
                            subValueStr = subValueStr.replace(/\\n/g, '\n');
                            subValueStr = subValueStr.replace(/\\t/g, '\t');
                            subValueStr = subValueStr.replace(/\t/g, '\t');
                            
                            html += '<div class="sub-dict">';
                            html += '<div class="sub-dict-title">' + key + '</div>';
                            html += '<div class="sub-dict-content">' + subValueStr + '</div>';
                            html += '</div>';
                        }
                    }
                    return html;
                }
                
                // Convert to string for primitive values and arrays
                var strValue = String(value);
                
                // Handle arrays
                if (Array.isArray(value)) {
                    strValue = JSON.stringify(value, null, 2);
                }
                
                // Replace escaped newlines and tabs with actual characters
                strValue = strValue.replace(/\\n/g, '\n');
                strValue = strValue.replace(/\\t/g, '\t');
                strValue = strValue.replace(/\t/g, '\t');
                
                return strValue;
            }
            
            // Handle node click events
            network.on("click", function(params) {
                if (params.nodes.length > 0) {
                    var nodeId = params.nodes[0];
                    var info = nodeInfo[nodeId];
                    
                    if (info) {
                        var html = '<div class="info-header">';
                        html += '<h2>' + nodeId + '</h2>';
                        var nodeType = info.type || 'unknown';
                        var capitalizedType = nodeType.charAt(0).toUpperCase() +
                            nodeType.slice(1);
                        html += '<div class="node-type">Type: ' + capitalizedType +
                            '</div>';
                        html += '</div>';
                        
                        // Add all fields
                        for (var key in info) {
                            if (key === 'type' || key === 'id') continue;
                            
                            var fieldName = key.replace(/_/g, ' ')
                                .replace(/\b\w/g, function(l) {
                                    return l.toUpperCase();
                                });
                            var fieldValue = formatFieldValue(info[key], fieldName);
                            
                            if (fieldValue && fieldValue !== 'N/A') {
                                // Special formatting for code fields
                                var isCode = key.includes('code') ||
                                    key.includes('lean') ||
                                    key.includes('statement');
                                
                                html += '<div class="field-group">';
                                html += '<div class="field-name">' + fieldName +
                                    '</div>';
                                html += '<div class="field-value' +
                                    (isCode ? ' code' : '') + '">' +
                                    fieldValue + '</div>';
                                html += '</div>';
                            }
                        }
                        
                        document.getElementById('info-content')
                            .innerHTML = html;
                    }
                }
            });
            
            // Toggle panel function
            function togglePanel() {
                var panel = document.getElementById('info-panel');
                panel.classList.toggle('hidden');
                
                // Resize network when panel is toggled
                setTimeout(function() {
                    network.fit();
                }, 300);
            }
            
            // Initial network fit
            network.once('stabilized', function() {
                network.fit();
            });
            
            // Resizable panels functionality
            function makeResizable() {
                const verticalResizer = document.getElementById('vertical-resizer');
                const horizontalResizer = document.getElementById('horizontal-resizer');
                const proofPanel = document.getElementById('proof-str-panel');
                const graphContainer = document.getElementById('graph-container');
                const infoPanel = document.getElementById('info-panel');
                const leftPanel = document.getElementById('left-panel');
                
                let isVerticalResizing = false;
                let isHorizontalResizing = false;
                
                // Vertical resizer (between proof panel and graph)
                verticalResizer.addEventListener('mousedown', function(e) {
                    isVerticalResizing = true;
                    document.addEventListener('mousemove', verticalResize);
                    document.addEventListener('mouseup', stopVerticalResize);
                    e.preventDefault();
                });
                
                function verticalResize(e) {
                    if (!isVerticalResizing) return;
                    
                    const containerHeight = leftPanel.offsetHeight;
                    const newHeight = e.clientY - leftPanel.offsetTop;
                    const minHeight = 100;
                    const maxHeight = containerHeight - 100;
                    
                    if (newHeight >= minHeight && newHeight <= maxHeight) {
                        proofPanel.style.height = newHeight + 'px';
                        graphContainer.style.height = (containerHeight - newHeight) + 'px';
                        network.fit();
                    }
                }
                
                function stopVerticalResize() {
                    isVerticalResizing = false;
                    document.removeEventListener('mousemove', verticalResize);
                    document.removeEventListener('mouseup', stopVerticalResize);
                }
                
                // Horizontal resizer (between left and right panels)
                horizontalResizer.addEventListener('mousedown', function(e) {
                    isHorizontalResizing = true;
                    document.addEventListener('mousemove', horizontalResize);
                    document.addEventListener('mouseup', stopHorizontalResize);
                    e.preventDefault();
                });
                
                function horizontalResize(e) {
                    if (!isHorizontalResizing) return;
                    
                    const containerWidth = document.querySelector('.container').offsetWidth;
                    const newWidth = e.clientX - leftPanel.offsetLeft;
                    const minWidth = 300;
                    const maxWidth = containerWidth - 300;
                    
                    if (newWidth >= minWidth && newWidth <= maxWidth) {
                        leftPanel.style.flex = 'none';
                        leftPanel.style.width = newWidth + 'px';
                        infoPanel.style.width = (containerWidth - newWidth) + 'px';
                        network.fit();
                    }
                }
                
                function stopHorizontalResize() {
                    isHorizontalResizing = false;
                    document.removeEventListener('mousemove', horizontalResize);
                    document.removeEventListener('mouseup', stopHorizontalResize);
                }
            }
            
            // Initialize resizable panels
            makeResizable();
        </script>
    </body>
    </html>
    