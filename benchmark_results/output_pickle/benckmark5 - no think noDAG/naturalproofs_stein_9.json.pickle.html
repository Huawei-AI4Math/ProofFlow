
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Proof Graph Visualization</title>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
        <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.css" rel="stylesheet" type="text/css" />
        <style>
            body {
                margin: 0;
                padding: 0;
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
                height: 100vh;
                overflow: hidden;
            }
            
            .container {
                display: flex;
                height: 100vh;
                background: #f0f0f0;
            }
            
            #left-panel {
                flex: 1;
                display: flex;
                flex-direction: column;
                background: white;
                border-right: 2px solid #ddd;
                height: 100vh;
                overflow: hidden;
            }
            
            #proof-str-panel {
                background: #f8f9fa;
                border-bottom: 2px solid #ddd;
                padding: 15px;
                height: 200px;
                overflow-y: auto;
                flex-shrink: 0;
            }
            
            #proof-str-title {
                font-weight: 600;
                color: #2d3748;
                margin-bottom: 10px;
                font-size: 14px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
            
            #proof-str-content {
                color: #4a5568;
                line-height: 1.6;
                white-space: pre-wrap;
                word-wrap: break-word;
                font-family: 'Monaco', 'Courier New', monospace;
                font-size: 13px;
                background: white;
                padding: 12px;
                border-radius: 4px;
                border: 1px solid #e2e8f0;
            }
            
            #graph-container {
                flex: 1;
                position: relative;
                background: white;
                min-height: 0;
                overflow: hidden;
            }
            
            #mynetwork {
                width: 100%;
                height: 100%;
            }
            
            #info-panel {
                width: 40%;
                max-width: 600px;
                background: white;
                overflow-y: auto;
                padding: 20px;
                box-shadow: -2px 0 10px rgba(0,0,0,0.1);
            }
            
            #info-panel.hidden {
                display: none;
            }
            
            .info-header {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                padding: 15px;
                border-radius: 8px;
                margin-bottom: 20px;
            }
            
            .info-header h2 {
                margin: 0;
                font-size: 24px;
            }
            
            .info-header .node-type {
                opacity: 0.9;
                font-size: 14px;
                margin-top: 5px;
            }
            
            .field-group {
                background: #f8f9fa;
                border-left: 4px solid #667eea;
                padding: 15px;
                margin-bottom: 15px;
                border-radius: 4px;
            }
            
            .field-name {
                font-weight: 600;
                color: #2d3748;
                margin-bottom: 8px;
                font-size: 14px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
            
            .field-value {
                color: #4a5568;
                line-height: 1.6;
                white-space: pre-wrap;
                word-wrap: break-word;
                font-family: 'Monaco', 'Courier New', monospace;
                font-size: 13px;
            }
            
            .field-value.code {
                color: #4a5568;
                padding: 12px;
                border-radius: 4px;
                overflow-x: auto;
            }
            
            .sub-dict {
                background: #ffffff;
                border: 1px solid #e2e8f0;
                border-radius: 4px;
                padding: 10px;
                margin: 8px 0;
                box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            }
            
            .sub-dict-title {
                font-weight: 600;
                color: #4a5568;
                margin-bottom: 8px;
                font-size: 12px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                border-bottom: 1px solid #e2e8f0;
                padding-bottom: 4px;
            }
            
            .sub-dict-content {
                color: #2d3748;
                line-height: 1.5;
                font-size: 12px;
            }
            
            .placeholder {
                text-align: center;
                color: #718096;
                padding: 40px;
                font-size: 18px;
            }
            
            .placeholder-icon {
                font-size: 48px;
                margin-bottom: 20px;
                opacity: 0.3;
            }
            
            #toggle-panel {
                position: absolute;
                right: 10px;
                top: 10px;
                z-index: 1000;
                background: #667eea;
                color: white;
                border: none;
                padding: 10px 20px;
                border-radius: 5px;
                cursor: pointer;
                font-size: 14px;
                transition: background 0.3s;
            }
            
            #toggle-panel:hover {
                background: #764ba2;
            }
            
            .legend {
                position: absolute;
                top: 20px;
                left: 20px;
                background: white;
                padding: 15px;
                border-radius: 8px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
                z-index: 100;
                max-width: 300px;
            }
            
            .legend-section {
                margin-bottom: 15px;
            }
            
            .legend-section:last-child {
                margin-bottom: 0;
            }
            
            .legend-title {
                font-weight: 600;
                font-size: 12px;
                color: #2d3748;
                margin-bottom: 8px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                border-bottom: 1px solid #e2e8f0;
                padding-bottom: 4px;
            }
            
            .legend-item {
                display: flex;
                align-items: center;
                margin-bottom: 8px;
            }
            
            .legend-item:last-child {
                margin-bottom: 0;
            }
            
            .legend-color {
                width: 20px;
                height: 20px;
                margin-right: 10px;
                border-radius: 3px;
            }
            
            .resizer {
                background: #ddd;
                cursor: col-resize;
                width: 4px;
                height: 100%;
                position: absolute;
                right: 0;
                top: 0;
                z-index: 1000;
            }
            
            .resizer:hover {
                background: #bbb;
            }
            
            .resizer-vertical {
                background: #ddd;
                cursor: row-resize;
                height: 4px;
                width: 100%;
                position: absolute;
                bottom: 0;
                left: 0;
                z-index: 1000;
            }
            
            .resizer-vertical:hover {
                background: #bbb;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div id="left-panel">
                <div id="proof-str-panel">
                    <div id="proof-str-title">Informal theorem and proof</div>
                    <div id="proof-str-content">Theorem: \ithm{primitive root mod prime powers}
Let~$p^n$ be a power of an odd prime.  Then there
is a primitive root modulo~$p^n$.

Proof: The primitive roots modulo~$n$ are the generators of
$(\zmod{n})^*$, which by assumption is cyclic of order~$\vphi(n)$.
Thus they are in bijection with the generators of any cyclic group
of order $\vphi(n)$.  In particular, the number of primitive roots
modulo~$n$ is the same as the number of elements of $\zmod{\vphi(n)}$
with additive order $\vphi(n)$.  An element of $\zmod{\vphi(n)}$ has additive
order $\vphi(n)$ if and only if it is coprime to $\vphi(n)$.  There
are $\vphi(\vphi(n))$ such elements, as claimed.
</div>
                    <div class="resizer-vertical" id="vertical-resizer"></div>
                </div>
                <div id="graph-container">
                    <button id="toggle-panel" onclick="togglePanel()">Toggle Info Panel</button>
                    <div class="legend">
                        <div class="legend-section">
                            <div class="legend-title">Node Types</div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #eba0a0;"></div>
                                <span>Theorem Conditions (tc)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #cfb795 ;"></div>
                                <span>Theorem Definitions (def)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #8dafcc;"></div>
                                <span>Lemmas (l)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #a3c2a8;"></div>
                                <span>Theorem Solutions (ts)</span>
                            </div>

                        </div>
                        <div class="legend-section">
                            <div class="legend-title">Verification Status</div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #fa2c07;"></div>
                                <span>Formalization failed</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #FFA500;"></div>
                                <span>Formalization passed</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #00ff00;"></div>
                                <span>Fully verified</span>
                            </div>
                        </div>
                    </div>
                    <div id="mynetwork"></div>
                </div>
            </div>
            
            <div class="resizer" id="horizontal-resizer"></div>
            
            <div id="info-panel">
                <div id="info-content">
                    <div class="placeholder">
                        <div class="placeholder-icon">📊</div>
                        <p>Click on a node to view its details</p>
                    </div>
                </div>
            </div>
        </div>
        
        <script type="text/javascript">
            // Store node information
            var nodeInfo = {"tc_1": {"id": "tc_1", "natural_language": "Let~$p^n$ be a power of an odd prime.", "statement": "Premise:\n\u2022 $p$ is an odd prime and $n \\ge 1$ is an integer [tc_1].", "dependencies": [], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nvariable (p : \u2115) (n : \u2115)\n(tc_1 : Nat.Prime p \u2227 p \u2260 2 \u2227 n \u2265 1)", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The Lean formalization 'Nat.Prime p \u2227 p \u2260 2' perfectly captures 'p is an odd prime' since 2 is the only even prime, so a prime not equal to 2 is necessarily odd.", "The Lean formalization '(n : \u2115)' with 'n \u2265 1' perfectly captures 'n \u2265 1 is an integer' since natural numbers with the constraint n \u2265 1 represents exactly the positive integers."]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "type": "condition"}, "def_1": {"id": "def_1", "natural_language": "The primitive roots modulo~$n$ are the generators of $(\\zmod{n})^*$,", "statement": "We assume:\n\u2022 $p$ is an odd prime and $n \\ge 1$ is an integer [tc_1].\nDefinition:\n\u2022 A primitive root modulo $p^n$ is a generator of the multiplicative group of integers modulo $p^n$, $(\\zmod{p^n})^*$ [def_1].", "dependencies": ["tc_1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nvariable (p : \u2115) (n : \u2115)\n(tc_1 : Nat.Prime p \u2227 p \u2260 2 \u2227 n \u2265 1)\n(def_1 : \u2200 a : ZMod (p^n), IsPrimitiveRoot a (p^n))", "lean_pass": true, "error_msg": [], "tries": 3}, "solved_lemma": {}, "score": {"semantic_score": 0.0, "semantic_feedback": ["The Lean condition `Nat.Prime p \u2227 p \u2260 2 \u2227 n \u2265 1` correctly captures that p is an odd prime (prime and not 2) and n \u2265 1 is an integer. This matches the first two natural language conditions.", "The Lean statement `\u2200 a : ZMod (p^n), IsPrimitiveRoot a (p^n)` claims that every element in ZMod (p^n) is a primitive root, which is mathematically false. The natural language only defines what a primitive root is (a generator of the multiplicative group), but doesn't claim all elements are primitive roots. The Lean formalization introduces a contradicting logical component by asserting something that is not true."]}, "error_report": {"error_type": "Formalizer", "error_report": "Formalization is likely incorrect: semantic score is 0.0, below threshold 0.6.\nScorer feedback: ['The Lean condition `Nat.Prime p \u2227 p \u2260 2 \u2227 n \u2265 1` correctly captures that p is an odd prime (prime and not 2) and n \u2265 1 is an integer. This matches the first two natural language conditions.', \"The Lean statement `\u2200 a : ZMod (p^n), IsPrimitiveRoot a (p^n)` claims that every element in ZMod (p^n) is a primitive root, which is mathematically false. The natural language only defines what a primitive root is (a generator of the multiplicative group), but doesn't claim all elements are primitive roots. The Lean formalization introduces a contradicting logical component by asserting something that is not true.\"]"}, "type": "definition"}, "l1": {"id": "l1", "natural_language": "which by assumption is cyclic", "statement": "We assume:\n\u2022 $p$ is an odd prime and $n \\ge 1$ is an integer [tc_1];\n\u2022 A primitive root modulo $p^n$ is a generator of the multiplicative group of integers modulo $p^n$, $(\\zmod{p^n})^*$ [def_1].\nTherefore, we conclude:\n\u2022 The group $(\\zmod{p^n})^*$ is cyclic [l1].", "dependencies": ["tc_1", "def_1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l1\n  (p : \u2115) (n : \u2115)\n  (tc_1 : Nat.Prime p \u2227 p \u2260 2 \u2227 n \u2265 1)\n  (def_1 : \u2200 a : ZMod (p^n), IsPrimitiveRoot a (p^n)) :\n  IsCyclic ((ZMod (p ^ n))\u02e3) := by\nsorry", "lean_pass": true, "error_msg": [], "tries": 2}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l1\n  (p : \u2115) (n : \u2115)\n  (tc_1 : Nat.Prime p \u2227 p \u2260 2 \u2227 n \u2265 1)\n  (def_1 : \u2200 a : ZMod (p^n), IsPrimitiveRoot a (p^n)) :\n  IsCyclic ((ZMod (p ^ n))\u02e3) := by\n  obtain \u27e8hprime, hodd, hn\u27e9 := tc_1\n  refine' \u27e81, fun x => \u27e8x, def_1 x\u27e9\u27e9", "lean_pass": false, "lean_verify": false, "error_msg": [{"line": 11, "column": 24, "endLine": 11, "endColumn": 25, "data": "application type mismatch\n  Exists.intro x\nargument\n  x\nhas type\n  (ZMod (p ^ n))\u02e3 : Type\nbut is expected to have type\n  \u2124 : Type"}], "tries": 5}, "score": {"semantic_score": 0, "semantic_feedback": ["The type constraints tc_1 correctly capture that p is an odd prime (Nat.Prime p \u2227 p \u2260 2) and n \u2265 1, matching the natural language exactly.", "The definition def_1 has a major logical error. The natural language defines what a primitive root IS (a generator of the multiplicative group), but the Lean formalization incorrectly assumes that every element a : ZMod (p^n) is a primitive root, which is mathematically false. The correct formalization should define the concept of primitive root or assume existence of at least one primitive root, not that all elements are primitive roots.", "The conclusion l1 perfectly captures that the multiplicative group (ZMod (p^n))\u02e3 is cyclic, which correctly corresponds to the natural language statement about (\u2124/p^n\u2124)* being cyclic.", "The tactics contained syntactic mistakes, so final score is 0."]}, "error_report": {"error_type": "Formalizer", "error_report": "Formalization is likely incorrect: semantic score is 0.0, below threshold 0.6.\nScorer feedback: ['The type constraints tc_1 correctly capture that p is an odd prime (Nat.Prime p \u2227 p \u2260 2) and n \u2265 1, matching the natural language exactly.', 'The definition def_1 has a major logical error. The natural language defines what a primitive root IS (a generator of the multiplicative group), but the Lean formalization incorrectly assumes that every element a : ZMod (p^n) is a primitive root, which is mathematically false. The correct formalization should define the concept of primitive root or assume existence of at least one primitive root, not that all elements are primitive roots.', 'The conclusion l1 perfectly captures that the multiplicative group (ZMod (p^n))\u02e3 is cyclic, which correctly corresponds to the natural language statement about (\u2124/p^n\u2124)* being cyclic.']"}, "solved_negation": null, "type": "lemma"}, "l2": {"id": "l2", "natural_language": "of order~$\\\u000bphi(n)$", "statement": "We assume:\n\u2022 $p$ is an odd prime and $n \\ge 1$ is an integer [tc_1];\n\u2022 A primitive root modulo $p^n$ is a generator of the multiplicative group of integers modulo $p^n$, $(\\zmod{p^n})^*$ [def_1];\n\u2022 The group $(\\zmod{p^n})^*$ is cyclic [l1].\nTherefore, we conclude:\n\u2022 The order of the group $(\\zmod{p^n})^*$ is $\\\u000bphi(p^n)$ [l2].", "dependencies": ["tc_1", "def_1", "l1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l2\n  (p : \u2115) (n : \u2115)\n  (_ : Fact (Nat.Prime p))\n  (_ : p \u2260 2)\n  (_ : n \u2265 1) :\n  Fintype.card ((ZMod (p ^ n))\u02e3) = \u03c6 (p ^ n) := by\nsorry", "lean_pass": true, "error_msg": [], "tries": 5}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l2\n  (p : \u2115) (n : \u2115)\n  (_ : Fact (Nat.Prime p))\n  (_ : p \u2260 2)\n  (_ : n \u2265 1) :\n  Fintype.card ((ZMod (p ^ n))\u02e3) = \u03c6 (p ^ n) := by\n  rw [ZMod.card_units_eq_totient]", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 0.0, "semantic_feedback": ["The assumptions about p being an odd prime and n \u2265 1 are correctly captured. The Lean formalization uses `Fact (Nat.Prime p)` and `p \u2260 2` to express that p is an odd prime, which is mathematically equivalent to the natural language statement.", "The definition of primitive root as a generator of the multiplicative group is completely missing from the Lean formalization. This is a key conceptual component that should be present.", "The assumption that the group (\u2124/p^n \u2124)* is cyclic is not stated in the Lean formalization. This is an important mathematical assumption that is missing from the formal statement.", "The conclusion about the order of the group is perfectly captured. `Fintype.card ((ZMod (p ^ n))\u02e3)` correctly represents the order of the multiplicative group, and `\u03c6 (p ^ n)` represents Euler's totient function."]}, "error_report": {"error_type": "Formalizer", "error_report": "Formalization is likely incorrect: semantic score is 0.0, below threshold 0.6.\nScorer feedback: ['The assumptions about p being an odd prime and n \u2265 1 are correctly captured. The Lean formalization uses `Fact (Nat.Prime p)` and `p \u2260 2` to express that p is an odd prime, which is mathematically equivalent to the natural language statement.', 'The definition of primitive root as a generator of the multiplicative group is completely missing from the Lean formalization. This is a key conceptual component that should be present.', 'The assumption that the group (\u2124/p^n \u2124)* is cyclic is not stated in the Lean formalization. This is an important mathematical assumption that is missing from the formal statement.', \"The conclusion about the order of the group is perfectly captured. `Fintype.card ((ZMod (p ^ n))\u02e3)` correctly represents the order of the multiplicative group, and `\u03c6 (p ^ n)` represents Euler's totient function.\"]"}, "solved_negation": null, "type": "lemma"}, "l3": {"id": "l3", "natural_language": "Thus they are in bijection with the generators of any cyclic group of order $\\\u000bphi(n)$.", "statement": "We assume:\n\u2022 $p$ is an odd prime and $n \\ge 1$ is an integer [tc_1];\n\u2022 A primitive root modulo $p^n$ is a generator of the multiplicative group of integers modulo $p^n$, $(\\zmod{p^n})^*$ [def_1];\n\u2022 The group $(\\zmod{p^n})^*$ is cyclic [l1];\n\u2022 The order of the group $(\\zmod{p^n})^*$ is $\\\u000bphi(p^n)$ [l2].\nTherefore, we conclude:\n\u2022 The set of primitive roots modulo $p^n$ is in bijection with the set of generators of any cyclic group of order $\\\u000bphi(p^n)$ [l3].", "dependencies": ["tc_1", "def_1", "l1", "l2"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l3\n  (p : \u2115) (n : \u2115)\n  (tc_1 : Nat.Prime p \u2227 p \u2260 2 \u2227 n \u2265 1)\n  (def_1 : \u2200 a : ZMod (p^n), IsPrimitiveRoot a (p^n))\n  (l1 : IsCyclic ((ZMod (p ^ n))\u02e3))\n  (l2 : Fintype.card ((ZMod (p ^ n))\u02e3) = \u03c6 (p ^ n)) :\n  \u2203 (H : Type) (_ : CommGroup H) (_ : Fintype H) (_ : IsCyclic H) (_ : Fintype.card H = \u03c6 (p ^ n)),\n    Nonempty (H \u2243* (ZMod (p^n))\u02e3) \u2227\n    Set.Countable {x : (ZMod (p^n))\u02e3 | IsPrimitiveRoot x (p^n)} \u2227\n    Set.Countable {g' : H | IsPrimitiveRoot g' (Fintype.card H)} := by\nsorry", "lean_pass": false, "error_msg": [{"line": 10, "column": 8, "endLine": 10, "endColumn": 38, "data": "failed to synthesize\n  Fintype (ZMod (p ^ n))\u02e3\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}], "tries": 5}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l3\n  (p : \u2115) (n : \u2115)\n  (tc_1 : Nat.Prime p \u2227 p \u2260 2 \u2227 n \u2265 1)\n  (def_1 : \u2200 a : ZMod (p^n), IsPrimitiveRoot a (p^n))\n  (l1 : IsCyclic ((ZMod (p ^ n))\u02e3))\n  (l2 : Fintype.card ((ZMod (p ^ n))\u02e3) = \u03c6 (p ^ n)) :\n  \u2203 (H : Type) (_ : CommGroup H) (_ : Fintype H) (_ : IsCyclic H) (_ : Fintype.card H = \u03c6 (p ^ n)),\n    Nonempty (H \u2243* (ZMod (p^n))\u02e3) \u2227\n    Nonempty ({x : (ZMod (p^n))\u02e3 | IsPrimitiveRoot x (p^n)} \u2243 {g' : H | IsPrimitiveRoot g' (Fintype.card H)}) := by\n  let H := (ZMod (p^n))\u02e3\n  haveI : Fintype H := inferInstance\n  refine \u27e8H, inferInstance, inferInstance, l1, l2, \u27e8MulEquiv.refl H\u27e9, ?_\u27e9\n  refine \u27e8\u27e8Equiv.refl _\u27e9\u27e9", "lean_pass": false, "lean_verify": false, "error_msg": [{"line": 10, "column": 8, "endLine": 10, "endColumn": 38, "data": "failed to synthesize\n  Fintype (ZMod (p ^ n))\u02e3\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 15, "column": 23, "endLine": 15, "endColumn": 36, "data": "failed to synthesize\n  Fintype H\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 17, "column": 10, "endLine": 17, "endColumn": 24, "data": "invalid constructor \u27e8...\u27e9, insufficient number of arguments, constructs 'Equiv.mk' has #4 explicit fields, but only #1 provided"}], "tries": 5}, "score": {"semantic_score": 0, "semantic_feedback": "Failed Lean syntax check already."}, "error_report": {"error_type": "Formalization", "error_report": "Formalized statement is not a valid Lean4 statement"}, "solved_negation": null, "type": "lemma"}, "l4": {"id": "l4", "natural_language": "In particular, the number of primitive roots modulo~$n$ is the same as the number of elements of $\\zmod{\\\u000bphi(n)}$ with additive order $\\\u000bphi(n)$.", "statement": "We assume:\n\u2022 $p$ is an odd prime and $n \\ge 1$ is an integer [tc_1];\n\u2022 A primitive root modulo $p^n$ is a generator of the multiplicative group of integers modulo $p^n$, $(\\zmod{p^n})^*$ [def_1];\n\u2022 The group $(\\zmod{p^n})^*$ is cyclic [l1];\n\u2022 The order of the group $(\\zmod{p^n})^*$ is $\\\u000bphi(p^n)$ [l2];\n\u2022 The set of primitive roots modulo $p^n$ is in bijection with the set of generators of any cyclic group of order $\\\u000bphi(p^n)$ [l3].\nTherefore, we conclude:\n\u2022 The number of primitive roots modulo $p^n$ is equal to the number of elements in the additive group $\\zmod{\\\u000bphi(p^n)}$ that have additive order $\\\u000bphi(p^n)$ [l4].", "dependencies": ["tc_1", "def_1", "l1", "l2", "l3"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l4\n  (p : \u2115) (n : \u2115)\n  (hp : Nat.Prime p) (hp_ne_2 : p \u2260 2) (hn : n \u2265 1)\n  (l1 : IsCyclic ((ZMod (p ^ n))\u02e3))\n  (l2 : Fintype.card ((ZMod (p ^ n))\u02e3) = \u03c6 (p ^ n))\n  (l3 : Fintype.card ((ZMod (p ^ n))\u02e3).primitiveRoots = Fintype.card (ZMod (\u03c6 (p ^ n)))) :\n  Fintype.card ((ZMod (p ^ n))\u02e3).primitiveRoots = Fintype.card {x : ZMod (\u03c6 (p ^ n)) // AddOrder.orderOf x = \u03c6 (p ^ n)} := by\nsorry", "lean_pass": false, "error_msg": [{"line": 9, "column": 8, "endLine": 9, "endColumn": 38, "data": "failed to synthesize\n  Fintype (ZMod (p ^ n))\u02e3\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 10, "column": 21, "endLine": 10, "endColumn": 53, "data": "invalid field notation, type is not of the form (C ...) where C is a constant\n  (ZMod (p ^ n))\u02e3\nhas type\n  Type"}, {"line": 10, "column": 56, "endLine": 10, "endColumn": 87, "data": "failed to synthesize\n  Fintype (ZMod (\u03c6 (p ^ n)))\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 11, "column": 15, "endLine": 11, "endColumn": 47, "data": "invalid field notation, type is not of the form (C ...) where C is a constant\n  (ZMod (p ^ n))\u02e3\nhas type\n  Type"}, {"line": 11, "column": 88, "endLine": 11, "endColumn": 104, "data": "unknown identifier 'AddOrder.orderOf'"}], "tries": 5}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l4\n  (p : \u2115) (n : \u2115)\n  (hp : Nat.Prime p) (hp_ne_2 : p \u2260 2) (hn : n \u2265 1)\n  [Fintype (ZMod (p ^ n))\u02e3]\n  [Fintype (ZMod (\u03c6 (p ^ n)))]\n  (l1 : IsCyclic ((ZMod (p ^ n))\u02e3))\n  (l2 : Fintype.card ((ZMod (p ^ n))\u02e3) = \u03c6 (p ^ n))\n  (l3 : Fintype.card {x : (ZMod (p ^ n))\u02e3 | IsPrimitiveRoot x (p ^ n)} = Fintype.card (ZMod (\u03c6 (p ^ n)))) :\n  Fintype.card {x : (ZMod (p ^ n))\u02e3 | IsPrimitiveRoot x (p ^ n)} = Fintype.card {x : ZMod (\u03c6 (p ^ n)) | orderOf x = \u03c6 (p ^ n)} := by\n  rw [l3]\n  let G := ZMod (\u03c6 (p ^ n))\n  have : Fintype G := by infer_instance\n  have : Fintype {x : G | orderOf x = \u03c6 (p ^ n)} := by infer_instance\n  have : Fintype {x : (ZMod (p ^ n))\u02e3 | IsPrimitiveRoot x (p ^ n)} := by infer_instance\n  congr\n  ext x\n  simp [orderOf_eq_iff, Nat.pos_iff_ne_zero.mp (\u03c6_pos (pow_pos hp.pos n))]", "lean_pass": false, "lean_verify": false, "error_msg": [{"line": 12, "column": 8, "endLine": 12, "endColumn": 70, "data": "failed to synthesize\n  Fintype \u2191{x | IsPrimitiveRoot x (p ^ n)}\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 13, "column": 2, "endLine": 13, "endColumn": 64, "data": "failed to synthesize\n  Fintype \u2191{x | IsPrimitiveRoot x (p ^ n)}\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 18, "column": 73, "endLine": 18, "endColumn": 87, "data": "failed to synthesize\n  Fintype \u2191{x | IsPrimitiveRoot x (p ^ n)}\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 20, "column": 2, "endLine": 20, "endColumn": 7, "data": "no applicable extensionality theorem found for\n  Type"}], "tries": 5}, "score": {"semantic_score": 0, "semantic_feedback": "Failed Lean syntax check already."}, "error_report": {"error_type": "Formalization", "error_report": "Formalized statement is not a valid Lean4 statement"}, "solved_negation": null, "type": "lemma"}, "l5": {"id": "l5", "natural_language": "An element of $\\zmod{\\\u000bphi(n)}$ has additive order $\\\u000bphi(n)$ if and only if it is coprime to $\\\u000bphi(n)$.", "statement": "We assume:\n\u2022 $p$ is an odd prime and $n \\ge 1$ is an integer [tc_1];\n\u2022 A primitive root modulo $p^n$ is a generator of the multiplicative group of integers modulo $p^n$, $(\\zmod{p^n})^*$ [def_1];\n\u2022 The group $(\\zmod{p^n})^*$ is cyclic [l1];\n\u2022 The order of the group $(\\zmod{p^n})^*$ is $\\\u000bphi(p^n)$ [l2];\n\u2022 The set of primitive roots modulo $p^n$ is in bijection with the set of generators of any cyclic group of order $\\\u000bphi(p^n)$ [l3];\n\u2022 The number of primitive roots modulo $p^n$ is equal to the number of elements in the additive group $\\zmod{\\\u000bphi(p^n)}$ that have additive order $\\\u000bphi(p^n)$ [l4].\nTherefore, we conclude:\n\u2022 An element $x$ in the additive group $\\zmod{\\\u000bphi(p^n)}$ has order $\\\u000bphi(p^n)$ if and only if $x$ is coprime to $\\\u000bphi(p^n)$ [l5].", "dependencies": ["tc_1", "def_1", "l1", "l2", "l3", "l4"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l5\n  (p : \u2115) (n : \u2115)\n  [Fact (Nat.Prime p)] [Fact (p \u2260 2)] [Fact (n \u2265 1)]\n  (tc_1 : Nat.Prime p \u2227 p \u2260 2 \u2227 n \u2265 1)\n  (def_1 : \u2200 a : ZMod (p^n), IsPrimitiveRoot a (p^n))\n  (l1 : IsCyclic ((ZMod (p ^ n))\u02e3))\n  (l2 : Fintype.card ((ZMod (p ^ n))\u02e3) = \u03c6 (p ^ n))\n  (l3 : sorry)\n  (l4 : sorry) :\n  \u2200 (x : ZMod (\u03c6 (p^n))), orderOf x = \u03c6 (p^n) \u2194 Nat.gcd (ZMod.val x) (\u03c6 (p^n)) = 1 := by\nsorry", "lean_pass": true, "error_msg": [], "tries": 3}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l5\n  (p : \u2115) (n : \u2115)\n  [Fact (Nat.Prime p)] [Fact (p \u2260 2)] [Fact (n \u2265 1)]\n  (tc_1 : Nat.Prime p \u2227 p \u2260 2 \u2227 n \u2265 1)\n  (def_1 : \u2200 a : ZMod (p^n), IsPrimitiveRoot a (p^n))\n  (l1 : IsCyclic ((ZMod (p ^ n))\u02e3))\n  (l2 : Fintype.card ((ZMod (p ^ n))\u02e3) = \u03c6 (p ^ n))\n  (l3 : sorry)\n  (l4 : sorry) :\n  \u2200 (x : ZMod (\u03c6 (p^n))), orderOf x = \u03c6 (p^n) \u2194 Nat.gcd (ZMod.val x) (\u03c6 (p^n)) = 1 := by\n  intro x\n  rw [orderOf_eq_iff]\n  simp only [ZMod.nat_cast_zmod_val]\n  rw [Nat.coprime_iff_gcd_eq_one]\n  exact Iff.rfl", "lean_pass": false, "lean_verify": false, "error_msg": [{"line": 17, "column": 2, "endLine": 17, "endColumn": 36, "data": "simp made no progress"}], "tries": 5}, "score": {"semantic_score": 0, "semantic_feedback": ["The type constraints [tc_1] are correctly formalized with appropriate Fact instances and the explicit conjunction tc_1, properly capturing that p is an odd prime and n \u2265 1.", "The definition def_1 has a major logical error. It states '\u2200 a : ZMod (p^n), IsPrimitiveRoot a (p^n)' which means every element is a primitive root, contradicting the natural language that defines what a primitive root IS rather than claiming all elements are primitive roots. This should define the concept, not make a universal claim.", "The assumption l1 correctly formalizes that (\u2124/p^n)* is cyclic using 'IsCyclic ((ZMod (p ^ n))\u02e3)' where the \u02e3 notation properly represents the multiplicative group of units.", "The assumption l2 correctly captures that the order of (\u2124/p^n)* is \u03c6(p^n) using 'Fintype.card ((ZMod (p ^ n))\u02e3) = \u03c6 (p ^ n)', properly relating cardinality to Euler's totient function.", "The assumptions l3 and l4 are appropriately left as 'sorry' placeholders, which is reasonable for intermediate steps in the logical chain that aren't the main focus.", "The conclusion l5 correctly formalizes the key mathematical relationship using 'orderOf x = \u03c6 (p^n) \u2194 Nat.gcd (ZMod.val x) (\u03c6 (p^n)) = 1', properly capturing the equivalence between having full order and being coprime.", "The overall logical structure and mathematical content of the main theorem statement accurately reflects the natural language conclusion about the characterization of elements with maximal additive order.", "The tactics contained syntactic mistakes, so final score is 0."]}, "error_report": {"error_type": "Formalizer", "error_report": "Formalization is likely incorrect: semantic score is 0.0, below threshold 0.6.\nScorer feedback: ['The type constraints [tc_1] are correctly formalized with appropriate Fact instances and the explicit conjunction tc_1, properly capturing that p is an odd prime and n \u2265 1.', \"The definition def_1 has a major logical error. It states '\u2200 a : ZMod (p^n), IsPrimitiveRoot a (p^n)' which means every element is a primitive root, contradicting the natural language that defines what a primitive root IS rather than claiming all elements are primitive roots. This should define the concept, not make a universal claim.\", \"The assumption l1 correctly formalizes that (\u2124/p^n)* is cyclic using 'IsCyclic ((ZMod (p ^ n))\u02e3)' where the \u02e3 notation properly represents the multiplicative group of units.\", \"The assumption l2 correctly captures that the order of (\u2124/p^n)* is \u03c6(p^n) using 'Fintype.card ((ZMod (p ^ n))\u02e3) = \u03c6 (p ^ n)', properly relating cardinality to Euler's totient function.\", \"The assumptions l3 and l4 are appropriately left as 'sorry' placeholders, which is reasonable for intermediate steps in the logical chain that aren't the main focus.\", \"The conclusion l5 correctly formalizes the key mathematical relationship using 'orderOf x = \u03c6 (p^n) \u2194 Nat.gcd (ZMod.val x) (\u03c6 (p^n)) = 1', properly capturing the equivalence between having full order and being coprime.\", 'The overall logical structure and mathematical content of the main theorem statement accurately reflects the natural language conclusion about the characterization of elements with maximal additive order.']"}, "solved_negation": null, "type": "lemma"}, "ts_1": {"id": "ts_1", "natural_language": "There are $\\\u000bphi(\\\u000bphi(n))$ such elements, as claimed.", "statement": "We assume:\n\u2022 $p$ is an odd prime and $n \\ge 1$ is an integer [tc_1];\n\u2022 A primitive root modulo $p^n$ is a generator of the multiplicative group of integers modulo $p^n$, $(\\zmod{p^n})^*$ [def_1];\n\u2022 The group $(\\zmod{p^n})^*$ is cyclic [l1];\n\u2022 The order of the group $(\\zmod{p^n})^*$ is $\\\u000bphi(p^n)$ [l2];\n\u2022 The set of primitive roots modulo $p^n$ is in bijection with the set of generators of any cyclic group of order $\\\u000bphi(p^n)$ [l3];\n\u2022 The number of primitive roots modulo $p^n$ is equal to the number of elements in the additive group $\\zmod{\\\u000bphi(p^n)}$ that have additive order $\\\u000bphi(p^n)$ [l4];\n\u2022 An element $x$ in the additive group $\\zmod{\\\u000bphi(p^n)}$ has order $\\\u000bphi(p^n)$ if and only if $x$ is coprime to $\\\u000bphi(p^n)$ [l5].\nTherefore, we conclude:\n\u2022 The number of primitive roots modulo $p^n$ is $\\\u000bphi(\\\u000bphi(p^n))$ [ts_1].", "dependencies": ["tc_1", "def_1", "l1", "l2", "l3", "l4", "l5"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma ts_1\n  (p : \u2115) (n : \u2115)\n  [Fact (Nat.Prime p)] [Fact (p \u2260 2)] [Fact (n \u2265 1)]\n  (tc_1 : Nat.Prime p \u2227 p \u2260 2 \u2227 n \u2265 1)\n  (def_1 : \u2200 a : ZMod (p^n), IsPrimitiveRoot a (p^n))\n  (l1 : IsCyclic ((ZMod (p ^ n))\u02e3))\n  (l2 : Fintype.card ((ZMod (p ^ n))\u02e3) = \u03c6 (p ^ n))\n  (l3 : sorry) -- The set of primitive roots modulo p^n is in bijection with the set of generators of any cyclic group of order \u03c6(p^n)\n  (l4 : sorry) -- The number of primitive roots modulo p^n is equal to the number of elements in the additive group ZMod(\u03c6(p^n)) that have additive order \u03c6(p^n)\n  (l5 : \u2200 (x : ZMod (\u03c6 (p^n))), orderOf x = \u03c6 (p^n) \u2194 Nat.gcd (ZMod.val x) (\u03c6 (p^n)) = 1) :\n  (Nat.card {g : (ZMod (p^n))\u02e3 // IsPrimitiveRoot g (p^n)}) = \u03c6 (\u03c6 (p^n)) := by\nsorry", "lean_pass": true, "error_msg": [], "tries": 4}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma ts_1\n  (p : \u2115) (n : \u2115)\n  [Fact (Nat.Prime p)] [Fact (p \u2260 2)] [Fact (n \u2265 1)]\n  (tc_1 : Nat.Prime p \u2227 p \u2260 2 \u2227 n \u2265 1)\n  (def_1 : \u2200 a : ZMod (p^n), IsPrimitiveRoot a (p^n))\n  (l1 : IsCyclic ((ZMod (p ^ n))\u02e3))\n  (l2 : Fintype.card ((ZMod (p ^ n))\u02e3) = \u03c6 (p ^ n))\n  (l3 : \u2203 (G : Type) (_ : Group G) (_ : IsCyclic G) (_ : Fintype G), Fintype.card G = \u03c6 (p ^ n) \u2227 \n        Nonempty ({g : (ZMod (p^n))\u02e3 // IsPrimitiveRoot g (p^n)} \u2243 {g : G // orderOf g = Fintype.card G}))\n  (l4 : Nat.card {g : (ZMod (p^n))\u02e3 // IsPrimitiveRoot g (p^n)} = \n        Nat.card {x : ZMod (\u03c6 (p^n)) // orderOf x = \u03c6 (p^n)})\n  (l5 : \u2200 (x : ZMod (\u03c6 (p^n))), orderOf x = \u03c6 (p^n) \u2194 Nat.gcd (ZMod.val x) (\u03c6 (p^n)) = 1) :\n  (Nat.card {g : (ZMod (p^n))\u02e3 // IsPrimitiveRoot g (p^n)}) = \u03c6 (\u03c6 (p^n)) := by\n  rw [l4]\n  simp only [Nat.card_eq_fintype_card]\n  rw [Fintype.card_subtype]\n  simp only [l5, ZMod.val, Nat.cast_id]\n  rw [\u2190 Fintype.card_subtype]\n  simp only [Nat.Coprime, Nat.gcd_eq_one_iff_coprime]\n  rw [Fintype.card_congr (Equiv.subtypeEquiv (Equiv.refl _) (fun x => by simp))]\n  simp [ZMod.card]", "lean_pass": false, "lean_verify": false, "error_msg": [{"line": 23, "column": 26, "endLine": 23, "endColumn": 52, "data": "unknown constant 'Nat.gcd_eq_one_iff_coprime'"}, {"line": 23, "column": 2, "endLine": 23, "endColumn": 53, "data": "simp made no progress"}], "tries": 5}, "score": {"semantic_score": 0, "semantic_feedback": ["The type conditions correctly capture that p is an odd prime and n \u2265 1.", "The definition is fundamentally wrong - it states that ALL elements of ZMod(p^n) are primitive roots, which is mathematically false. It should define the property of being a primitive root, not claim universal primitive root-ness.", "Correctly states that the multiplicative group of ZMod(p^n) is cyclic.", "Correctly relates the cardinality of the multiplicative group to Euler's totient function.", "This is a placeholder (sorry), so the actual formalization cannot be evaluated.", "This is a placeholder (sorry), so the actual formalization cannot be evaluated.", "Correctly captures the equivalence between an element having maximal additive order and being coprime to the modulus.", "Correctly formalizes the conclusion that the number of primitive roots equals \u03c6(\u03c6(p^n)).", "The tactics contained syntactic mistakes, so final score is 0."]}, "error_report": {"error_type": "Formalizer", "error_report": "Formalization is likely incorrect: semantic score is 0.0, below threshold 0.6.\nScorer feedback: ['The type conditions correctly capture that p is an odd prime and n \u2265 1.', 'The definition is fundamentally wrong - it states that ALL elements of ZMod(p^n) are primitive roots, which is mathematically false. It should define the property of being a primitive root, not claim universal primitive root-ness.', 'Correctly states that the multiplicative group of ZMod(p^n) is cyclic.', \"Correctly relates the cardinality of the multiplicative group to Euler's totient function.\", 'This is a placeholder (sorry), so the actual formalization cannot be evaluated.', 'This is a placeholder (sorry), so the actual formalization cannot be evaluated.', 'Correctly captures the equivalence between an element having maximal additive order and being coprime to the modulus.', 'Correctly formalizes the conclusion that the number of primitive roots equals \u03c6(\u03c6(p^n)).']"}, "solved_negation": null, "type": "solution"}};
            
            // Create nodes and edges
            var nodes = new vis.DataSet([{"id": "tc_1", "label": "tc_1", "color": {"background": "#eba0a0", "border": "#00ff00", "highlight": {"background": "#eba0a0", "border": "#00ff00"}}, "shape": "box", "size": 30, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "def_1", "label": "def_1", "color": {"background": "#cfb795", "border": "#00ff00", "highlight": {"background": "#cfb795", "border": "#00ff00"}}, "shape": "box", "size": 30, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l1", "label": "l1", "color": {"background": "#8dafcc", "border": "#FFA500", "highlight": {"background": "#8dafcc", "border": "#FFA500"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l2", "label": "l2", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l3", "label": "l3", "color": {"background": "#8dafcc", "border": "#fa2c07", "highlight": {"background": "#8dafcc", "border": "#fa2c07"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l4", "label": "l4", "color": {"background": "#8dafcc", "border": "#fa2c07", "highlight": {"background": "#8dafcc", "border": "#fa2c07"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l5", "label": "l5", "color": {"background": "#8dafcc", "border": "#FFA500", "highlight": {"background": "#8dafcc", "border": "#FFA500"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "ts_1", "label": "ts_1", "color": {"background": "#a3c2a8", "border": "#FFA500", "highlight": {"background": "#a3c2a8", "border": "#FFA500"}}, "shape": "star", "size": 40, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}]);
            var edges = new vis.DataSet([{"from": "tc_1", "to": "def_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "l1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "l2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "l3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "l4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "l5", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_1", "to": "l1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_1", "to": "l2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_1", "to": "l3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_1", "to": "l4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_1", "to": "l5", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_1", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "l2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "l3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "l4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "l5", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l2", "to": "l3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l2", "to": "l4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l2", "to": "l5", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l2", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l3", "to": "l4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l3", "to": "l5", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l3", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l4", "to": "l5", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l4", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l5", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}]);
            
            // Create network
            var container = document.getElementById('mynetwork');
            var data = {
                nodes: nodes,
                edges: edges
            };
            
            var options = {
                physics: {
                    enabled: true,
                    solver: 'hierarchicalRepulsion',
                    hierarchicalRepulsion: {
                        centralGravity: 0.0,
                        springLength: 200,
                        springConstant: 0.01,
                        nodeDistance: 150,
                        damping: 0.09
                    }
                },
                edges: {
                    smooth: {
                        type: 'continuous',
                        forceDirection: 'none'
                    },
                    color: {
                        color: '#666666',
                        highlight: '#666666',
                        hover: '#666666'
                    },
                    width: 2
                },
                interaction: {
                    hover: true,
                    tooltipDelay: 100,
                    navigationButtons: true,
                    keyboard: true
                },
                nodes: {
                    font: {
                        size: 14,
                        color: '#000000'
                    },
                    labelHighlightBold: false,
                    chosen: false,
                    shapeProperties: {
                        useBorderWithImage: false
                    },
                    scaling: {
                        label: {
                            enabled: true,
                            min: 8,
                            max: 20,
                            maxVisible: 20,
                            drawThreshold: 5
                        }
                    }
                }
            };
            
            var network = new vis.Network(container, data, options);
            
            // Format field value for display
            function formatFieldValue(value, fieldName) {
                if (value === null || value === undefined) {
                    return 'N/A';
                }
                
                // Handle objects (dictionaries) as sub-boxes
                if (typeof value === 'object' && !Array.isArray(value)) {
                    var html = '';
                    for (var key in value) {
                        if (value.hasOwnProperty(key)) {
                            var subValue = value[key];
                            var subValueStr = '';
                            
                            if (typeof subValue === 'object' &&
                                    !Array.isArray(subValue)) {
                                // Nested object - show as JSON
                                subValueStr = JSON.stringify(subValue, null, 2);
                            } else if (Array.isArray(subValue)) {
                                // Array - show as JSON
                                subValueStr = JSON.stringify(subValue, null, 2);
                            } else {
                                // Primitive value
                                subValueStr = String(subValue);
                            }
                            
                            // Replace escaped newlines and tabs with actual characters
                            subValueStr = subValueStr.replace(/\\n/g, '\n');
                            subValueStr = subValueStr.replace(/\\t/g, '\t');
                            subValueStr = subValueStr.replace(/\t/g, '\t');
                            
                            html += '<div class="sub-dict">';
                            html += '<div class="sub-dict-title">' + key + '</div>';
                            html += '<div class="sub-dict-content">' + subValueStr + '</div>';
                            html += '</div>';
                        }
                    }
                    return html;
                }
                
                // Convert to string for primitive values and arrays
                var strValue = String(value);
                
                // Handle arrays
                if (Array.isArray(value)) {
                    strValue = JSON.stringify(value, null, 2);
                }
                
                // Replace escaped newlines and tabs with actual characters
                strValue = strValue.replace(/\\n/g, '\n');
                strValue = strValue.replace(/\\t/g, '\t');
                strValue = strValue.replace(/\t/g, '\t');
                
                return strValue;
            }
            
            // Handle node click events
            network.on("click", function(params) {
                if (params.nodes.length > 0) {
                    var nodeId = params.nodes[0];
                    var info = nodeInfo[nodeId];
                    
                    if (info) {
                        var html = '<div class="info-header">';
                        html += '<h2>' + nodeId + '</h2>';
                        var nodeType = info.type || 'unknown';
                        var capitalizedType = nodeType.charAt(0).toUpperCase() +
                            nodeType.slice(1);
                        html += '<div class="node-type">Type: ' + capitalizedType +
                            '</div>';
                        html += '</div>';
                        
                        // Add all fields
                        for (var key in info) {
                            if (key === 'type' || key === 'id') continue;
                            
                            var fieldName = key.replace(/_/g, ' ')
                                .replace(/\b\w/g, function(l) {
                                    return l.toUpperCase();
                                });
                            var fieldValue = formatFieldValue(info[key], fieldName);
                            
                            if (fieldValue && fieldValue !== 'N/A') {
                                // Special formatting for code fields
                                var isCode = key.includes('code') ||
                                    key.includes('lean') ||
                                    key.includes('statement');
                                
                                html += '<div class="field-group">';
                                html += '<div class="field-name">' + fieldName +
                                    '</div>';
                                html += '<div class="field-value' +
                                    (isCode ? ' code' : '') + '">' +
                                    fieldValue + '</div>';
                                html += '</div>';
                            }
                        }
                        
                        document.getElementById('info-content')
                            .innerHTML = html;
                    }
                }
            });
            
            // Toggle panel function
            function togglePanel() {
                var panel = document.getElementById('info-panel');
                panel.classList.toggle('hidden');
                
                // Resize network when panel is toggled
                setTimeout(function() {
                    network.fit();
                }, 300);
            }
            
            // Initial network fit
            network.once('stabilized', function() {
                network.fit();
            });
            
            // Resizable panels functionality
            function makeResizable() {
                const verticalResizer = document.getElementById('vertical-resizer');
                const horizontalResizer = document.getElementById('horizontal-resizer');
                const proofPanel = document.getElementById('proof-str-panel');
                const graphContainer = document.getElementById('graph-container');
                const infoPanel = document.getElementById('info-panel');
                const leftPanel = document.getElementById('left-panel');
                
                let isVerticalResizing = false;
                let isHorizontalResizing = false;
                
                // Vertical resizer (between proof panel and graph)
                verticalResizer.addEventListener('mousedown', function(e) {
                    isVerticalResizing = true;
                    document.addEventListener('mousemove', verticalResize);
                    document.addEventListener('mouseup', stopVerticalResize);
                    e.preventDefault();
                });
                
                function verticalResize(e) {
                    if (!isVerticalResizing) return;
                    
                    const containerHeight = leftPanel.offsetHeight;
                    const newHeight = e.clientY - leftPanel.offsetTop;
                    const minHeight = 100;
                    const maxHeight = containerHeight - 100;
                    
                    if (newHeight >= minHeight && newHeight <= maxHeight) {
                        proofPanel.style.height = newHeight + 'px';
                        graphContainer.style.height = (containerHeight - newHeight) + 'px';
                        network.fit();
                    }
                }
                
                function stopVerticalResize() {
                    isVerticalResizing = false;
                    document.removeEventListener('mousemove', verticalResize);
                    document.removeEventListener('mouseup', stopVerticalResize);
                }
                
                // Horizontal resizer (between left and right panels)
                horizontalResizer.addEventListener('mousedown', function(e) {
                    isHorizontalResizing = true;
                    document.addEventListener('mousemove', horizontalResize);
                    document.addEventListener('mouseup', stopHorizontalResize);
                    e.preventDefault();
                });
                
                function horizontalResize(e) {
                    if (!isHorizontalResizing) return;
                    
                    const containerWidth = document.querySelector('.container').offsetWidth;
                    const newWidth = e.clientX - leftPanel.offsetLeft;
                    const minWidth = 300;
                    const maxWidth = containerWidth - 300;
                    
                    if (newWidth >= minWidth && newWidth <= maxWidth) {
                        leftPanel.style.flex = 'none';
                        leftPanel.style.width = newWidth + 'px';
                        infoPanel.style.width = (containerWidth - newWidth) + 'px';
                        network.fit();
                    }
                }
                
                function stopHorizontalResize() {
                    isHorizontalResizing = false;
                    document.removeEventListener('mousemove', horizontalResize);
                    document.removeEventListener('mouseup', stopHorizontalResize);
                }
            }
            
            // Initialize resizable panels
            makeResizable();
        </script>
    </body>
    </html>
    