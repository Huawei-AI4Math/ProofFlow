
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Proof Graph Visualization</title>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
        <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.css" rel="stylesheet" type="text/css" />
        <style>
            body {
                margin: 0;
                padding: 0;
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
                height: 100vh;
                overflow: hidden;
            }
            
            .container {
                display: flex;
                height: 100vh;
                background: #f0f0f0;
            }
            
            #left-panel {
                flex: 1;
                display: flex;
                flex-direction: column;
                background: white;
                border-right: 2px solid #ddd;
                height: 100vh;
                overflow: hidden;
            }
            
            #proof-str-panel {
                background: #f8f9fa;
                border-bottom: 2px solid #ddd;
                padding: 15px;
                height: 200px;
                overflow-y: auto;
                flex-shrink: 0;
            }
            
            #proof-str-title {
                font-weight: 600;
                color: #2d3748;
                margin-bottom: 10px;
                font-size: 14px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
            
            #proof-str-content {
                color: #4a5568;
                line-height: 1.6;
                white-space: pre-wrap;
                word-wrap: break-word;
                font-family: 'Monaco', 'Courier New', monospace;
                font-size: 13px;
                background: white;
                padding: 12px;
                border-radius: 4px;
                border: 1px solid #e2e8f0;
            }
            
            #graph-container {
                flex: 1;
                position: relative;
                background: white;
                min-height: 0;
                overflow: hidden;
            }
            
            #mynetwork {
                width: 100%;
                height: 100%;
            }
            
            #info-panel {
                width: 40%;
                max-width: 600px;
                background: white;
                overflow-y: auto;
                padding: 20px;
                box-shadow: -2px 0 10px rgba(0,0,0,0.1);
            }
            
            #info-panel.hidden {
                display: none;
            }
            
            .info-header {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                padding: 15px;
                border-radius: 8px;
                margin-bottom: 20px;
            }
            
            .info-header h2 {
                margin: 0;
                font-size: 24px;
            }
            
            .info-header .node-type {
                opacity: 0.9;
                font-size: 14px;
                margin-top: 5px;
            }
            
            .field-group {
                background: #f8f9fa;
                border-left: 4px solid #667eea;
                padding: 15px;
                margin-bottom: 15px;
                border-radius: 4px;
            }
            
            .field-name {
                font-weight: 600;
                color: #2d3748;
                margin-bottom: 8px;
                font-size: 14px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
            
            .field-value {
                color: #4a5568;
                line-height: 1.6;
                white-space: pre-wrap;
                word-wrap: break-word;
                font-family: 'Monaco', 'Courier New', monospace;
                font-size: 13px;
            }
            
            .field-value.code {
                color: #4a5568;
                padding: 12px;
                border-radius: 4px;
                overflow-x: auto;
            }
            
            .sub-dict {
                background: #ffffff;
                border: 1px solid #e2e8f0;
                border-radius: 4px;
                padding: 10px;
                margin: 8px 0;
                box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            }
            
            .sub-dict-title {
                font-weight: 600;
                color: #4a5568;
                margin-bottom: 8px;
                font-size: 12px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                border-bottom: 1px solid #e2e8f0;
                padding-bottom: 4px;
            }
            
            .sub-dict-content {
                color: #2d3748;
                line-height: 1.5;
                font-size: 12px;
            }
            
            .placeholder {
                text-align: center;
                color: #718096;
                padding: 40px;
                font-size: 18px;
            }
            
            .placeholder-icon {
                font-size: 48px;
                margin-bottom: 20px;
                opacity: 0.3;
            }
            
            #toggle-panel {
                position: absolute;
                right: 10px;
                top: 10px;
                z-index: 1000;
                background: #667eea;
                color: white;
                border: none;
                padding: 10px 20px;
                border-radius: 5px;
                cursor: pointer;
                font-size: 14px;
                transition: background 0.3s;
            }
            
            #toggle-panel:hover {
                background: #764ba2;
            }
            
            .legend {
                position: absolute;
                top: 20px;
                left: 20px;
                background: white;
                padding: 15px;
                border-radius: 8px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
                z-index: 100;
                max-width: 300px;
            }
            
            .legend-section {
                margin-bottom: 15px;
            }
            
            .legend-section:last-child {
                margin-bottom: 0;
            }
            
            .legend-title {
                font-weight: 600;
                font-size: 12px;
                color: #2d3748;
                margin-bottom: 8px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                border-bottom: 1px solid #e2e8f0;
                padding-bottom: 4px;
            }
            
            .legend-item {
                display: flex;
                align-items: center;
                margin-bottom: 8px;
            }
            
            .legend-item:last-child {
                margin-bottom: 0;
            }
            
            .legend-color {
                width: 20px;
                height: 20px;
                margin-right: 10px;
                border-radius: 3px;
            }
            
            .resizer {
                background: #ddd;
                cursor: col-resize;
                width: 4px;
                height: 100%;
                position: absolute;
                right: 0;
                top: 0;
                z-index: 1000;
            }
            
            .resizer:hover {
                background: #bbb;
            }
            
            .resizer-vertical {
                background: #ddd;
                cursor: row-resize;
                height: 4px;
                width: 100%;
                position: absolute;
                bottom: 0;
                left: 0;
                z-index: 1000;
            }
            
            .resizer-vertical:hover {
                background: #bbb;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div id="left-panel">
                <div id="proof-str-panel">
                    <div id="proof-str-title">Informal theorem and proof</div>
                    <div id="proof-str-content">Theorem: Prove that for all real numbers $x$ and $y$, the following inequality holds: $3(x+y+1)^{2}+1 \geq 3 x y$.

Proof: We want to prove that $3(x+y+1)^{2}+1 \geq 3xy$ for all real numbers $x,y$. Observe first that for any real numbers $a,b$, the identity $(a+	frac{b}{2})^2+	frac{3b^2}{4}=a^2+ab+b^2$ shows that $a^2+ab+b^2\geq 0$, since both terms on the left are non-negative. Now set $a=x+	frac{2}{3}$ and $b=y+	frac{2}{3}$. Substituting into this inequality gives $(x+	frac{2}{3})^2+(x+	frac{2}{3})(y+	frac{2}{3})+(y+	frac{2}{3})^2\geq 0$. Expanding and simplifying yields $x^2+y^2+xy+2x+2y+	frac{4}{3}\geq 0$, and multiplying through by 3 gives $3x^2+3y^2+3xy+6x+6y+4\geq 0$. On the other hand, expanding the left-hand side of the target inequality gives $3(x+y+1)^2+1=3x^2+3y^2+6xy+6x+6y+4$. Subtracting $3xy$ from this expression gives exactly $3x^2+3y^2+3xy+6x+6y+4$, which we have already shown is non-negative. Therefore, $3(x+y+1)^2+1\geq 3xy$ holds for all real $x,y$.
</div>
                    <div class="resizer-vertical" id="vertical-resizer"></div>
                </div>
                <div id="graph-container">
                    <button id="toggle-panel" onclick="togglePanel()">Toggle Info Panel</button>
                    <div class="legend">
                        <div class="legend-section">
                            <div class="legend-title">Node Types</div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #eba0a0;"></div>
                                <span>Theorem Conditions (tc)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #cfb795 ;"></div>
                                <span>Theorem Definitions (def)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #8dafcc;"></div>
                                <span>Lemmas (l)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #a3c2a8;"></div>
                                <span>Theorem Solutions (ts)</span>
                            </div>

                        </div>
                        <div class="legend-section">
                            <div class="legend-title">Verification Status</div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #fa2c07;"></div>
                                <span>Formalization failed</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #FFA500;"></div>
                                <span>Formalization passed</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #00ff00;"></div>
                                <span>Fully verified</span>
                            </div>
                        </div>
                    </div>
                    <div id="mynetwork"></div>
                </div>
            </div>
            
            <div class="resizer" id="horizontal-resizer"></div>
            
            <div id="info-panel">
                <div id="info-content">
                    <div class="placeholder">
                        <div class="placeholder-icon">📊</div>
                        <p>Click on a node to view its details</p>
                    </div>
                </div>
            </div>
        </div>
        
        <script type="text/javascript">
            // Store node information
            var nodeInfo = {"tc_1": {"id": "tc_1", "natural_language": "for all real numbers $x$ and $y$", "statement": "Premise:\n\u2022 x and y are real numbers [tc_1].", "dependencies": [], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\nvariable (x y : \u211d)", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The Lean declaration 'variable (x y : \u211d)' perfectly captures the condition that x and y are real numbers. The type \u211d in Lean represents real numbers, which directly corresponds to the natural language statement."]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "type": "condition"}, "l1": {"id": "l1", "natural_language": "Observe first that for any real numbers $a,b$, the identity $(a+\tfrac{b}{2})^2+\tfrac{3b^2}{4}=a^2+ab+b^2$ shows that $a^2+ab+b^2\\geq 0$, since both terms on the left are non-negative.", "statement": "We assume:\n\u2022 a and b are real numbers.\nTherefore, we conclude:\n\u2022 a\u00b2 + ab + b\u00b2 \u2265 0 [l1].", "dependencies": [], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l1 (a b : \u211d) : 0 \u2264 a^2 + a * b + b^2 := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l1 (a b : \u211d) : 0 \u2264 a^2 + a * b + b^2 := by\n  have h1 : a^2 + a * b + b^2 = (a + b / 2)^2 + 3 / 4 * b^2 := by\n    have h1\u2081 : (a + b / 2) ^ 2 + 3 / 4 * b ^ 2 = a ^ 2 + a * b + b ^ 2 := by\n      ring_nf\n      <;>\n      (try norm_num) <;>\n      (try linarith)\n    linarith\n  \n  have h2 : 0 \u2264 (a + b / 2)^2 + 3 / 4 * b^2 := by\n    have h2\u2081 : 0 \u2264 (a + b / 2) ^ 2 := by\n      -- Prove that the square of any real number is non-negative\n      nlinarith [sq_nonneg (a + b / 2)]\n    have h2\u2082 : 0 \u2264 3 / 4 * b ^ 2 := by\n      -- Prove that 3/4 times the square of any real number is non-negative\n      nlinarith [sq_nonneg b]\n    -- Sum of non-negative numbers is non-negative\n    linarith\n  \n  have h3 : 0 \u2264 a^2 + a * b + b^2 := by\n    have h3\u2081 : 0 \u2264 (a + b / 2) ^ 2 + 3 / 4 * b ^ 2 := h2\n    have h3\u2082 : a ^ 2 + a * b + b ^ 2 = (a + b / 2) ^ 2 + 3 / 4 * b ^ 2 := h1\n    linarith\n  \n  exact h3", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The variable declarations correctly capture that a and b are real numbers using the appropriate Lean type \u211d", "The mathematical expression and inequality are perfectly translated, with 0 \u2264 a^2 + a * b + b^2 being equivalent to a\u00b2 + ab + b\u00b2 \u2265 0", "The theorem structure properly reflects the logical flow from assumptions to conclusion as presented in the natural language", "The labeling [l1] in natural language corresponds exactly to the theorem name l1 in Lean"]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "lemma"}, "def_1": {"id": "def_1", "natural_language": "Now set $a=x+\tfrac{2}{3}$ and $b=y+\tfrac{2}{3}$.", "statement": "Definition:\n\u2022 Given that x and y are real numbers [tc_1], we define auxiliary variables a = x + 2/3 and b = y + 2/3 [def_1].", "dependencies": ["tc_1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\nvariable (x y : \u211d)\n\nnoncomputable def a : \u211d := x + 2/3\nnoncomputable def b : \u211d := y + 2/3", "lean_pass": true, "error_msg": [], "tries": 2}, "solved_lemma": {}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The Lean declaration `variable (x y : \u211d)` correctly captures that x and y are real numbers", "The Lean definition `noncomputable def a : \u211d := x + 2/3` correctly defines a as x + 2/3. The `noncomputable` keyword is a technical detail that doesn't affect the mathematical meaning", "The Lean definition `noncomputable def b : \u211d := y + 2/3` correctly defines b as y + 2/3. The `noncomputable` keyword is a technical detail that doesn't affect the mathematical meaning"]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "type": "definition"}, "l2": {"id": "l2", "natural_language": "Substituting into this inequality gives $(x+\tfrac{2}{3})^2+(x+\tfrac{2}{3})(y+\tfrac{2}{3})+(y+\tfrac{2}{3})^2\\geq 0$.", "statement": "We assume:\n\u2022 For any real numbers a and b, a\u00b2 + ab + b\u00b2 \u2265 0 [l1].\n\u2022 We define a = x + 2/3 and b = y + 2/3 [def_1].\nTherefore, we conclude:\n\u2022 (x + 2/3)\u00b2 + (x + 2/3)(y + 2/3) + (y + 2/3)\u00b2 \u2265 0 [l2].", "dependencies": ["l1", "def_1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l2 (x y : \u211d) \n  (l1 : \u2200 a b : \u211d, 0 \u2264 a^2 + a * b + b^2) :\n  0 \u2264 (x + 2/3)^2 + (x + 2/3) * (y + 2/3) + (y + 2/3)^2 := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l2 (x y : \u211d) \n  (l1 : \u2200 a b : \u211d, 0 \u2264 a^2 + a * b + b^2) :\n  0 \u2264 (x + 2/3)^2 + (x + 2/3) * (y + 2/3) + (y + 2/3)^2 := by\n  have h_main : 0 \u2264 (x + 2/3)^2 + (x + 2/3) * (y + 2/3) + (y + 2/3)^2 := by\n    have h\u2082 : 0 \u2264 (x + 2 / 3) ^ 2 + (x + 2 / 3) * (y + 2 / 3) + (y + 2 / 3) ^ 2 := by\n      -- Apply the given inequality l1 with a = x + 2/3 and b = y + 2/3\n      have h\u2083 := l1 (x + 2 / 3) (y + 2 / 3)\n      -- Simplify the expression to match the form in l1\n      ring_nf at h\u2083 \u22a2\n      -- Use linear arithmetic to conclude the proof\n      linarith\n    exact h\u2082\n  \n  exact h_main", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The Lean formalization correctly captures the logical structure and mathematical content of the natural language argument. While the explicit definitions of a and b are not present as separate let-statements in Lean, the substitution is correctly applied in the conclusion. The inequality directions are flipped but semantically equivalent (0 \u2264 x is the same as x \u2265 0). The universal quantification, variable types, and the overall logical flow from assumption to conclusion are all properly represented."]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "lemma"}, "l3": {"id": "l3", "natural_language": "Expanding and simplifying yields $x^2+y^2+xy+2x+2y+\tfrac{4}{3}\\geq 0$.", "statement": "We assume:\n\u2022 (x + 2/3)\u00b2 + (x + 2/3)(y + 2/3) + (y + 2/3)\u00b2 \u2265 0 [l2].\nTherefore, we conclude:\n\u2022 x\u00b2 + y\u00b2 + xy + 2x + 2y + 4/3 \u2265 0 [l3].", "dependencies": ["l2"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l3 (x y : \u211d) \n  (l2 : (x + 2/3)^2 + (x + 2/3) * (y + 2/3) + (y + 2/3)^2 \u2265 0) :\n  x^2 + y^2 + x * y + 2 * x + 2 * y + 4/3 \u2265 0 := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l3 (x y : \u211d) \n  (l2 : (x + 2/3)^2 + (x + 2/3) * (y + 2/3) + (y + 2/3)^2 \u2265 0) :\n  x^2 + y^2 + x * y + 2 * x + 2 * y + 4/3 \u2265 0 := by\n  have h_main : (x + 2/3)^2 + (x + 2/3) * (y + 2/3) + (y + 2/3)^2 = x^2 + y^2 + x * y + 2 * x + 2 * y + 4/3 := by\n    ring_nf at l2 \u22a2\n    <;>\n    (try norm_num at l2 \u22a2) <;>\n    (try linarith) <;>\n    (try nlinarith) <;>\n    (try ring_nf at l2 \u22a2) <;>\n    (try field_simp at l2 \u22a2) <;>\n    (try nlinarith)\n    <;>\n    linarith\n  \n  have h_final : x^2 + y^2 + x * y + 2 * x + 2 * y + 4/3 \u2265 0 := by\n    have h\u2081 : x^2 + y^2 + x * y + 2 * x + 2 * y + 4 / 3 \u2265 0 := by\n      linarith\n    exact h\u2081\n  \n  exact h_final", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The Lean formalization perfectly captures the mathematical content of the natural language statement. The premise (x + 2/3)\u00b2 + (x + 2/3)(y + 2/3) + (y + 2/3)\u00b2 \u2265 0 is correctly represented as hypothesis l2, and the conclusion x\u00b2 + y\u00b2 + xy + 2x + 2y + 4/3 \u2265 0 is correctly stated as the theorem goal. The algebraic expansion confirms that these expressions are mathematically equivalent, making this a valid logical implication. The theorem structure, variable types, and mathematical relationships are all accurately preserved."]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "lemma"}, "l4": {"id": "l4", "natural_language": "and multiplying through by 3 gives $3x^2+3y^2+3xy+6x+6y+4\\geq 0$.", "statement": "We assume:\n\u2022 x\u00b2 + y\u00b2 + xy + 2x + 2y + 4/3 \u2265 0 [l3].\nTherefore, we conclude:\n\u2022 3x\u00b2 + 3y\u00b2 + 3xy + 6x + 6y + 4 \u2265 0 [l4].", "dependencies": ["l3"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l4 (x y : \u211d) (l3 : x^2 + y^2 + x * y + 2 * x + 2 * y + 4/3 \u2265 0) :\n  3 * x^2 + 3 * y^2 + 3 * x * y + 6 * x + 6 * y + 4 \u2265 0 := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l4 (x y : \u211d) (l3 : x^2 + y^2 + x * y + 2 * x + 2 * y + 4/3 \u2265 0) :\n  3 * x^2 + 3 * y^2 + 3 * x * y + 6 * x + 6 * y + 4 \u2265 0 := by\n  have h_main : 3 * (x^2 + y^2 + x * y + 2 * x + 2 * y + 4 / 3) = 3 * x^2 + 3 * y^2 + 3 * x * y + 6 * x + 6 * y + 4 := by\n    ring_nf\n    <;> norm_num\n    <;> linarith\n  \n  have h_final : 3 * x^2 + 3 * y^2 + 3 * x * y + 6 * x + 6 * y + 4 \u2265 0 := by\n    have h1 : 3 * (x^2 + y^2 + x * y + 2 * x + 2 * y + 4 / 3) \u2265 0 := by\n      -- Multiply both sides of the given inequality by 3 (positive, so direction preserved)\n      have h2 : x^2 + y^2 + x * y + 2 * x + 2 * y + 4 / 3 \u2265 0 := l3\n      nlinarith\n    -- Use the fact that 3 * (expression) = target expression to conclude\n    linarith\n  \n  exact h_final", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The assumption l3 is correctly formalized with the exact same mathematical expression and inequality relation", "The conclusion l4 is correctly formalized with the exact same mathematical expression and inequality relation", "The logical structure properly captures the implication from assumption to conclusion using Lean's theorem format", "Variable types are appropriately declared as real numbers, which is consistent with the mathematical context (extra type information is acceptable)"]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "lemma"}, "l5": {"id": "l5", "natural_language": "On the other hand, expanding the left-hand side of the target inequality gives $3(x+y+1)^2+1=3x^2+3y^2+6xy+6x+6y+4$.", "statement": "We assume:\n\u2022 x and y are real numbers [tc_1].\nTherefore, we conclude:\n\u2022 3(x + y + 1)\u00b2 + 1 = 3x\u00b2 + 3y\u00b2 + 6xy + 6x + 6y + 4 [l5].", "dependencies": ["tc_1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l5 (x y : \u211d) : 3 * (x + y + 1)^2 + 1 = 3 * x^2 + 3 * y^2 + 6 * x * y + 6 * x + 6 * y + 4 := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l5 (x y : \u211d) : 3 * (x + y + 1)^2 + 1 = 3 * x^2 + 3 * y^2 + 6 * x * y + 6 * x + 6 * y + 4 := by\n  have h1 : (x + y + 1)^2 = x^2 + y^2 + 1 + 2 * x * y + 2 * x + 2 * y := by\n    have h\u2081 : (x + y + 1) ^ 2 = (x + y + 1) * (x + y + 1) := by ring\n    rw [h\u2081]\n    ring_nf\n    <;>\n    (try norm_num) <;>\n    (try linarith) <;>\n    (try nlinarith)\n    <;>\n    (try ring_nf at *) <;>\n    (try linarith)\n  \n  have h2 : 3 * (x + y + 1)^2 + 1 = 3 * x^2 + 3 * y^2 + 6 * x * y + 6 * x + 6 * y + 4 := by\n    rw [h1]\n    ring_nf\n    <;>\n    (try norm_num) <;>\n    (try linarith) <;>\n    (try nlinarith)\n    <;>\n    (try ring_nf at *) <;>\n    (try linarith)\n  \n  rw [h2]\n  <;>\n  (try norm_num) <;>\n  (try linarith) <;>\n  (try nlinarith)\n  <;>\n  (try ring_nf at *) <;>\n  (try linarith)", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The Lean formalization correctly captures all components of the natural language statement. The variable declarations (x y : \u211d) properly represent the assumption that x and y are real numbers, and the equation 3 * (x + y + 1)^2 + 1 = 3 * x^2 + 3 * y^2 + 6 * x * y + 6 * x + 6 * y + 4 is an exact translation of the mathematical conclusion. The theorem structure appropriately represents the logical relationship between assumptions and conclusion."]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "lemma"}, "l6": {"id": "l6", "natural_language": "Subtracting $3xy$ from this expression gives exactly $3x^2+3y^2+3xy+6x+6y+4$,", "statement": "We assume:\n\u2022 3(x + y + 1)\u00b2 + 1 = 3x\u00b2 + 3y\u00b2 + 6xy + 6x + 6y + 4 [l5].\nTherefore, we conclude:\n\u2022 (3(x + y + 1)\u00b2 + 1) - 3xy = 3x\u00b2 + 3y\u00b2 + 3xy + 6x + 6y + 4 [l6].", "dependencies": ["l5"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l5 (x y : \u211d) : 3 * (x + y + 1)^2 + 1 = 3 * x^2 + 3 * y^2 + 6 * x * y + 6 * x + 6 * y + 4 := by sorry\n\ntheorem l6 (x y : \u211d) (l5 : 3 * (x + y + 1)^2 + 1 = 3 * x^2 + 3 * y^2 + 6 * x * y + 6 * x + 6 * y + 4) :\n  (3 * (x + y + 1)^2 + 1) - 3 * x * y = 3 * x^2 + 3 * y^2 + 3 * x * y + 6 * x + 6 * y + 4 := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l5 (x y : \u211d) : 3 * (x + y + 1)^2 + 1 = 3 * x^2 + 3 * y^2 + 6 * x * y + 6 * x + 6 * y + 4 := by\n  have h_main : 3 * (x + y + 1)^2 + 1 = 3 * x^2 + 3 * y^2 + 6 * x * y + 6 * x + 6 * y + 4 := by\n    have h1 : (x + y + 1) ^ 2 = x ^ 2 + y ^ 2 + 2 * x * y + 2 * x + 2 * y + 1 := by\n      ring\n    have h2 : 3 * (x + y + 1) ^ 2 + 1 = 3 * (x ^ 2 + y ^ 2 + 2 * x * y + 2 * x + 2 * y + 1) + 1 := by\n      rw [h1]\n      <;> ring\n    have h3 : 3 * (x ^ 2 + y ^ 2 + 2 * x * y + 2 * x + 2 * y + 1) + 1 = 3 * x ^ 2 + 3 * y ^ 2 + 6 * x * y + 6 * x + 6 * y + 4 := by\n      ring\n    linarith\n  exact h_main\n  \ntheorem l6 (x y : \u211d) (l5 : 3 * (x + y + 1)^2 + 1 = 3 * x^2 + 3 * y^2 + 6 * x * y + 6 * x + 6 * y + 4) :\n  (3 * (x + y + 1)^2 + 1) - 3 * x * y = 3 * x^2 + 3 * y^2 + 3 * x * y + 6 * x + 6 * y + 4 := by\n  have h_main : (3 * (x + y + 1)^2 + 1) - 3 * x * y = 3 * x^2 + 3 * y^2 + 3 * x * y + 6 * x + 6 * y + 4 := by\n    have h1 : (3 * (x + y + 1)^2 + 1) - 3 * x * y = (3 * x^2 + 3 * y^2 + 6 * x * y + 6 * x + 6 * y + 4) - 3 * x * y := by\n      rw [l5]\n      <;> ring\n    rw [h1]\n    <;> ring\n    <;> linarith\n  exact h_main", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The assumption l5 is correctly formalized as a theorem with the exact mathematical equation, proper variable typing, and appropriate operator precedence.", "The conclusion l6 is accurately captured with the correct mathematical expression and proper dependency on l5 as a hypothesis.", "The logical structure showing that l6 follows from l5 is properly represented by making l5 a hypothesis in theorem l6, which correctly captures the 'Therefore' relationship in the natural language."]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "lemma"}, "ts_1": {"id": "ts_1", "natural_language": "which we have already shown is non-negative. Therefore, $3(x+y+1)^2+1\\geq 3xy$ holds for all real $x,y$.", "statement": "We assume:\n\u2022 3x\u00b2 + 3y\u00b2 + 3xy + 6x + 6y + 4 \u2265 0 [l4].\n\u2022 (3(x + y + 1)\u00b2 + 1) - 3xy = 3x\u00b2 + 3y\u00b2 + 3xy + 6x + 6y + 4 [l6].\nTherefore, we conclude:\n\u2022 3(x + y + 1)\u00b2 + 1 \u2265 3xy [ts_1].", "dependencies": ["l4", "l6"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem ts_1 (x y : \u211d) \n  (l4 : 3 * x^2 + 3 * y^2 + 3 * x * y + 6 * x + 6 * y + 4 \u2265 0)\n  (l6 : (3 * (x + y + 1)^2 + 1) - 3 * x * y = 3 * x^2 + 3 * y^2 + 3 * x * y + 6 * x + 6 * y + 4) :\n  3 * (x + y + 1)^2 + 1 \u2265 3 * x * y := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem ts_1 (x y : \u211d) \n  (l4 : 3 * x^2 + 3 * y^2 + 3 * x * y + 6 * x + 6 * y + 4 \u2265 0)\n  (l6 : (3 * (x + y + 1)^2 + 1) - 3 * x * y = 3 * x^2 + 3 * y^2 + 3 * x * y + 6 * x + 6 * y + 4) :\n  3 * (x + y + 1)^2 + 1 \u2265 3 * x * y := by\n  have h_main : (3 * (x + y + 1)^2 + 1) - 3 * x * y \u2265 0 := by\n    have h\u2081 : (3 * (x + y + 1)^2 + 1) - 3 * x * y = 3 * x^2 + 3 * y^2 + 3 * x * y + 6 * x + 6 * y + 4 := by\n      rw [l6]\n    rw [h\u2081]\n    -- Use the given inequality l4 to conclude the proof\n    linarith\n  \n  have h_final : 3 * (x + y + 1)^2 + 1 \u2265 3 * x * y := by\n    have h\u2081 : (3 * (x + y + 1)^2 + 1) - 3 * x * y \u2265 0 := h_main\n    -- Rearrange the inequality to get the desired form\n    linarith\n  \n  exact h_final", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["Variable declarations are appropriately formalized with explicit real number types", "Assumption l4 is correctly translated with identical mathematical content using proper Lean syntax", "Assumption l6 accurately captures the equality relationship with all terms properly represented", "The conclusion ts_1 is perfectly formalized with the same mathematical inequality", "The overall logical structure correctly represents the natural language reasoning: two assumptions leading to a conclusion, with all mathematical relationships preserved"]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "solution"}};
            
            // Create nodes and edges
            var nodes = new vis.DataSet([{"id": "tc_1", "label": "tc_1", "color": {"background": "#eba0a0", "border": "#00ff00", "highlight": {"background": "#eba0a0", "border": "#00ff00"}}, "shape": "box", "size": 30, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l1", "label": "l1", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "def_1", "label": "def_1", "color": {"background": "#cfb795", "border": "#00ff00", "highlight": {"background": "#cfb795", "border": "#00ff00"}}, "shape": "box", "size": 30, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l2", "label": "l2", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l3", "label": "l3", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l4", "label": "l4", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l5", "label": "l5", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l6", "label": "l6", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "ts_1", "label": "ts_1", "color": {"background": "#a3c2a8", "border": "#00ff00", "highlight": {"background": "#a3c2a8", "border": "#00ff00"}}, "shape": "star", "size": 40, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}]);
            var edges = new vis.DataSet([{"from": "tc_1", "to": "def_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "l5", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "l2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_1", "to": "l2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l2", "to": "l3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l3", "to": "l4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l4", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l5", "to": "l6", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l6", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}]);
            
            // Create network
            var container = document.getElementById('mynetwork');
            var data = {
                nodes: nodes,
                edges: edges
            };
            
            var options = {
                physics: {
                    enabled: true,
                    solver: 'hierarchicalRepulsion',
                    hierarchicalRepulsion: {
                        centralGravity: 0.0,
                        springLength: 200,
                        springConstant: 0.01,
                        nodeDistance: 150,
                        damping: 0.09
                    }
                },
                edges: {
                    smooth: {
                        type: 'continuous',
                        forceDirection: 'none'
                    },
                    color: {
                        color: '#666666',
                        highlight: '#666666',
                        hover: '#666666'
                    },
                    width: 2
                },
                interaction: {
                    hover: true,
                    tooltipDelay: 100,
                    navigationButtons: true,
                    keyboard: true
                },
                nodes: {
                    font: {
                        size: 14,
                        color: '#000000'
                    },
                    labelHighlightBold: false,
                    chosen: false,
                    shapeProperties: {
                        useBorderWithImage: false
                    },
                    scaling: {
                        label: {
                            enabled: true,
                            min: 8,
                            max: 20,
                            maxVisible: 20,
                            drawThreshold: 5
                        }
                    }
                }
            };
            
            var network = new vis.Network(container, data, options);
            
            // Format field value for display
            function formatFieldValue(value, fieldName) {
                if (value === null || value === undefined) {
                    return 'N/A';
                }
                
                // Handle objects (dictionaries) as sub-boxes
                if (typeof value === 'object' && !Array.isArray(value)) {
                    var html = '';
                    for (var key in value) {
                        if (value.hasOwnProperty(key)) {
                            var subValue = value[key];
                            var subValueStr = '';
                            
                            if (typeof subValue === 'object' &&
                                    !Array.isArray(subValue)) {
                                // Nested object - show as JSON
                                subValueStr = JSON.stringify(subValue, null, 2);
                            } else if (Array.isArray(subValue)) {
                                // Array - show as JSON
                                subValueStr = JSON.stringify(subValue, null, 2);
                            } else {
                                // Primitive value
                                subValueStr = String(subValue);
                            }
                            
                            // Replace escaped newlines and tabs with actual characters
                            subValueStr = subValueStr.replace(/\\n/g, '\n');
                            subValueStr = subValueStr.replace(/\\t/g, '\t');
                            subValueStr = subValueStr.replace(/\t/g, '\t');
                            
                            html += '<div class="sub-dict">';
                            html += '<div class="sub-dict-title">' + key + '</div>';
                            html += '<div class="sub-dict-content">' + subValueStr + '</div>';
                            html += '</div>';
                        }
                    }
                    return html;
                }
                
                // Convert to string for primitive values and arrays
                var strValue = String(value);
                
                // Handle arrays
                if (Array.isArray(value)) {
                    strValue = JSON.stringify(value, null, 2);
                }
                
                // Replace escaped newlines and tabs with actual characters
                strValue = strValue.replace(/\\n/g, '\n');
                strValue = strValue.replace(/\\t/g, '\t');
                strValue = strValue.replace(/\t/g, '\t');
                
                return strValue;
            }
            
            // Handle node click events
            network.on("click", function(params) {
                if (params.nodes.length > 0) {
                    var nodeId = params.nodes[0];
                    var info = nodeInfo[nodeId];
                    
                    if (info) {
                        var html = '<div class="info-header">';
                        html += '<h2>' + nodeId + '</h2>';
                        var nodeType = info.type || 'unknown';
                        var capitalizedType = nodeType.charAt(0).toUpperCase() +
                            nodeType.slice(1);
                        html += '<div class="node-type">Type: ' + capitalizedType +
                            '</div>';
                        html += '</div>';
                        
                        // Add all fields
                        for (var key in info) {
                            if (key === 'type' || key === 'id') continue;
                            
                            var fieldName = key.replace(/_/g, ' ')
                                .replace(/\b\w/g, function(l) {
                                    return l.toUpperCase();
                                });
                            var fieldValue = formatFieldValue(info[key], fieldName);
                            
                            if (fieldValue && fieldValue !== 'N/A') {
                                // Special formatting for code fields
                                var isCode = key.includes('code') ||
                                    key.includes('lean') ||
                                    key.includes('statement');
                                
                                html += '<div class="field-group">';
                                html += '<div class="field-name">' + fieldName +
                                    '</div>';
                                html += '<div class="field-value' +
                                    (isCode ? ' code' : '') + '">' +
                                    fieldValue + '</div>';
                                html += '</div>';
                            }
                        }
                        
                        document.getElementById('info-content')
                            .innerHTML = html;
                    }
                }
            });
            
            // Toggle panel function
            function togglePanel() {
                var panel = document.getElementById('info-panel');
                panel.classList.toggle('hidden');
                
                // Resize network when panel is toggled
                setTimeout(function() {
                    network.fit();
                }, 300);
            }
            
            // Initial network fit
            network.once('stabilized', function() {
                network.fit();
            });
            
            // Resizable panels functionality
            function makeResizable() {
                const verticalResizer = document.getElementById('vertical-resizer');
                const horizontalResizer = document.getElementById('horizontal-resizer');
                const proofPanel = document.getElementById('proof-str-panel');
                const graphContainer = document.getElementById('graph-container');
                const infoPanel = document.getElementById('info-panel');
                const leftPanel = document.getElementById('left-panel');
                
                let isVerticalResizing = false;
                let isHorizontalResizing = false;
                
                // Vertical resizer (between proof panel and graph)
                verticalResizer.addEventListener('mousedown', function(e) {
                    isVerticalResizing = true;
                    document.addEventListener('mousemove', verticalResize);
                    document.addEventListener('mouseup', stopVerticalResize);
                    e.preventDefault();
                });
                
                function verticalResize(e) {
                    if (!isVerticalResizing) return;
                    
                    const containerHeight = leftPanel.offsetHeight;
                    const newHeight = e.clientY - leftPanel.offsetTop;
                    const minHeight = 100;
                    const maxHeight = containerHeight - 100;
                    
                    if (newHeight >= minHeight && newHeight <= maxHeight) {
                        proofPanel.style.height = newHeight + 'px';
                        graphContainer.style.height = (containerHeight - newHeight) + 'px';
                        network.fit();
                    }
                }
                
                function stopVerticalResize() {
                    isVerticalResizing = false;
                    document.removeEventListener('mousemove', verticalResize);
                    document.removeEventListener('mouseup', stopVerticalResize);
                }
                
                // Horizontal resizer (between left and right panels)
                horizontalResizer.addEventListener('mousedown', function(e) {
                    isHorizontalResizing = true;
                    document.addEventListener('mousemove', horizontalResize);
                    document.addEventListener('mouseup', stopHorizontalResize);
                    e.preventDefault();
                });
                
                function horizontalResize(e) {
                    if (!isHorizontalResizing) return;
                    
                    const containerWidth = document.querySelector('.container').offsetWidth;
                    const newWidth = e.clientX - leftPanel.offsetLeft;
                    const minWidth = 300;
                    const maxWidth = containerWidth - 300;
                    
                    if (newWidth >= minWidth && newWidth <= maxWidth) {
                        leftPanel.style.flex = 'none';
                        leftPanel.style.width = newWidth + 'px';
                        infoPanel.style.width = (containerWidth - newWidth) + 'px';
                        network.fit();
                    }
                }
                
                function stopHorizontalResize() {
                    isHorizontalResizing = false;
                    document.removeEventListener('mousemove', horizontalResize);
                    document.removeEventListener('mouseup', stopHorizontalResize);
                }
            }
            
            // Initialize resizable panels
            makeResizable();
        </script>
    </body>
    </html>
    