
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Proof Graph Visualization</title>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
        <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.css" rel="stylesheet" type="text/css" />
        <style>
            body {
                margin: 0;
                padding: 0;
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
                height: 100vh;
                overflow: hidden;
            }
            
            .container {
                display: flex;
                height: 100vh;
                background: #f0f0f0;
            }
            
            #left-panel {
                flex: 1;
                display: flex;
                flex-direction: column;
                background: white;
                border-right: 2px solid #ddd;
                height: 100vh;
                overflow: hidden;
            }
            
            #proof-str-panel {
                background: #f8f9fa;
                border-bottom: 2px solid #ddd;
                padding: 15px;
                height: 200px;
                overflow-y: auto;
                flex-shrink: 0;
            }
            
            #proof-str-title {
                font-weight: 600;
                color: #2d3748;
                margin-bottom: 10px;
                font-size: 14px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
            
            #proof-str-content {
                color: #4a5568;
                line-height: 1.6;
                white-space: pre-wrap;
                word-wrap: break-word;
                font-family: 'Monaco', 'Courier New', monospace;
                font-size: 13px;
                background: white;
                padding: 12px;
                border-radius: 4px;
                border: 1px solid #e2e8f0;
            }
            
            #graph-container {
                flex: 1;
                position: relative;
                background: white;
                min-height: 0;
                overflow: hidden;
            }
            
            #mynetwork {
                width: 100%;
                height: 100%;
            }
            
            #info-panel {
                width: 40%;
                max-width: 600px;
                background: white;
                overflow-y: auto;
                padding: 20px;
                box-shadow: -2px 0 10px rgba(0,0,0,0.1);
            }
            
            #info-panel.hidden {
                display: none;
            }
            
            .info-header {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                padding: 15px;
                border-radius: 8px;
                margin-bottom: 20px;
            }
            
            .info-header h2 {
                margin: 0;
                font-size: 24px;
            }
            
            .info-header .node-type {
                opacity: 0.9;
                font-size: 14px;
                margin-top: 5px;
            }
            
            .field-group {
                background: #f8f9fa;
                border-left: 4px solid #667eea;
                padding: 15px;
                margin-bottom: 15px;
                border-radius: 4px;
            }
            
            .field-name {
                font-weight: 600;
                color: #2d3748;
                margin-bottom: 8px;
                font-size: 14px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
            
            .field-value {
                color: #4a5568;
                line-height: 1.6;
                white-space: pre-wrap;
                word-wrap: break-word;
                font-family: 'Monaco', 'Courier New', monospace;
                font-size: 13px;
            }
            
            .field-value.code {
                color: #4a5568;
                padding: 12px;
                border-radius: 4px;
                overflow-x: auto;
            }
            
            .sub-dict {
                background: #ffffff;
                border: 1px solid #e2e8f0;
                border-radius: 4px;
                padding: 10px;
                margin: 8px 0;
                box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            }
            
            .sub-dict-title {
                font-weight: 600;
                color: #4a5568;
                margin-bottom: 8px;
                font-size: 12px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                border-bottom: 1px solid #e2e8f0;
                padding-bottom: 4px;
            }
            
            .sub-dict-content {
                color: #2d3748;
                line-height: 1.5;
                font-size: 12px;
            }
            
            .placeholder {
                text-align: center;
                color: #718096;
                padding: 40px;
                font-size: 18px;
            }
            
            .placeholder-icon {
                font-size: 48px;
                margin-bottom: 20px;
                opacity: 0.3;
            }
            
            #toggle-panel {
                position: absolute;
                right: 10px;
                top: 10px;
                z-index: 1000;
                background: #667eea;
                color: white;
                border: none;
                padding: 10px 20px;
                border-radius: 5px;
                cursor: pointer;
                font-size: 14px;
                transition: background 0.3s;
            }
            
            #toggle-panel:hover {
                background: #764ba2;
            }
            
            .legend {
                position: absolute;
                top: 20px;
                left: 20px;
                background: white;
                padding: 15px;
                border-radius: 8px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
                z-index: 100;
                max-width: 300px;
            }
            
            .legend-section {
                margin-bottom: 15px;
            }
            
            .legend-section:last-child {
                margin-bottom: 0;
            }
            
            .legend-title {
                font-weight: 600;
                font-size: 12px;
                color: #2d3748;
                margin-bottom: 8px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                border-bottom: 1px solid #e2e8f0;
                padding-bottom: 4px;
            }
            
            .legend-item {
                display: flex;
                align-items: center;
                margin-bottom: 8px;
            }
            
            .legend-item:last-child {
                margin-bottom: 0;
            }
            
            .legend-color {
                width: 20px;
                height: 20px;
                margin-right: 10px;
                border-radius: 3px;
            }
            
            .resizer {
                background: #ddd;
                cursor: col-resize;
                width: 4px;
                height: 100%;
                position: absolute;
                right: 0;
                top: 0;
                z-index: 1000;
            }
            
            .resizer:hover {
                background: #bbb;
            }
            
            .resizer-vertical {
                background: #ddd;
                cursor: row-resize;
                height: 4px;
                width: 100%;
                position: absolute;
                bottom: 0;
                left: 0;
                z-index: 1000;
            }
            
            .resizer-vertical:hover {
                background: #bbb;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div id="left-panel">
                <div id="proof-str-panel">
                    <div id="proof-str-title">Informal theorem and proof</div>
                    <div id="proof-str-content">Theorem: If $f(x) = x^3 - 3x + 1$ on $[-2, 2]$, then $f$ has at least one local maximum and one local minimum.

Proof: First, we compute $f'(x) = 3x^2 - 3$. Setting $f'(x) = 0$ gives $3x^2 - 3 = 0$, so $x^2 = 1$, which means $x = 1$ or $x = -1$. Both critical points lie in $[-2, 2]$. We compute $f''(x) = 6x$. At $x = -1$, we have $f''(-1) = -6 < 0$, so $x = -1$ is a local maximum. At $x = 1$, we have $f''(1) = 6 > 0$, so $x = 1$ is a local minimum.
</div>
                    <div class="resizer-vertical" id="vertical-resizer"></div>
                </div>
                <div id="graph-container">
                    <button id="toggle-panel" onclick="togglePanel()">Toggle Info Panel</button>
                    <div class="legend">
                        <div class="legend-section">
                            <div class="legend-title">Node Types</div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #eba0a0;"></div>
                                <span>Theorem Conditions (tc)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #cfb795 ;"></div>
                                <span>Theorem Definitions (def)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #8dafcc;"></div>
                                <span>Lemmas (l)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #a3c2a8;"></div>
                                <span>Theorem Solutions (ts)</span>
                            </div>

                        </div>
                        <div class="legend-section">
                            <div class="legend-title">Verification Status</div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #fa2c07;"></div>
                                <span>Formalization failed</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #FFA500;"></div>
                                <span>Formalization passed</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #00ff00;"></div>
                                <span>Fully verified</span>
                            </div>
                        </div>
                    </div>
                    <div id="mynetwork"></div>
                </div>
            </div>
            
            <div class="resizer" id="horizontal-resizer"></div>
            
            <div id="info-panel">
                <div id="info-content">
                    <div class="placeholder">
                        <div class="placeholder-icon">📊</div>
                        <p>Click on a node to view its details</p>
                    </div>
                </div>
            </div>
        </div>
        
        <script type="text/javascript">
            // Store node information
            var nodeInfo = {"tc_1": {"id": "tc_1", "natural_language": "If $f(x) = x^3 - 3x + 1$ on $[-2, 2]$", "statement": "Premise:\n\u2022 f is a function from \u211d to \u211d defined by f(x) = x\u00b3 - 3x + 1 on the interval [-2, 2] [tc_1].", "dependencies": [], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\nvariable (f : \u211d \u2192 \u211d)\n(tc_1 : \u2200 x \u2208 Set.Icc (-2 : \u211d) 2, f x = x^3 - 3*x + 1)", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The Lean declaration `variable (f : \u211d \u2192 \u211d)` exactly matches the natural language statement that f is a function from \u211d to \u211d", "The Lean condition `f x = x^3 - 3*x + 1` within the universal quantification exactly matches the natural language formula f(x) = x\u00b3 - 3x + 1", "The Lean formalization uses `Set.Icc (-2 : \u211d) 2` which represents the closed interval [-2, 2], perfectly matching the natural language specification of the interval [-2, 2]. The universal quantification `\u2200 x \u2208` correctly restricts the domain of interest to this interval"]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "type": "condition"}, "l1": {"id": "l1", "natural_language": "First, we compute $f'(x) = 3x^2 - 3$.", "statement": "We assume:\n\u2022 f is a function from \u211d to \u211d defined by f(x) = x\u00b3 - 3x + 1 [tc_1]\nTherefore, we conclude:\n\u2022 The derivative of f is f'(x) = 3x\u00b2 - 3 [l1].", "dependencies": ["tc_1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l1\n  (f : \u211d \u2192 \u211d)\n  (hf : \u2200 x, f x = x^3 - 3*x + 1) :\n  \u2200 x, deriv f x = 3*x^2 - 3 := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l1\n  (f : \u211d \u2192 \u211d)\n  (hf : \u2200 x, f x = x^3 - 3*x + 1) :\n  \u2200 x, deriv f x = 3*x^2 - 3 := by\n  intro x\n  have h_deriv : deriv f x = 3*x^2 - 3 := by\n    have h\u2081 : HasDerivAt f (3 * x ^ 2 - 3) x := by\n      -- Differentiate each term separately and combine the results\n      have h\u2082 : HasDerivAt (fun x : \u211d => x ^ 3 - 3 * x + 1) (3 * x ^ 2 - 3) x := by\n        -- Derivative of x^3 is 3x^2\n        have h\u2083 : HasDerivAt (fun x : \u211d => x ^ 3) (3 * x ^ 2) x := by\n          simpa using (hasDerivAt_pow 3 x)\n        -- Derivative of -3x is -3\n        have h\u2084 : HasDerivAt (fun x : \u211d => (3 : \u211d) * x) 3 x := by\n          simpa using (hasDerivAt_id x).const_mul (3 : \u211d)\n        have h\u2085 : HasDerivAt (fun x : \u211d => (-3 : \u211d) * x) (-3 : \u211d) x := by\n          -- Directly compute the derivative of (-3) * x\n          have h\u2086 : HasDerivAt (fun x : \u211d => x) 1 x := by\n            simpa using hasDerivAt_id x\n          have h\u2087 : HasDerivAt (fun x : \u211d => (-3 : \u211d) * x) (-3 : \u211d) x := by\n            convert HasDerivAt.const_mul (-3 : \u211d) h\u2086 using 1 <;> ring\n          exact h\u2087\n        -- Derivative of the constant term 1 is 0\n        have h\u2088 : HasDerivAt (fun x : \u211d => (1 : \u211d)) 0 x := by\n          simpa using hasDerivAt_const x (1 : \u211d)\n        -- Combine the derivatives using addition and subtraction rules\n        have h\u2089 : HasDerivAt (fun x : \u211d => x ^ 3 - 3 * x) (3 * x ^ 2 - 3) x := by\n          have h\u2081\u2080 : HasDerivAt (fun x : \u211d => x ^ 3) (3 * x ^ 2) x := by\n            simpa using (hasDerivAt_pow 3 x)\n          have h\u2081\u2081 : HasDerivAt (fun x : \u211d => (3 : \u211d) * x) 3 x := by\n            simpa using (hasDerivAt_id x).const_mul (3 : \u211d)\n          have h\u2081\u2082 : HasDerivAt (fun x : \u211d => x ^ 3 - 3 * x) (3 * x ^ 2 - 3) x := by\n            convert h\u2081\u2080.sub h\u2081\u2081 using 1 <;> ring\n          exact h\u2081\u2082\n        have h\u2081\u2083 : HasDerivAt (fun x : \u211d => x ^ 3 - 3 * x + 1) (3 * x ^ 2 - 3 + 0) x := by\n          have h\u2081\u2084 : HasDerivAt (fun x : \u211d => x ^ 3 - 3 * x) (3 * x ^ 2 - 3) x := h\u2089\n          have h\u2081\u2085 : HasDerivAt (fun x : \u211d => (1 : \u211d)) 0 x := h\u2088\n          have h\u2081\u2086 : HasDerivAt (fun x : \u211d => x ^ 3 - 3 * x + 1) (3 * x ^ 2 - 3 + 0) x := by\n            convert h\u2081\u2084.add h\u2081\u2085 using 1 <;> ring\n          exact h\u2081\u2086\n        convert h\u2081\u2083 using 1 <;> ring\n      -- Since f(x) = x^3 - 3x + 1, we have the same derivative\n      have h\u2083 : HasDerivAt f (3 * x ^ 2 - 3) x := by\n        have h\u2084 : f = (fun x : \u211d => x ^ 3 - 3 * x + 1) := by\n          funext x\n          rw [hf]\n          <;> ring\n        rw [h\u2084]\n        exact h\u2082\n      exact h\u2083\n    -- Use the fact that the derivative exists to get the result\n    have h\u2082 : deriv f x = 3 * x ^ 2 - 3 := by\n      apply HasDerivAt.deriv\n      exact h\u2081\n    exact h\u2082\n  exact h_deriv", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 3}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The Lean formalization correctly and completely captures the mathematical content and logical structure of the natural language. The function definition f(x) = x\u00b3 - 3x + 1 is properly encoded as a hypothesis, and the derivative conclusion f'(x) = 3x\u00b2 - 3 is accurately represented using Lean's deriv function. The theorem structure appropriately shows that given the function definition, we can conclude the derivative formula. All mathematical expressions match exactly between the natural language and Lean code."]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "lemma"}, "l2": {"id": "l2", "natural_language": "Setting $f'(x) = 0$ gives $3x^2 - 3 = 0$, so $x^2 = 1$, which means $x = 1$ or $x = -1$.", "statement": "We assume:\n\u2022 The derivative of f is f'(x) = 3x\u00b2 - 3 [l1]\nTherefore, we conclude:\n\u2022 The solutions to the equation f'(x) = 0 are x = 1 and x = -1 [l2].", "dependencies": ["l1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l2\n  (f : \u211d \u2192 \u211d)\n  (hf : \u2200 x, f x = x^3 - 3*x + 1)\n  (h_deriv : \u2200 x, deriv f x = 3*x^2 - 3) :\n  \u2200 x, deriv f x = 0 \u2194 (x = 1 \u2228 x = -1) := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l2\n  (f : \u211d \u2192 \u211d)\n  (hf : \u2200 x, f x = x^3 - 3*x + 1)\n  (h_deriv : \u2200 x, deriv f x = 3*x^2 - 3) :\n  \u2200 x, deriv f x = 0 \u2194 (x = 1 \u2228 x = -1) := by\n  intro x\n  have h_main : deriv f x = 0 \u2194 (x = 1 \u2228 x = -1) := by\n    have h\u2081 : deriv f x = 3 * x ^ 2 - 3 := h_deriv x\n    rw [h\u2081]\n    constructor\n    \u00b7 -- Prove the forward direction: if 3 * x ^ 2 - 3 = 0, then x = 1 or x = -1\n      intro h\n      have h\u2082 : 3 * x ^ 2 - 3 = 0 := by linarith\n      have h\u2083 : x ^ 2 = 1 := by\n        nlinarith\n      have h\u2084 : x = 1 \u2228 x = -1 := by\n        have h\u2085 : x = 1 \u2228 x = -1 := by\n          have h\u2086 : (x - 1) * (x + 1) = 0 := by\n            nlinarith\n          have h\u2087 : x - 1 = 0 \u2228 x + 1 = 0 := by\n            apply eq_zero_or_eq_zero_of_mul_eq_zero h\u2086\n          cases h\u2087 with\n          | inl h\u2087 =>\n            have h\u2088 : x - 1 = 0 := h\u2087\n            have h\u2089 : x = 1 := by linarith\n            exact Or.inl h\u2089\n          | inr h\u2087 =>\n            have h\u2088 : x + 1 = 0 := h\u2087\n            have h\u2089 : x = -1 := by linarith\n            exact Or.inr h\u2089\n        exact h\u2085\n      exact h\u2084\n    \u00b7 -- Prove the backward direction: if x = 1 or x = -1, then 3 * x ^ 2 - 3 = 0\n      intro h\n      cases h with\n      | inl h =>\n        have h\u2082 : x = 1 := h\n        rw [h\u2082]\n        norm_num\n      | inr h =>\n        have h\u2082 : x = -1 := h\n        rw [h\u2082]\n        norm_num\n  exact h_main", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The Lean formalization correctly captures the premise that f'(x) = 3x\u00b2 - 3 using the hypothesis h_deriv. The universal quantification properly represents that this holds for all x.", "The conclusion is accurately formalized using a biconditional statement that deriv f x = 0 if and only if x = 1 or x = -1. This precisely captures the natural language statement about the solutions. The additional hypothesis hf providing the original function is extra information not mentioned in the natural language, but it's mathematically consistent and doesn't contradict anything stated."]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "lemma"}, "l3": {"id": "l3", "natural_language": "Both critical points lie in $[-2, 2]$.", "statement": "We assume:\n\u2022 The interval of interest is [-2, 2] [tc_1]\n\u2022 The critical points are x = 1 and x = -1 [l2]\nTherefore, we conclude:\n\u2022 1 \u2208 [-2, 2] and -1 \u2208 [-2, 2] [l3].", "dependencies": ["tc_1", "l2"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l3\n  (tc_1 : Set.Icc (-2 : \u211d) 2)\n  (l2 : {x : \u211d | x = 1 \u2228 x = -1}) :\n  (1 : \u211d) \u2208 Set.Icc (-2 : \u211d) 2 \u2227 (-1 : \u211d) \u2208 Set.Icc (-2 : \u211d) 2 := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l3\n  (tc_1 : Set.Icc (-2 : \u211d) 2)\n  (l2 : {x : \u211d | x = 1 \u2228 x = -1}) :\n  (1 : \u211d) \u2208 Set.Icc (-2 : \u211d) 2 \u2227 (-1 : \u211d) \u2208 Set.Icc (-2 : \u211d) 2 := by\n  have h1 : (1 : \u211d) \u2208 Set.Icc (-2 : \u211d) 2 := by\n    constructor <;> norm_num\n    <;>\n    (try norm_num) <;>\n    (try linarith) <;>\n    (try ring_nf) <;>\n    (try nlinarith)\n  \n  have h2 : (-1 : \u211d) \u2208 Set.Icc (-2 : \u211d) 2 := by\n    constructor <;> norm_num\n    <;>\n    (try norm_num) <;>\n    (try linarith) <;>\n    (try ring_nf) <;>\n    (try nlinarith)\n  \n  have h3 : (1 : \u211d) \u2208 Set.Icc (-2 : \u211d) 2 \u2227 (-1 : \u211d) \u2208 Set.Icc (-2 : \u211d) 2 := by\n    exact \u27e8h1, h2\u27e9\n  \n  exact h3", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 0.0, "semantic_feedback": ["The premise tc_1 is declared as an element of the interval Set.Icc (-2 : \u211d) 2 rather than representing the interval itself as stated in natural language", "The premise l2 is declared as an element of the critical points set rather than representing the set of critical points as stated in natural language", "The conclusion correctly expresses the membership statements but doesn't logically follow from the incorrectly formalized premises tc_1 and l2"]}, "error_report": {"error_type": "Formalizer", "error_report": "Formalization is likely incorrect: semantic score is 0.0, below threshold 0.6.\nScorer feedback: ['The premise tc_1 is declared as an element of the interval Set.Icc (-2 : \u211d) 2 rather than representing the interval itself as stated in natural language', 'The premise l2 is declared as an element of the critical points set rather than representing the set of critical points as stated in natural language', \"The conclusion correctly expresses the membership statements but doesn't logically follow from the incorrectly formalized premises tc_1 and l2\"]"}, "solved_negation": null, "type": "lemma"}, "l4": {"id": "l4", "natural_language": "We compute $f''(x) = 6x$.", "statement": "We assume:\n\u2022 The derivative of f is f'(x) = 3x\u00b2 - 3 [l1]\nTherefore, we conclude:\n\u2022 The second derivative of f is f''(x) = 6x [l4].", "dependencies": ["l1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l4\n  (f : \u211d \u2192 \u211d)\n  (hf : \u2200 x, f x = x^3 - 3*x + 1)\n  (l1 : \u2200 x, deriv f x = 3*x^2 - 3) :\n  \u2200 x, deriv (deriv f) x = 6*x := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l4\n  (f : \u211d \u2192 \u211d)\n  (hf : \u2200 x, f x = x^3 - 3*x + 1)\n  (l1 : \u2200 x, deriv f x = 3*x^2 - 3) :\n  \u2200 x, deriv (deriv f) x = 6*x := by\n  have h_main : \u2200 (x : \u211d), deriv (deriv f) x = 6*x := by\n    intro x\n    have h\u2082 : HasDerivAt (fun y : \u211d => 3 * y ^ 2 - 3) (6 * x) x := by\n      -- Prove that the polynomial function has the derivative 6x at x\n      have h\u2083 : HasDerivAt (fun y : \u211d => (3 : \u211d) * y ^ 2 - 3) (6 * x) x := by\n        -- Use the chain rule and basic derivatives to compute the derivative\n        have h\u2084 : HasDerivAt (fun y : \u211d => (3 : \u211d) * y ^ 2) (3 * (2 * x)) x := by\n          -- Derivative of 3 * y ^ 2 is 6 * x\n          have h\u2085 : HasDerivAt (fun y : \u211d => (y : \u211d) ^ 2) (2 * x) x := by\n            simpa using (hasDerivAt_pow 2 x)\n          have h\u2086 : HasDerivAt (fun y : \u211d => (3 : \u211d) * y ^ 2) (3 * (2 * x)) x := by\n            convert HasDerivAt.const_mul (3 : \u211d) h\u2085 using 1 <;> ring\n          exact h\u2086\n        have h\u2087 : HasDerivAt (fun y : \u211d => (3 : \u211d) * y ^ 2 - 3) (3 * (2 * x) - 0) x := by\n          -- Subtract the derivative of the constant 3, which is 0\n          have h\u2088 : HasDerivAt (fun y : \u211d => (3 : \u211d)) 0 x := by\n            simpa using hasDerivAt_const x (3 : \u211d)\n          convert h\u2084.sub h\u2088 using 1 <;> ring\n        convert h\u2087 using 1 <;> ring\n      exact h\u2083\n    -- Use the fact that deriv f is equal to the polynomial function to get the derivative of deriv f\n    have h\u2083 : deriv f =\u1da0[\ud835\udcdd x] (fun y : \u211d => 3 * y ^ 2 - 3) := by\n      filter_upwards [isOpen_univ.mem_nhds (by trivial : x \u2208 (Set.univ : Set \u211d))] with y _\n      rw [l1 y]\n      <;> simp\n    -- Use the fact that the polynomial function has derivative 6x to conclude that deriv f also has derivative 6x\n    have h\u2084 : HasDerivAt (deriv f) (6 * x) x := by\n      have h\u2085 : HasDerivAt (deriv f) (6 * x) x := by\n        apply HasDerivAt.congr_of_eventuallyEq h\u2082 h\u2083\n      exact h\u2085\n    -- Since deriv f has derivative 6x at x, we can conclude that the second derivative is 6x\n    have h\u2085 : deriv (deriv f) x = 6 * x := by\n      apply HasDerivAt.deriv\n      exact h\u2084\n    exact h\u2085\n  exact h_main", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The premise about f'(x) = 3x\u00b2 - 3 is correctly captured as l1 in the Lean formalization using the deriv function.", "The conclusion about f''(x) = 6x is properly represented using deriv (deriv f) x = 6*x, which correctly expresses the second derivative.", "The Lean formalization includes an additional hypothesis about the explicit form of f(x) = x\u00b3 - 3x + 1, which is not mentioned in the natural language but is mathematically consistent and doesn't contradict the given information. This falls under acceptable extra conditions."]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "lemma"}, "l5": {"id": "l5", "natural_language": "At $x = -1$, we have $f''(-1) = -6 < 0$,", "statement": "We assume:\n\u2022 The second derivative of f is f''(x) = 6x [l4]\nTherefore, we conclude:\n\u2022 f''(-1) = -6, and thus f''(-1) < 0 [l5].", "dependencies": ["l4"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l5\n  (f : \u211d \u2192 \u211d)\n  (hf : \u2200 x, f x = x^3 - 3*x + 1)\n  (l4 : \u2200 x, deriv (deriv f) x = 6*x) :\n  deriv (deriv f) (-1) = -6 \u2227 deriv (deriv f) (-1) < 0 := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l5\n  (f : \u211d \u2192 \u211d)\n  (hf : \u2200 x, f x = x^3 - 3*x + 1)\n  (l4 : \u2200 x, deriv (deriv f) x = 6*x) :\n  deriv (deriv f) (-1) = -6 \u2227 deriv (deriv f) (-1) < 0 := by\n  have h\u2081 : deriv (deriv f) (-1) = -6 := by\n    have h\u2081\u2081 : deriv (deriv f) (-1) = 6 * (-1 : \u211d) := by\n      apply l4\n    rw [h\u2081\u2081]\n    <;> norm_num\n  \n  have h\u2082 : deriv (deriv f) (-1) < 0 := by\n    rw [h\u2081]\n    <;> norm_num\n  \n  have h_main : deriv (deriv f) (-1) = -6 \u2227 deriv (deriv f) (-1) < 0 := by\n    refine' \u27e8h\u2081, h\u2082\u27e9\n  \n  exact h_main", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The assumption about the second derivative f''(x) = 6x is correctly formalized as 'deriv (deriv f) x = 6*x'", "The conclusion about f''(-1) = -6 and f''(-1) < 0 is accurately captured in the conjunction statement", "The additional hypothesis about f(x) = x\u00b3 - 3x + 1 is mathematically consistent with the given second derivative and doesn't contradict the natural language statement"]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "lemma"}, "l6": {"id": "l6", "natural_language": "so $x = -1$ is a local maximum.", "statement": "We assume:\n\u2022 x = -1 is a critical point where f'(-1) = 0 [l2]\n\u2022 x = -1 lies in the interval [-2, 2] [l3]\n\u2022 f''(-1) < 0 [l5]\nTherefore, we conclude:\n\u2022 f has a local maximum at x = -1 [l6].", "dependencies": ["l2", "l3", "l5"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l6\n  (f : \u211d \u2192 \u211d)\n  (hf : \u2200 x, f x = x^3 - 3*x + 1)\n  (l2 : deriv f (-1) = 0)\n  (l3 : (-1 : \u211d) \u2208 Set.Icc (-2 : \u211d) 2)\n  (l5 : deriv (deriv f) (-1) < 0) :\n  IsLocalMax f (-1) := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l6\n  (f : \u211d \u2192 \u211d)\n  (hf : \u2200 x, f x = x^3 - 3*x + 1)\n  (l2 : deriv f (-1) = 0)\n  (l3 : (-1 : \u211d) \u2208 Set.Icc (-2 : \u211d) 2)\n  (l5 : deriv (deriv f) (-1) < 0) :\n  IsLocalMax f (-1) := by\n  have h_factor : \u2200 (x : \u211d), x^3 - 3*x - 2 = (x + 1)^2 * (x - 2) := by\n    intro x\n    ring_nf\n    <;>\n    (try norm_num) <;>\n    (try linarith) <;>\n    (try nlinarith) <;>\n    (try ring_nf) <;>\n    (try nlinarith [sq_nonneg (x + 1), sq_nonneg (x - 1)])\n    <;>\n    nlinarith [sq_nonneg (x + 1), sq_nonneg (x - 1)]\n  \n  have h_ineq : \u2200 (x : \u211d), x \u2208 Set.Ioo (-2 : \u211d) 0 \u2192 x^3 - 3*x + 1 \u2264 3 := by\n    intro x hx\n    have h\u2081 : x^3 - 3*x - 2 = (x + 1)^2 * (x - 2) := h_factor x\n    have h\u2082 : (x + 1)^2 * (x - 2) \u2264 0 := by\n      have h\u2083 : (x + 1)^2 \u2265 0 := by nlinarith\n      have h\u2084 : x - 2 < 0 := by\n        have h\u2085 : x < 0 := hx.2\n        linarith\n      nlinarith\n    have h\u2083 : x^3 - 3*x - 2 \u2264 0 := by linarith\n    have h\u2084 : x^3 - 3*x + 1 \u2264 3 := by linarith\n    exact h\u2084\n  \n  have h_main : IsLocalMax f (-1) := by\n    rw [IsLocalMax]\n    -- Use the neighborhood (-2, 0) to show that f(x) \u2264 f(-1) for all x in this neighborhood.\n    filter_upwards [isOpen_Ioo.mem_nhds (by norm_num : (-1 : \u211d) \u2208 Set.Ioo (-2 : \u211d) 0)] with x hx\n    have h\u2081 : x \u2208 Set.Ioo (-2 : \u211d) 0 := hx\n    have h\u2082 : x^3 - 3*x + 1 \u2264 3 := h_ineq x h\u2081\n    have h\u2083 : f x = x^3 - 3*x + 1 := by rw [hf]\n    have h\u2084 : f (-1) = 3 := by\n      have h\u2085 : f (-1) = (-1 : \u211d)^3 - 3*(-1 : \u211d) + 1 := by rw [hf]\n      rw [h\u2085]\n      norm_num\n    have h\u2085 : f x \u2264 f (-1) := by\n      linarith\n    exact h\u2085\n  \n  exact h_main", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The Lean formalization correctly captures all components from the natural language: the critical point condition (deriv f (-1) = 0), the domain constraint (-1 \u2208 [-2,2]), the second derivative condition (f''(-1) < 0), and the conclusion about local maximum (IsLocalMax f (-1)). The additional function specification (hf : \u2200 x, f x = x^3 - 3*x + 1) provides extra detail not mentioned in the natural language but is logically consistent and doesn't contradict any stated assumptions. All mathematical concepts are properly formalized using appropriate Lean/Mathlib definitions."]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "lemma"}, "l7": {"id": "l7", "natural_language": "At $x = 1$, we have $f''(1) = 6 > 0$,", "statement": "We assume:\n\u2022 The second derivative of f is f''(x) = 6x [l4]\nTherefore, we conclude:\n\u2022 f''(1) = 6, and thus f''(1) > 0 [l7].", "dependencies": ["l4"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l7\n  (f : \u211d \u2192 \u211d)\n  (l4 : \u2200 x, deriv (deriv f) x = 6 * x) :\n  deriv (deriv f) 1 = 6 \u2227 deriv (deriv f) 1 > 0 := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l7\n  (f : \u211d \u2192 \u211d)\n  (l4 : \u2200 x, deriv (deriv f) x = 6 * x) :\n  deriv (deriv f) 1 = 6 \u2227 deriv (deriv f) 1 > 0 := by\n  have h\u2081 : deriv (deriv f) 1 = 6 := by\n    have h\u2081\u2081 : deriv (deriv f) 1 = 6 * (1 : \u211d) := l4 1\n    norm_num at h\u2081\u2081 \u22a2\n    <;> linarith\n  \n  have h\u2082 : deriv (deriv f) 1 > 0 := by\n    rw [h\u2081]\n    norm_num\n  \n  exact \u27e8h\u2081, h\u2082\u27e9", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The premise is correctly formalized - 'deriv (deriv f) x = 6 * x' accurately represents f''(x) = 6x with appropriate universal quantification", "The conclusion is correctly captured as a conjunction of the two stated results: f''(1) = 6 and f''(1) > 0", "The logical structure properly represents the assumption-conclusion relationship through the theorem format with hypothesis and goal", "The mathematical content is faithfully preserved - the substitution of x = 1 into the second derivative formula and the resulting inequality are both captured"]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "lemma"}, "l8": {"id": "l8", "natural_language": "so $x = 1$ is a local minimum.", "statement": "We assume:\n\u2022 x = 1 is a critical point where f'(1) = 0 [l2]\n\u2022 x = 1 lies in the interval [-2, 2] [l3]\n\u2022 f''(1) > 0 [l7]\nTherefore, we conclude:\n\u2022 f has a local minimum at x = 1 [l8].", "dependencies": ["l2", "l3", "l7"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l8\n  (f : \u211d \u2192 \u211d)\n  (hf : \u2200 x, f x = x^3 - 3*x + 1)\n  (h_l2 : deriv f 1 = 0)\n  (h_l3 : (1 : \u211d) \u2208 Set.Icc (-2 : \u211d) 2)\n  (h_l7 : deriv (deriv f) 1 > 0) :\n  IsLocalMin f 1 := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l8\n  (f : \u211d \u2192 \u211d)\n  (hf : \u2200 x, f x = x^3 - 3*x + 1)\n  (h_l2 : deriv f 1 = 0)\n  (h_l3 : (1 : \u211d) \u2208 Set.Icc (-2 : \u211d) 2)\n  (h_l7 : deriv (deriv f) 1 > 0) :\n  IsLocalMin f 1 := by\n  have h_main : IsLocalMin f 1 := by\n    rw [IsLocalMin]\n    -- Use the definition of local minimum to find a neighborhood where f(x) \u2265 f(1)\n    filter_upwards [isOpen_Ioo.mem_nhds (by norm_num : (1 : \u211d) \u2208 Set.Ioo (0 : \u211d) (2 : \u211d))] with x hx\n    have h\u2081 : f x \u2265 f 1 := by\n      have h\u2082 : f x = x ^ 3 - 3 * x + 1 := by rw [hf]\n      have h\u2083 : f 1 = (1 : \u211d) ^ 3 - 3 * (1 : \u211d) + 1 := by\n        rw [hf]\n        <;> norm_num\n      rw [h\u2082, h\u2083]\n      have h\u2084 : x \u2208 Set.Ioo (0 : \u211d) (2 : \u211d) := hx\n      have h\u2085 : 0 < x := by exact h\u2084.1\n      have h\u2086 : x < 2 := by exact h\u2084.2\n      have h\u2087 : (x - 1) ^ 2 * (x + 2) \u2265 0 := by\n        have h\u2088 : (x - 1) ^ 2 \u2265 0 := by nlinarith\n        have h\u2089 : x + 2 > 0 := by nlinarith\n        nlinarith\n      nlinarith [sq_nonneg (x - 1)]\n    exact h\u2081\n  exact h_main", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The Lean formalization correctly captures all components from the natural language. The critical point condition is properly represented with 'deriv f 1 = 0', the interval constraint is accurately formalized using set membership notation, the second derivative condition is correctly expressed as 'deriv (deriv f) 1 > 0', and the conclusion uses the appropriate 'IsLocalMin' predicate. The additional function specification (hf) provides extra context but doesn't contradict or interfere with the logical structure described in the natural language."]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "lemma"}, "ts_1": {"id": "ts_1", "natural_language": "...$x = -1$ is a local maximum. At $x = 1$, ... $x = 1$ is a local minimum.", "statement": "We assume:\n\u2022 f has a local maximum at x = -1 [l6]\n\u2022 f has a local minimum at x = 1 [l8]\nTherefore, we conclude:\n\u2022 f has at least one local maximum and at least one local minimum on [-2, 2] [ts_1].", "dependencies": ["l6", "l8"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem ts_1\n  (f : \u211d \u2192 \u211d)\n  (hf : \u2200 x, f x = x^3 - 3*x + 1)\n  (l6 : IsLocalMax f (-1))\n  (l8 : IsLocalMin f 1) :\n  (\u2203 x \u2208 Set.Icc (-2 : \u211d) 2, IsLocalMax f x) \u2227 \n  (\u2203 x \u2208 Set.Icc (-2 : \u211d) 2, IsLocalMin f x) := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem ts_1\n  (f : \u211d \u2192 \u211d)\n  (hf : \u2200 x, f x = x^3 - 3*x + 1)\n  (l6 : IsLocalMax f (-1))\n  (l8 : IsLocalMin f 1) :\n  (\u2203 x \u2208 Set.Icc (-2 : \u211d) 2, IsLocalMax f x) \u2227 \n  (\u2203 x \u2208 Set.Icc (-2 : \u211d) 2, IsLocalMin f x) := by\n  have h1 : \u2203 x \u2208 Set.Icc (-2 : \u211d) 2, IsLocalMax f x := by\n    refine' \u27e8-1, \u27e8by norm_num, by norm_num\u27e9, _\u27e9\n    exact l6\n  \n  have h2 : \u2203 x \u2208 Set.Icc (-2 : \u211d) 2, IsLocalMin f x := by\n    refine' \u27e81, \u27e8by norm_num, by norm_num\u27e9, _\u27e9\n    exact l8\n  \n  exact \u27e8h1, h2\u27e9", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The Lean formalization correctly captures all the logical components from the natural language. The assumptions about local maximum at x = -1 and local minimum at x = 1 are properly represented using IsLocalMax and IsLocalMin. The conclusion about the existence of at least one local maximum and minimum on the interval [-2, 2] is accurately formalized using existential quantification over the closed interval Set.Icc (-2 : \u211d) 2. The additional constraint hf specifying the exact function form is an extra detail that doesn't contradict the natural language and is logically consistent with the problem context."]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "solution"}};
            
            // Create nodes and edges
            var nodes = new vis.DataSet([{"id": "tc_1", "label": "tc_1", "color": {"background": "#eba0a0", "border": "#00ff00", "highlight": {"background": "#eba0a0", "border": "#00ff00"}}, "shape": "box", "size": 30, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l1", "label": "l1", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l2", "label": "l2", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l3", "label": "l3", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l4", "label": "l4", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l5", "label": "l5", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l6", "label": "l6", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l7", "label": "l7", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l8", "label": "l8", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "ts_1", "label": "ts_1", "color": {"background": "#a3c2a8", "border": "#00ff00", "highlight": {"background": "#a3c2a8", "border": "#00ff00"}}, "shape": "star", "size": 40, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}]);
            var edges = new vis.DataSet([{"from": "tc_1", "to": "l1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "l3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "l2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "l4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l2", "to": "l3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l2", "to": "l6", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l2", "to": "l8", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l3", "to": "l6", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l3", "to": "l8", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l4", "to": "l5", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l4", "to": "l7", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l5", "to": "l6", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l6", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l7", "to": "l8", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l8", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}]);
            
            // Create network
            var container = document.getElementById('mynetwork');
            var data = {
                nodes: nodes,
                edges: edges
            };
            
            var options = {
                physics: {
                    enabled: true,
                    solver: 'hierarchicalRepulsion',
                    hierarchicalRepulsion: {
                        centralGravity: 0.0,
                        springLength: 200,
                        springConstant: 0.01,
                        nodeDistance: 150,
                        damping: 0.09
                    }
                },
                edges: {
                    smooth: {
                        type: 'continuous',
                        forceDirection: 'none'
                    },
                    color: {
                        color: '#666666',
                        highlight: '#666666',
                        hover: '#666666'
                    },
                    width: 2
                },
                interaction: {
                    hover: true,
                    tooltipDelay: 100,
                    navigationButtons: true,
                    keyboard: true
                },
                nodes: {
                    font: {
                        size: 14,
                        color: '#000000'
                    },
                    labelHighlightBold: false,
                    chosen: false,
                    shapeProperties: {
                        useBorderWithImage: false
                    },
                    scaling: {
                        label: {
                            enabled: true,
                            min: 8,
                            max: 20,
                            maxVisible: 20,
                            drawThreshold: 5
                        }
                    }
                }
            };
            
            var network = new vis.Network(container, data, options);
            
            // Format field value for display
            function formatFieldValue(value, fieldName) {
                if (value === null || value === undefined) {
                    return 'N/A';
                }
                
                // Handle objects (dictionaries) as sub-boxes
                if (typeof value === 'object' && !Array.isArray(value)) {
                    var html = '';
                    for (var key in value) {
                        if (value.hasOwnProperty(key)) {
                            var subValue = value[key];
                            var subValueStr = '';
                            
                            if (typeof subValue === 'object' &&
                                    !Array.isArray(subValue)) {
                                // Nested object - show as JSON
                                subValueStr = JSON.stringify(subValue, null, 2);
                            } else if (Array.isArray(subValue)) {
                                // Array - show as JSON
                                subValueStr = JSON.stringify(subValue, null, 2);
                            } else {
                                // Primitive value
                                subValueStr = String(subValue);
                            }
                            
                            // Replace escaped newlines and tabs with actual characters
                            subValueStr = subValueStr.replace(/\\n/g, '\n');
                            subValueStr = subValueStr.replace(/\\t/g, '\t');
                            subValueStr = subValueStr.replace(/\t/g, '\t');
                            
                            html += '<div class="sub-dict">';
                            html += '<div class="sub-dict-title">' + key + '</div>';
                            html += '<div class="sub-dict-content">' + subValueStr + '</div>';
                            html += '</div>';
                        }
                    }
                    return html;
                }
                
                // Convert to string for primitive values and arrays
                var strValue = String(value);
                
                // Handle arrays
                if (Array.isArray(value)) {
                    strValue = JSON.stringify(value, null, 2);
                }
                
                // Replace escaped newlines and tabs with actual characters
                strValue = strValue.replace(/\\n/g, '\n');
                strValue = strValue.replace(/\\t/g, '\t');
                strValue = strValue.replace(/\t/g, '\t');
                
                return strValue;
            }
            
            // Handle node click events
            network.on("click", function(params) {
                if (params.nodes.length > 0) {
                    var nodeId = params.nodes[0];
                    var info = nodeInfo[nodeId];
                    
                    if (info) {
                        var html = '<div class="info-header">';
                        html += '<h2>' + nodeId + '</h2>';
                        var nodeType = info.type || 'unknown';
                        var capitalizedType = nodeType.charAt(0).toUpperCase() +
                            nodeType.slice(1);
                        html += '<div class="node-type">Type: ' + capitalizedType +
                            '</div>';
                        html += '</div>';
                        
                        // Add all fields
                        for (var key in info) {
                            if (key === 'type' || key === 'id') continue;
                            
                            var fieldName = key.replace(/_/g, ' ')
                                .replace(/\b\w/g, function(l) {
                                    return l.toUpperCase();
                                });
                            var fieldValue = formatFieldValue(info[key], fieldName);
                            
                            if (fieldValue && fieldValue !== 'N/A') {
                                // Special formatting for code fields
                                var isCode = key.includes('code') ||
                                    key.includes('lean') ||
                                    key.includes('statement');
                                
                                html += '<div class="field-group">';
                                html += '<div class="field-name">' + fieldName +
                                    '</div>';
                                html += '<div class="field-value' +
                                    (isCode ? ' code' : '') + '">' +
                                    fieldValue + '</div>';
                                html += '</div>';
                            }
                        }
                        
                        document.getElementById('info-content')
                            .innerHTML = html;
                    }
                }
            });
            
            // Toggle panel function
            function togglePanel() {
                var panel = document.getElementById('info-panel');
                panel.classList.toggle('hidden');
                
                // Resize network when panel is toggled
                setTimeout(function() {
                    network.fit();
                }, 300);
            }
            
            // Initial network fit
            network.once('stabilized', function() {
                network.fit();
            });
            
            // Resizable panels functionality
            function makeResizable() {
                const verticalResizer = document.getElementById('vertical-resizer');
                const horizontalResizer = document.getElementById('horizontal-resizer');
                const proofPanel = document.getElementById('proof-str-panel');
                const graphContainer = document.getElementById('graph-container');
                const infoPanel = document.getElementById('info-panel');
                const leftPanel = document.getElementById('left-panel');
                
                let isVerticalResizing = false;
                let isHorizontalResizing = false;
                
                // Vertical resizer (between proof panel and graph)
                verticalResizer.addEventListener('mousedown', function(e) {
                    isVerticalResizing = true;
                    document.addEventListener('mousemove', verticalResize);
                    document.addEventListener('mouseup', stopVerticalResize);
                    e.preventDefault();
                });
                
                function verticalResize(e) {
                    if (!isVerticalResizing) return;
                    
                    const containerHeight = leftPanel.offsetHeight;
                    const newHeight = e.clientY - leftPanel.offsetTop;
                    const minHeight = 100;
                    const maxHeight = containerHeight - 100;
                    
                    if (newHeight >= minHeight && newHeight <= maxHeight) {
                        proofPanel.style.height = newHeight + 'px';
                        graphContainer.style.height = (containerHeight - newHeight) + 'px';
                        network.fit();
                    }
                }
                
                function stopVerticalResize() {
                    isVerticalResizing = false;
                    document.removeEventListener('mousemove', verticalResize);
                    document.removeEventListener('mouseup', stopVerticalResize);
                }
                
                // Horizontal resizer (between left and right panels)
                horizontalResizer.addEventListener('mousedown', function(e) {
                    isHorizontalResizing = true;
                    document.addEventListener('mousemove', horizontalResize);
                    document.addEventListener('mouseup', stopHorizontalResize);
                    e.preventDefault();
                });
                
                function horizontalResize(e) {
                    if (!isHorizontalResizing) return;
                    
                    const containerWidth = document.querySelector('.container').offsetWidth;
                    const newWidth = e.clientX - leftPanel.offsetLeft;
                    const minWidth = 300;
                    const maxWidth = containerWidth - 300;
                    
                    if (newWidth >= minWidth && newWidth <= maxWidth) {
                        leftPanel.style.flex = 'none';
                        leftPanel.style.width = newWidth + 'px';
                        infoPanel.style.width = (containerWidth - newWidth) + 'px';
                        network.fit();
                    }
                }
                
                function stopHorizontalResize() {
                    isHorizontalResizing = false;
                    document.removeEventListener('mousemove', horizontalResize);
                    document.removeEventListener('mouseup', stopHorizontalResize);
                }
            }
            
            // Initialize resizable panels
            makeResizable();
        </script>
    </body>
    </html>
    