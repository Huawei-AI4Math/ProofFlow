
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Proof Graph Visualization</title>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
        <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.css" rel="stylesheet" type="text/css" />
        <style>
            body {
                margin: 0;
                padding: 0;
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
                height: 100vh;
                overflow: hidden;
            }
            
            .container {
                display: flex;
                height: 100vh;
                background: #f0f0f0;
            }
            
            #left-panel {
                flex: 1;
                display: flex;
                flex-direction: column;
                background: white;
                border-right: 2px solid #ddd;
                height: 100vh;
                overflow: hidden;
            }
            
            #proof-str-panel {
                background: #f8f9fa;
                border-bottom: 2px solid #ddd;
                padding: 15px;
                height: 200px;
                overflow-y: auto;
                flex-shrink: 0;
            }
            
            #proof-str-title {
                font-weight: 600;
                color: #2d3748;
                margin-bottom: 10px;
                font-size: 14px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
            
            #proof-str-content {
                color: #4a5568;
                line-height: 1.6;
                white-space: pre-wrap;
                word-wrap: break-word;
                font-family: 'Monaco', 'Courier New', monospace;
                font-size: 13px;
                background: white;
                padding: 12px;
                border-radius: 4px;
                border: 1px solid #e2e8f0;
            }
            
            #graph-container {
                flex: 1;
                position: relative;
                background: white;
                min-height: 0;
                overflow: hidden;
            }
            
            #mynetwork {
                width: 100%;
                height: 100%;
            }
            
            #info-panel {
                width: 40%;
                max-width: 600px;
                background: white;
                overflow-y: auto;
                padding: 20px;
                box-shadow: -2px 0 10px rgba(0,0,0,0.1);
            }
            
            #info-panel.hidden {
                display: none;
            }
            
            .info-header {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                padding: 15px;
                border-radius: 8px;
                margin-bottom: 20px;
            }
            
            .info-header h2 {
                margin: 0;
                font-size: 24px;
            }
            
            .info-header .node-type {
                opacity: 0.9;
                font-size: 14px;
                margin-top: 5px;
            }
            
            .field-group {
                background: #f8f9fa;
                border-left: 4px solid #667eea;
                padding: 15px;
                margin-bottom: 15px;
                border-radius: 4px;
            }
            
            .field-name {
                font-weight: 600;
                color: #2d3748;
                margin-bottom: 8px;
                font-size: 14px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
            
            .field-value {
                color: #4a5568;
                line-height: 1.6;
                white-space: pre-wrap;
                word-wrap: break-word;
                font-family: 'Monaco', 'Courier New', monospace;
                font-size: 13px;
            }
            
            .field-value.code {
                color: #4a5568;
                padding: 12px;
                border-radius: 4px;
                overflow-x: auto;
            }
            
            .sub-dict {
                background: #ffffff;
                border: 1px solid #e2e8f0;
                border-radius: 4px;
                padding: 10px;
                margin: 8px 0;
                box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            }
            
            .sub-dict-title {
                font-weight: 600;
                color: #4a5568;
                margin-bottom: 8px;
                font-size: 12px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                border-bottom: 1px solid #e2e8f0;
                padding-bottom: 4px;
            }
            
            .sub-dict-content {
                color: #2d3748;
                line-height: 1.5;
                font-size: 12px;
            }
            
            .placeholder {
                text-align: center;
                color: #718096;
                padding: 40px;
                font-size: 18px;
            }
            
            .placeholder-icon {
                font-size: 48px;
                margin-bottom: 20px;
                opacity: 0.3;
            }
            
            #toggle-panel {
                position: absolute;
                right: 10px;
                top: 10px;
                z-index: 1000;
                background: #667eea;
                color: white;
                border: none;
                padding: 10px 20px;
                border-radius: 5px;
                cursor: pointer;
                font-size: 14px;
                transition: background 0.3s;
            }
            
            #toggle-panel:hover {
                background: #764ba2;
            }
            
            .legend {
                position: absolute;
                top: 20px;
                left: 20px;
                background: white;
                padding: 15px;
                border-radius: 8px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
                z-index: 100;
                max-width: 300px;
            }
            
            .legend-section {
                margin-bottom: 15px;
            }
            
            .legend-section:last-child {
                margin-bottom: 0;
            }
            
            .legend-title {
                font-weight: 600;
                font-size: 12px;
                color: #2d3748;
                margin-bottom: 8px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                border-bottom: 1px solid #e2e8f0;
                padding-bottom: 4px;
            }
            
            .legend-item {
                display: flex;
                align-items: center;
                margin-bottom: 8px;
            }
            
            .legend-item:last-child {
                margin-bottom: 0;
            }
            
            .legend-color {
                width: 20px;
                height: 20px;
                margin-right: 10px;
                border-radius: 3px;
            }
            
            .resizer {
                background: #ddd;
                cursor: col-resize;
                width: 4px;
                height: 100%;
                position: absolute;
                right: 0;
                top: 0;
                z-index: 1000;
            }
            
            .resizer:hover {
                background: #bbb;
            }
            
            .resizer-vertical {
                background: #ddd;
                cursor: row-resize;
                height: 4px;
                width: 100%;
                position: absolute;
                bottom: 0;
                left: 0;
                z-index: 1000;
            }
            
            .resizer-vertical:hover {
                background: #bbb;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div id="left-panel">
                <div id="proof-str-panel">
                    <div id="proof-str-title">Informal theorem and proof</div>
                    <div id="proof-str-content">Theorem: Let $X$ and $Y$ be random variables. Suppose the conditional expectation of $X$ given $Y$ is $E[X|Y] = Y^2$, the conditional variance of $X$ given $Y$ is $	ext{Var}(X|Y) = 2$, and $Y$ is a random variable following a continuous uniform distribution on the interval $[0, 3]$. Then, the expectation of $X$ is $E[X] = 3$ and the variance of $X$ is $	ext{Var}(X) = 9.2$.

Proof: To find the expectation of $X$, we use the law of total expectation, which states $E[X] = E[E[X|Y]]$. Since $Y$ is uniformly distributed on $[0, 3]$, its probability density function is $f_Y(y) = \frac{1}{3}$ for $y \in [0, 3]$. This allows us to compute the second moment of $Y$: $E[Y^2] = \int_{0}^{3} y^2 (\frac{1}{3}) dy = 3$. Substituting the given condition $E[X|Y] = Y^2$ into the law of total expectation gives $E[X] = E[Y^2]$. Since we found $E[Y^2] = 3$, it follows that $E[X] = 3$.

To find the variance of $X$, we use the law of total variance: $	ext{Var}(X) = E[	ext{Var}(X|Y)] + 	ext{Var}(E[X|Y])$. From the condition $	ext{Var}(X|Y) = 2$, the first term is $E[	ext{Var}(X|Y)] = E[2] = 2$. For the second term, we require the fourth moment of $Y$, which is $E[Y^4] = \int_{0}^{3} y^4 (\frac{1}{3}) dy = 16.2$. Using the variance definition for $E[X|Y] = Y^2$, we get $	ext{Var}(Y^2) = E[Y^4] - (E[Y^2])^2 = 16.2 - 3^2 = 7.2$. Finally, substituting the two components into the law of total variance yields $	ext{Var}(X) = 2 + 7.2 = 9.2$.
</div>
                    <div class="resizer-vertical" id="vertical-resizer"></div>
                </div>
                <div id="graph-container">
                    <button id="toggle-panel" onclick="togglePanel()">Toggle Info Panel</button>
                    <div class="legend">
                        <div class="legend-section">
                            <div class="legend-title">Node Types</div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #eba0a0;"></div>
                                <span>Theorem Conditions (tc)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #cfb795 ;"></div>
                                <span>Theorem Definitions (def)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #8dafcc;"></div>
                                <span>Lemmas (l)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #a3c2a8;"></div>
                                <span>Theorem Solutions (ts)</span>
                            </div>

                        </div>
                        <div class="legend-section">
                            <div class="legend-title">Verification Status</div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #fa2c07;"></div>
                                <span>Formalization failed</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #FFA500;"></div>
                                <span>Formalization passed</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #00ff00;"></div>
                                <span>Fully verified</span>
                            </div>
                        </div>
                    </div>
                    <div id="mynetwork"></div>
                </div>
            </div>
            
            <div class="resizer" id="horizontal-resizer"></div>
            
            <div id="info-panel">
                <div id="info-content">
                    <div class="placeholder">
                        <div class="placeholder-icon">📊</div>
                        <p>Click on a node to view its details</p>
                    </div>
                </div>
            </div>
        </div>
        
        <script type="text/javascript">
            // Store node information
            var nodeInfo = {"tc_1": {"id": "tc_1", "natural_language": "Let $X$ and $Y$ be random variables.", "statement": "Premise:\n\u2022 $X$ and $Y$ are random variables [tc_1].", "dependencies": [], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem tc_1 \n  (X Y : \u211d)\n  (h_cond_exp : \u222b y in Set.Icc 0 3, y^2 * (1/3) = 3)\n  (h_cond_var : \u222b y in Set.Icc 0 3, (y^2)^2 * (1/3) - (\u222b y in Set.Icc 0 3, y^2 * (1/3))^2 = 2)\n  (h_uniform : \u222b y in Set.Icc 0 3, y * (1/3) = 1.5 \u2227 \n    \u222b y in Set.Icc 0 3, y^2 * (1/3) = 3)\n  : \u222b x, X * (1/3) = 3 \u2227 \n    \u222b x, x^2 * (1/3) - (\u222b x, x * (1/3))^2 = 9.2 := by sorry", "lean_pass": false, "error_msg": [{"line": 11, "column": 15, "endLine": 11, "endColumn": 44, "data": "failed to synthesize\n  NormedAddCommGroup Float\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 11, "column": 15, "endLine": 11, "endColumn": 44, "data": "failed to synthesize\n  MeasureTheory.MeasureSpace Float\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 11, "column": 22, "endLine": 11, "endColumn": 33, "data": "failed to synthesize\n  Preorder Float\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 14, "column": 4, "endLine": 14, "endColumn": 41, "data": "failed to synthesize\n  NormedAddCommGroup Float\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 14, "column": 4, "endLine": 14, "endColumn": 41, "data": "failed to synthesize\n  MeasureTheory.MeasureSpace Float\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 14, "column": 24, "endLine": 14, "endColumn": 38, "data": "failed to synthesize\n  NormedAddCommGroup Float\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 14, "column": 24, "endLine": 14, "endColumn": 38, "data": "failed to synthesize\n  MeasureTheory.MeasureSpace Float\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 9, "column": 16, "endLine": 9, "endColumn": 47, "data": "failed to synthesize\n  MeasureTheory.MeasureSpace \u2115\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 9, "column": 16, "endLine": 9, "endColumn": 47, "data": "failed to synthesize\n  NormedAddCommGroup \u2115\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 10, "column": 16, "endLine": 10, "endColumn": 89, "data": "failed to synthesize\n  MeasureTheory.MeasureSpace \u2115\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 10, "column": 16, "endLine": 10, "endColumn": 89, "data": "failed to synthesize\n  NormedAddCommGroup \u2115\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 10, "column": 55, "endLine": 10, "endColumn": 86, "data": "failed to synthesize\n  NormedAddCommGroup \u2115\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 10, "column": 55, "endLine": 10, "endColumn": 86, "data": "failed to synthesize\n  MeasureTheory.MeasureSpace \u2115\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 12, "column": 4, "endLine": 12, "endColumn": 35, "data": "failed to synthesize\n  MeasureTheory.MeasureSpace \u2115\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 12, "column": 4, "endLine": 12, "endColumn": 35, "data": "failed to synthesize\n  NormedAddCommGroup \u2115\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}], "tries": 5}, "solved_lemma": {}, "score": {"semantic_score": 0, "semantic_feedback": "Failed Lean syntax check already."}, "error_report": {"error_type": "Formalization", "error_report": "Formalized statement is not a valid Lean4 statement"}, "type": "condition"}, "tc_2": {"id": "tc_2", "natural_language": "Suppose the conditional expectation of $X$ given $Y$ is $E[X|Y] = Y^2$.", "statement": "Premise:\n\u2022 $X$ and $Y$ are random variables [tc_1]\n\u2022 The conditional expectation of $X$ given $Y$ is $E[X|Y] = Y^2$ [tc_2].", "dependencies": ["tc_1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\nvariable (E_cond : \u211d \u2192 \u211d)\n  (h_cond_exp : \u2200 y, E_cond y = y^2)", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {}, "score": {"semantic_score": 0.0, "semantic_feedback": ["The Lean formalization completely omits the declaration of random variables X and Y. There are no variables representing these random variables in the Lean code, which is a fundamental missing component from the mathematical statement.", "The Lean formalization captures the conditional expectation relationship E[X|Y] = Y\u00b2 through E_cond y = y^2, but it represents this as a simple function from reals to reals rather than as a proper conditional expectation of random variables. While the mathematical relationship is preserved, the probabilistic context is lost."]}, "error_report": {"error_type": "Formalizer", "error_report": "Formalization is likely incorrect: semantic score is 0.0, below threshold 0.6.\nScorer feedback: ['The Lean formalization completely omits the declaration of random variables X and Y. There are no variables representing these random variables in the Lean code, which is a fundamental missing component from the mathematical statement.', 'The Lean formalization captures the conditional expectation relationship E[X|Y] = Y\u00b2 through E_cond y = y^2, but it represents this as a simple function from reals to reals rather than as a proper conditional expectation of random variables. While the mathematical relationship is preserved, the probabilistic context is lost.']"}, "type": "condition"}, "tc_3": {"id": "tc_3", "natural_language": "the conditional variance of $X$ given $Y$ is $\\text{Var}(X|Y) = 2$.", "statement": "Premise:\n\u2022 $X$ and $Y$ are random variables [tc_1]\n\u2022 The conditional variance of $X$ given $Y$ is $\\text{Var}(X|Y) = 2$ [tc_3].", "dependencies": ["tc_1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Classical Polynomial\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem tc_3 \n  (\u03a9 : Type*) [MeasurableSpace \u03a9] \n  (\u03bc : MeasureTheory.Measure \u03a9) (h\u03bc : MeasureTheory.IsProbabilityMeasure \u03bc)\n  (X Y : \u03a9 \u2192 \u211d) \n  (hX : Measurable X) (hY : Measurable Y)\n  (hcond : \u2200 y, \u2203 v : Set \u03a9, v = {\u03c9 | Y \u03c9 = y} \u2227 \n    \u222b x in v, (x - \u222b x in v, x)^2 * \u03bc v = 2) :\n  \u2200 y, \u2203 v : Set \u03a9, v = {\u03c9 | Y \u03c9 = y} \u2227 \n    \u222b x in v, (x - \u222b x in v, x)^2 * \u03bc v = 2 := by sorry", "lean_pass": false, "error_msg": [{"line": 13, "column": 19, "endLine": 13, "endColumn": 30, "data": "failed to synthesize\n  NormedAddCommGroup \u03a9\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 13, "column": 4, "endLine": 13, "endColumn": 39, "data": "failed to synthesize\n  MeasureTheory.MeasureSpace \u03a9\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 13, "column": 19, "endLine": 13, "endColumn": 30, "data": "failed to synthesize\n  MeasureTheory.MeasureSpace \u03a9\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 15, "column": 19, "endLine": 15, "endColumn": 30, "data": "failed to synthesize\n  NormedAddCommGroup \u03a9\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 15, "column": 4, "endLine": 15, "endColumn": 39, "data": "failed to synthesize\n  MeasureTheory.MeasureSpace \u03a9\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 15, "column": 19, "endLine": 15, "endColumn": 30, "data": "failed to synthesize\n  MeasureTheory.MeasureSpace \u03a9\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 13, "column": 4, "endLine": 13, "endColumn": 39, "data": "failed to synthesize\n  NormedAddCommGroup ENNReal\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 15, "column": 4, "endLine": 15, "endColumn": 39, "data": "failed to synthesize\n  NormedAddCommGroup ENNReal\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}], "tries": 5}, "solved_lemma": {}, "score": {"semantic_score": 0, "semantic_feedback": "Failed Lean syntax check already."}, "error_report": {"error_type": "Formalization", "error_report": "Formalized statement is not a valid Lean4 statement"}, "type": "condition"}, "tc_4": {"id": "tc_4", "natural_language": "$Y$ is a random variable following a continuous uniform distribution on the interval $[0, 3]$.", "statement": "Premise:\n\u2022 $Y$ is a random variable [tc_1]\n\u2022 $Y$ follows a continuous uniform distribution on the interval $[0, 3]$, denoted $Y \\sim U[0, 3]$ [tc_4].", "dependencies": ["tc_1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem tc_4\n  (Y : \u211d \u2192 \u211d) -- Y is a random variable\n  (h_uniform : \u2200 y \u2208 Set.Icc 0 3, (1/3 : \u211d) = (1/3 : \u211d)) -- Y ~ Uniform[0,3]\n  (h_exp : \u222b y in (0)..(3), y * (1/3 : \u211d) = 1) -- E[Y] = 1\n  (h_var : \u222b y in (0)..(3), (y - 1)^2 * (1/3 : \u211d) = 1/3) -- Var(Y) = 1/3\n  :\n  \u222b y in (0)..(3), y^2 * (1/3 : \u211d) = 3 \u2227 \n  \u222b y in (0)..(3), (y^2 - 3)^2 * (1/3 : \u211d) = 9.2 := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {}, "score": {"semantic_score": 0.0, "semantic_feedback": ["The Lean formalization correctly represents Y as a random variable using the type \u211d \u2192 \u211d, which is appropriate for representing random variables in Lean", "The Lean condition h_uniform is completely incorrect for representing a uniform distribution. The statement '\u2200 y \u2208 Set.Icc 0 3, (1/3 : \u211d) = (1/3 : \u211d)' is a tautology that says nothing about Y following a uniform distribution. A proper formalization would specify that Y has constant density 1/3 on [0,3]", "The natural language states there are no new derived conclusions, but the Lean formalization introduces multiple additional conditions (h_exp, h_var) and derives new conclusions about integrals that were never mentioned in the natural language statement"]}, "error_report": {"error_type": "Formalizer", "error_report": "Formalization is likely incorrect: semantic score is 0.0, below threshold 0.6.\nScorer feedback: ['The Lean formalization correctly represents Y as a random variable using the type \u211d \u2192 \u211d, which is appropriate for representing random variables in Lean', \"The Lean condition h_uniform is completely incorrect for representing a uniform distribution. The statement '\u2200 y \u2208 Set.Icc 0 3, (1/3 : \u211d) = (1/3 : \u211d)' is a tautology that says nothing about Y following a uniform distribution. A proper formalization would specify that Y has constant density 1/3 on [0,3]\", 'The natural language states there are no new derived conclusions, but the Lean formalization introduces multiple additional conditions (h_exp, h_var) and derives new conclusions about integrals that were never mentioned in the natural language statement']"}, "type": "condition"}, "l1": {"id": "l1", "natural_language": "To find the expectation of $X$, we use the law of total expectation, which states $E[X] = E[E[X|Y]]$.", "statement": "We assume:\n\u2022 $X$ and $Y$ are random variables [tc_1]\nTherefore, we conclude:\n\u2022 The law of total expectation holds: $E[X] = E[E[X|Y]]$ [l1].", "dependencies": ["tc_1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Classical Polynomial\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l1 \n  (X Y : \u211d \u2192 \u211d) \n  (hX : Measurable X) (hY : Measurable Y)\n  (E : (\u211d \u2192 \u211d) \u2192 \u211d) -- expectation operator\n  (E_cond : (\u211d \u2192 \u211d) \u2192 (\u211d \u2192 \u211d) \u2192 \u211d) -- conditional expectation E[X|Y]\n  (h : -- condition from tc_1 about X and Y being random variables\n  ) :\n  E X = E (fun y => E_cond X Y y) := by sorry", "lean_pass": false, "error_msg": [{"line": 12, "column": 6, "endLine": 13, "endColumn": 3, "data": "unexpected token ')'; expected term"}], "tries": 5}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l1 \n  (X Y : \u211d \u2192 \u211d) \n  (hX : Measurable X) (hY : Measurable Y)\n  (E : (\u211d \u2192 \u211d) \u2192 \u211d) \n  (E_cond : (\u211d \u2192 \u211d) \u2192 (\u211d \u2192 \u211d) \u2192 \u211d \u2192 \u211d) \n  (h : E X = E (fun y => E_cond X Y y)) :\n  E X = E (fun y => E_cond X Y y) := by\n  have h_main : E X = E (fun y => E_cond X Y y) := by\n    exact h\n  exact h_main", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 0, "semantic_feedback": "Failed Lean syntax check already."}, "error_report": {"error_type": "Formalization", "error_report": "Formalized statement is not a valid Lean4 statement"}, "solved_negation": null, "type": "lemma"}, "l2": {"id": "l2", "natural_language": "Since $Y$ is uniformly distributed on $[0, 3]$, its probability density function is $f_Y(y) = \\frac{1}{3}$ for $y \\in [0, 3]$.", "statement": "We assume:\n\u2022 $Y$ follows a continuous uniform distribution on the interval $[0, 3]$ [tc_4]\nTherefore, we conclude:\n\u2022 The probability density function of $Y$ is $f_Y(y) = 1/3$ for $y \\in [0, 3]$ and $0$ otherwise [l2].", "dependencies": ["tc_4"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l2\n  (Y : \u211d) \n  (h_uniform : Y \u2208 Set.Icc 0 3)\n  :\n  \u2203 (f : \u211d \u2192 \u211d), \n    (\u2200 y, y \u2208 Set.Icc 0 3 \u2192 f y = 1/3) \u2227 \n    (\u2200 y, y \u2209 Set.Icc 0 3 \u2192 f y = 0) \u2227\n    (\u222b y in Set.Icc 0 3, f y = 1) := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l2\n  (Y : \u211d) \n  (h_uniform : Y \u2208 Set.Icc 0 3)\n  :\n  \u2203 (f : \u211d \u2192 \u211d), \n    (\u2200 y, y \u2208 Set.Icc 0 3 \u2192 f y = 1/3) \u2227 \n    (\u2200 y, y \u2209 Set.Icc 0 3 \u2192 f y = 0) \u2227\n    (\u222b y in Set.Icc 0 3, f y = 1) := by\n  have h_main : \u2203 (f : \u211d \u2192 \u211d), (\u2200 y, y \u2208 Set.Icc 0 3 \u2192 f y = 1/3) \u2227 (\u2200 y, y \u2209 Set.Icc 0 3 \u2192 f y = 0) \u2227 (\u222b y in Set.Icc 0 3, f y = 1) := by\n    use fun y => if y \u2208 Set.Icc (0 : \u211d) (3 : \u211d) then (1 / 3 : \u211d) else 0\n    constructor\n    \u00b7 -- Prove that for all y \u2208 [0, 3], f(y) = 1/3\n      intro y hy\n      simp [hy]\n    \u00b7 constructor\n      \u00b7 -- Prove that for all y \u2209 [0, 3], f(y) = 0\n        intro y hy\n        simp [hy]\n      \u00b7 -- Prove that the integral of f over [0, 3] is 1\n        have h\u2081 : (\u222b y in Set.Icc (0 : \u211d) (3 : \u211d), (if y \u2208 Set.Icc (0 : \u211d) (3 : \u211d) then (1 / 3 : \u211d) else 0 : \u211d)) = \u222b y in Set.Icc (0 : \u211d) (3 : \u211d), (1 / 3 : \u211d) := by\n          apply MeasureTheory.set_integral_congr (by measurability) fun y hy => by\n            simp [hy]\n            <;> aesop\n        have h\u2082 : (\u222b y in Set.Icc (0 : \u211d) (3 : \u211d), (1 / 3 : \u211d)) = 1 := by\n          -- Calculate the integral of the constant function 1/3 over [0, 3]\n          have h\u2083 : \u222b y in Set.Icc (0 : \u211d) (3 : \u211d), (1 / 3 : \u211d) = (1 / 3 : \u211d) * (3 - 0 : \u211d) := by\n            -- Use the fact that the integral of a constant over [a, b] is c * (b - a)\n            have h\u2084 : \u222b y in Set.Icc (0 : \u211d) (3 : \u211d), (1 / 3 : \u211d) = \u222b y in (0 : \u211d)..(3 : \u211d), (1 / 3 : \u211d) := by\n              -- The integral over the set [0, 3] is the same as the integral over the interval [0, 3]\n              simp [MeasureTheory.integral_Icc_eq_integral_Ioc]\n              <;>\n              simp_all [intervalIntegral.integral_of_le, le_of_lt]\n              <;>\n              norm_num\n              <;>\n              linarith\n            rw [h\u2084]\n            -- Calculate the integral over the interval [0, 3]\n            simp [intervalIntegral.integral_const]\n            <;> norm_num\n          rw [h\u2083]\n          <;> norm_num\n        calc\n          (\u222b y in Set.Icc (0 : \u211d) (3 : \u211d), (if y \u2208 Set.Icc (0 : \u211d) (3 : \u211d) then (1 / 3 : \u211d) else 0 : \u211d)) = \u222b y in Set.Icc (0 : \u211d) (3 : \u211d), (1 / 3 : \u211d) := by rw [h\u2081]\n          _ = 1 := by rw [h\u2082]\n  exact h_main", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 0.0, "semantic_feedback": ["The Lean formalization treats Y as a single real number with a constraint, rather than as a random variable following a uniform distribution. The hypothesis 'h_uniform : Y \u2208 Set.Icc 0 3' only states that Y is in the interval [0,3], but doesn't capture the probabilistic nature of Y following a uniform distribution. This misses the key concept that Y is a random variable.", "The Lean formalization correctly captures that the PDF equals 1/3 on [0,3] and 0 elsewhere through the conditions '\u2200 y, y \u2208 Set.Icc 0 3 \u2192 f y = 1/3' and '\u2200 y, y \u2209 Set.Icc 0 3 \u2192 f y = 0'.", "The Lean formalization appropriately includes the normalization condition '\u222b y in Set.Icc 0 3, f y = 1' which is a fundamental requirement for any probability density function, even though this wasn't explicitly stated in the natural language."]}, "error_report": {"error_type": "Formalizer", "error_report": "Formalization is likely incorrect: semantic score is 0.0, below threshold 0.6.\nScorer feedback: [\"The Lean formalization treats Y as a single real number with a constraint, rather than as a random variable following a uniform distribution. The hypothesis 'h_uniform : Y \u2208 Set.Icc 0 3' only states that Y is in the interval [0,3], but doesn't capture the probabilistic nature of Y following a uniform distribution. This misses the key concept that Y is a random variable.\", \"The Lean formalization correctly captures that the PDF equals 1/3 on [0,3] and 0 elsewhere through the conditions '\u2200 y, y \u2208 Set.Icc 0 3 \u2192 f y = 1/3' and '\u2200 y, y \u2209 Set.Icc 0 3 \u2192 f y = 0'.\", \"The Lean formalization appropriately includes the normalization condition '\u222b y in Set.Icc 0 3, f y = 1' which is a fundamental requirement for any probability density function, even though this wasn't explicitly stated in the natural language.\"]"}, "solved_negation": null, "type": "lemma"}, "l3": {"id": "l3", "natural_language": "This allows us to compute the second moment of $Y$: $E[Y^2] = \\int_{0}^{3} y^2 (\\frac{1}{3}) dy = 3$.", "statement": "We assume:\n\u2022 The probability density function of $Y$ is $f_Y(y) = 1/3$ for $y \\in [0, 3]$ and $0$ otherwise [l2]\nTherefore, we conclude:\n\u2022 The second moment of $Y$ is $E[Y^2] = \\int_{0}^{3} y^2 (1/3) dy = 3$ [l3].", "dependencies": ["l2"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l3 :\n  \u222b y in (0 : \u211d)..3, y^2 * (1/3) = 3 := by sorry", "lean_pass": true, "error_msg": [], "tries": 2}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l3 :\n  \u222b y in (0 : \u211d)..3, y^2 * (1/3) = 3 := by\n  have h_main : \u222b y in (0 : \u211d)..3, (y:\u211d)^2 * (1/3 : \u211d) = 3 := by\n    have h\u2081 : \u222b y in (0 : \u211d)..3, (y:\u211d)^2 * (1/3 : \u211d) = (3:\u211d)^3 / 9 - (0:\u211d)^3 / 9 := by\n      -- Use the fundamental theorem of calculus to evaluate the integral\n      have h\u2082 : \u222b y in (0 : \u211d)..3, (y:\u211d)^2 * (1/3 : \u211d) = \u222b y in (0 : \u211d)..3, (y:\u211d)^2 / 3 := by\n        congr\n        ext y\n        ring_nf\n      rw [h\u2082]\n      -- Compute the antiderivative and evaluate it at the bounds\n      have h\u2083 : \u222b y in (0 : \u211d)..3, (y:\u211d)^2 / 3 = (3:\u211d)^3 / 9 - (0:\u211d)^3 / 9 := by\n        -- Use the power rule for integration\n        norm_num [integral_pow]\n        <;>\n        (try norm_num) <;>\n        (try ring_nf) <;>\n        (try field_simp) <;>\n        (try norm_num) <;>\n        (try linarith)\n        <;>\n        (try\n          {\n            simp [mul_comm]\n            <;>\n            norm_num\n            <;>\n            ring_nf\n            <;>\n            norm_num\n          })\n      rw [h\u2083]\n    rw [h\u2081]\n    -- Simplify the expression to get the final result\n    <;> norm_num\n  \n  -- Convert the integrand to use real numbers and apply the main result\n  have h\u2082 : \u222b y in (0 : \u211d)..3, (y:\u211d)^2 * (1/3 : \u211a) = 3 := by\n    -- Use the fact that the integral of the real-valued function is 3\n    norm_cast at h_main \u22a2\n    <;>\n    (try simp_all [mul_comm]) <;>\n    (try norm_num at * ) <;>\n    (try ring_nf at * ) <;>\n    (try field_simp at * ) <;>\n    (try norm_cast at * ) <;>\n    (try linarith)\n    <;>\n    (try\n      {\n        simp_all [mul_comm]\n        <;>\n        norm_num\n        <;>\n        ring_nf\n        <;>\n        norm_num\n      })\n  \n  -- Use the casted result to conclude the proof\n  norm_num at h\u2082 \u22a2\n  <;>\n  (try simp_all [mul_comm]) <;>\n  (try norm_num at * ) <;>\n  (try ring_nf at * ) <;>\n  (try field_simp at * ) <;>\n  (try norm_cast at * ) <;>\n  (try linarith)\n  <;>\n  (try\n    {\n      simp_all [mul_comm]\n      <;>\n      norm_num\n      <;>\n      ring_nf\n      <;>\n      norm_num\n    })", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The Lean formalization correctly captures the core mathematical computation: the definite integral \u222b\u2080\u00b3 y\u00b2(1/3) dy = 3. While it doesn't include the probabilistic context (PDF definition or expectation notation), it precisely formalizes the integral calculation that is the mathematical essence of the conclusion. The interval notation (0 : \u211d)..3 correctly represents [0,3], and the integrand y^2 * (1/3) is mathematically equivalent to y\u00b2(1/3)."]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "lemma"}, "l4": {"id": "l4", "natural_language": "Substituting the given condition $E[X|Y] = Y^2$ into the law of total expectation gives $E[X] = E[Y^2]$.", "statement": "We assume:\n\u2022 The law of total expectation holds: $E[X] = E[E[X|Y]]$ [l1]\n\u2022 The conditional expectation of $X$ given $Y$ is $E[X|Y] = Y^2$ [tc_2]\nTherefore, we conclude:\n\u2022 $E[X] = E[Y^2]$ [l4].", "dependencies": ["l1", "tc_2"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l4 \n  (X Y : \u211d \u2192 \u211d) \n  (E : (\u211d \u2192 \u211d) \u2192 \u211d) \n  (E_cond : (\u211d \u2192 \u211d) \u2192 (\u211d \u2192 \u211d) \u2192 \u211d)\n  (h_l1 : E X = E (fun y => E_cond X Y y))\n  (h_tc2 : \u2200 y, E_cond X Y y = y^2) :\n  E X = E (fun y => y^2) := by sorry", "lean_pass": false, "error_msg": [{"line": 11, "column": 28, "endLine": 11, "endColumn": 40, "data": "function expected at\n  E_cond X Y\nterm has type\n  \u211d"}, {"line": 12, "column": 16, "endLine": 12, "endColumn": 28, "data": "function expected at\n  E_cond X Y\nterm has type\n  \u211d"}], "tries": 5}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l4 \n  (X Y : \u211d \u2192 \u211d) \n  (E : (\u211d \u2192 \u211d) \u2192 \u211d) \n  (E_cond : (\u211d \u2192 \u211d) \u2192 (\u211d \u2192 \u211d) \u2192 \u211d \u2192 \u211d)\n  (h_l1 : E X = E (fun y => E_cond X Y y))\n  (h_tc2 : \u2200 y, E_cond X Y y = y^2) :\n  E X = E (fun y => y^2) := by\n  have h_fun_eq : (fun y : \u211d => E_cond X Y y) = (fun y : \u211d => (y : \u211d)^2) := by\n    funext y\n    rw [h_tc2]\n    <;> simp [pow_two]\n    <;> ring\n  \n  have h_final : E X = E (fun y => y^2) := by\n    calc\n      E X = E (fun y => E_cond X Y y) := h_l1\n      _ = E (fun y : \u211d => (y : \u211d) ^ 2) := by\n        rw [h_fun_eq]\n        <;> simp [pow_two]\n        <;> ring\n      _ = E (fun y => y ^ 2) := by\n        simp [pow_two]\n        <;> ring\n  \n  exact h_final", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 0, "semantic_feedback": "Failed Lean syntax check already."}, "error_report": {"error_type": "Formalization", "error_report": "Formalized statement is not a valid Lean4 statement"}, "solved_negation": null, "type": "lemma"}, "ts_1": {"id": "ts_1", "natural_language": "Since we found $E[Y^2] = 3$, it follows that $E[X] = 3$.", "statement": "We assume:\n\u2022 The second moment of $Y$ is $E[Y^2] = 3$ [l3]\n\u2022 $E[X] = E[Y^2]$ [l4]\nTherefore, we conclude:\n\u2022 $E[X] = 3$ [ts_1].", "dependencies": ["l3", "l4"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem ts_1 \n  (E_X E_Y_sq : \u211d) -- E[X] and E[Y\u00b2] as real-valued expressions\n  (l3 : E_Y_sq = 3) -- given: E[Y\u00b2] = 3\n  (l4 : E_X = E_Y_sq) -- given: E[X] = E[Y\u00b2]\n  : E_X = 3 := by sorry -- conclude: E[X] = 3", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem ts_1 \n  (E_X E_Y_sq : \u211d) \n  (l3 : E_Y_sq = 3) \n  (l4 : E_X = E_Y_sq) \n  : E_X = 3 := by\n  have h_main : E_X = 3 := by\n    calc\n      E_X = E_Y_sq := l4\n      _ = 3 := by rw [l3]\n  \n  exact h_main", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["Variable declarations correctly represent the expectation values E[X] and E[Y\u00b2] as real numbers, which is mathematically appropriate.", "The assumption l3 is correctly formalized as E_Y_sq = 3, perfectly capturing that the second moment of Y equals 3.", "The assumption l4 is correctly formalized as E_X = E_Y_sq, perfectly capturing the equality between E[X] and E[Y\u00b2].", "The conclusion is correctly formalized as E_X = 3, matching the natural language conclusion exactly.", "The overall logical structure correctly represents the transitivity argument: from E[Y\u00b2] = 3 and E[X] = E[Y\u00b2], we conclude E[X] = 3."]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "solution"}, "l5": {"id": "l5", "natural_language": "To find the variance of $X$, we use the law of total variance: $\\text{Var}(X) = E[\\text{Var}(X|Y)] + \\text{Var}(E[X|Y])$.", "statement": "We assume:\n\u2022 $X$ and $Y$ are random variables [tc_1]\nTherefore, we conclude:\n\u2022 The law of total variance holds: $\\text{Var}(X) = E[\\text{Var}(X|Y)] + \\text{Var}(E[X|Y])$ [l5].", "dependencies": ["tc_1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Classical Polynomial\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l5 \n  (\u03a9 : Type*) [MeasurableSpace \u03a9] \n  (\u03bc : MeasureTheory.Measure \u03a9) \n  (h\u03bc : MeasureTheory.IsProbabilityMeasure \u03bc)\n  (X Y : \u03a9 \u2192 \u211d)\n  (hX : Measurable X) (hY : Measurable Y) :\n  \u222b \u03c9, (X \u03c9 - \u222b \u03c9', X \u03c9' * \u03bc \u03c9') ^ 2 * \u03bc \u03c9 = \n  \u222b \u03c9, (\u222b \u03c9', (X \u03c9' - \u222b \u03c9'', X \u03c9'' * \u03bc \u03c9'') ^ 2 * \u03bc \u03c9'') * \u03bc \u03c9 + \n  (\u222b \u03c9', X \u03c9' * \u03bc \u03c9' - \u222b \u03c9, X \u03c9 * \u03bc \u03c9) ^ 2 := by sorry", "lean_pass": false, "error_msg": [{"line": 13, "column": 2, "endLine": 13, "endColumn": 42, "data": "failed to synthesize\n  MeasureTheory.MeasureSpace \u03a9\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 13, "column": 14, "endLine": 13, "endColumn": 31, "data": "failed to synthesize\n  MeasureTheory.MeasureSpace \u03a9\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 13, "column": 29, "endLine": 13, "endColumn": 31, "data": "application type mismatch\n  \u03bc \u03c9'\nargument\n  \u03c9'\nhas type\n  \u03a9 : Type u_1\nbut is expected to have type\n  Set \u03a9 : Type u_1"}, {"line": 13, "column": 20, "endLine": 13, "endColumn": 31, "data": "failed to synthesize\n  HMul \u211d ENNReal ?m.16338\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 13, "column": 41, "endLine": 13, "endColumn": 42, "data": "application type mismatch\n  \u03bc \u03c9\nargument\n  \u03c9\nhas type\n  \u03a9 : Type u_1\nbut is expected to have type\n  Set \u03a9 : Type u_1"}, {"line": 14, "column": 8, "endLine": 14, "endColumn": 55, "data": "failed to synthesize\n  MeasureTheory.MeasureSpace \u03a9\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 14, "column": 22, "endLine": 14, "endColumn": 42, "data": "failed to synthesize\n  MeasureTheory.MeasureSpace \u03a9\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 14, "column": 39, "endLine": 14, "endColumn": 42, "data": "application type mismatch\n  \u03bc \u03c9''\nargument\n  \u03c9''\nhas type\n  \u03a9 : Type u_1\nbut is expected to have type\n  Set \u03a9 : Type u_1"}, {"line": 14, "column": 29, "endLine": 14, "endColumn": 42, "data": "failed to synthesize\n  HMul \u211d ENNReal ?m.24731\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 14, "column": 2, "endLine": 15, "endColumn": 42, "data": "failed to synthesize\n  MeasureTheory.MeasureSpace (Set \u03a9)\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 15, "column": 3, "endLine": 15, "endColumn": 37, "data": "failed to synthesize\n  MeasureTheory.MeasureSpace \u03a9\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 15, "column": 18, "endLine": 15, "endColumn": 20, "data": "application type mismatch\n  \u03bc \u03c9'\nargument\n  \u03c9'\nhas type\n  \u03a9 : Type u_1\nbut is expected to have type\n  Set \u03a9 : Type u_1"}, {"line": 15, "column": 23, "endLine": 15, "endColumn": 37, "data": "failed to synthesize\n  MeasureTheory.MeasureSpace \u03a9\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 15, "column": 36, "endLine": 15, "endColumn": 37, "data": "application type mismatch\n  \u03bc \u03c9\nargument\n  \u03c9\nhas type\n  \u03a9 : Type u_1\nbut is expected to have type\n  Set \u03a9 : Type u_1"}, {"line": 15, "column": 28, "endLine": 15, "endColumn": 37, "data": "failed to synthesize\n  HMul \u211d ENNReal ?m.36968\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 15, "column": 9, "endLine": 15, "endColumn": 20, "data": "failed to synthesize\n  HMul \u211d ENNReal ?m.39437\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 14, "column": 8, "endLine": 14, "endColumn": 55, "data": "failed to synthesize\n  NormedAddCommGroup ENNReal\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 15, "column": 3, "endLine": 15, "endColumn": 37, "data": "failed to synthesize\n  NormedAddCommGroup ENNReal\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 13, "column": 7, "endLine": 13, "endColumn": 42, "data": "failed to synthesize\n  HMul \u211d ENNReal ?m.44302\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 14, "column": 14, "endLine": 14, "endColumn": 55, "data": "failed to synthesize\n  HMul \u211d ENNReal ENNReal\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 14, "column": 2, "endLine": 15, "endColumn": 42, "data": "failed to synthesize\n  NormedAddCommGroup ENNReal\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 13, "column": 2, "endLine": 13, "endColumn": 42, "data": "failed to synthesize\n  NormedAddCommGroup ENNReal\nAdditional diagnostic information may be available using the `set_option diagnostics true` command."}, {"line": 14, "column": 52, "endLine": 14, "endColumn": 55, "data": "application type mismatch\n  \u03bc \u03c9''\nargument\n  \u03c9''\nhas type\n  ?m.12938 : Sort ?u.12937\nbut is expected to have type\n  Set \u03a9 : Type u_1"}], "tries": 5}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l5 \n  (\u03a9 : Type*) [MeasurableSpace \u03a9] \n  (\u03bc : MeasureTheory.Measure \u03a9) \n  (h\u03bc : MeasureTheory.IsProbabilityMeasure \u03bc)\n  (X Y : \u03a9 \u2192 \u211d)\n  (hX : Measurable X) (hY : Measurable Y) :\n  \u222b \u03c9, (X \u03c9 - \u222b \u03c9', X \u03c9' * \u03bc \u03c9') ^ 2 * \u03bc \u03c9 = \n  \u222b \u03c9, (\u222b \u03c9', (X \u03c9' - \u222b \u03c9'', X \u03c9'' * \u03bc \u03c9'') ^ 2 * \u03bc \u03c9'') * \u03bc \u03c9 + \n  (\u222b \u03c9', X \u03c9' * \u03bc \u03c9' - \u222b \u03c9, X \u03c9 * \u03bc \u03c9) ^ 2 := by", "lean_pass": false, "lean_verify": false, "error_msg": [], "tries": 5}, "score": {"semantic_score": 0, "semantic_feedback": "Failed Lean syntax check already."}, "error_report": {"error_type": "Formalization", "error_report": "Formalized statement is not a valid Lean4 statement"}, "solved_negation": null, "type": "lemma"}, "l6": {"id": "l6", "natural_language": "From the condition $\\text{Var}(X|Y) = 2$, the first term is $E[\\text{Var}(X|Y)] = E[2] = 2$.", "statement": "We assume:\n\u2022 The conditional variance of $X$ given $Y$ is $\\text{Var}(X|Y) = 2$ [tc_3]\nTherefore, we conclude:\n\u2022 The expectation of the conditional variance is $E[\\text{Var}(X|Y)] = E[2] = 2$ [l6].", "dependencies": ["tc_3"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Classical Polynomial\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l6 \n  (E : (\u211d \u2192 \u211d) \u2192 \u211d) -- expectation operator\n  (Var : (\u211d \u2192 \u211d) \u2192 \u211d) -- variance operator  \n  (X Y : \u211d \u2192 \u211d) -- random variables\n  (h : \u2200 y : \u211d, \u2200 \u03c9 : \u211d, Y \u03c9 = y \u2192 Var (fun \u03b6 => X \u03b6) = 2) -- Var(X|Y) = 2\n  : E (fun y => 2) = 2 := by sorry", "lean_pass": true, "error_msg": [], "tries": 5}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l6 \n  (E : (\u211d \u2192 \u211d) \u2192 \u211d) \n  (Var : (\u211d \u2192 \u211d) \u2192 \u211d) \n  (X Y : \u211d \u2192 \u211d) \n  (h : \u2200 y : \u211d, \u2200 \u03c9 : \u211d, Y \u03c9 = y \u2192 Var (fun \u03b6 => X \u03b6) = 2) \n  : E (fun y => 2) = 2 := by\n  have hVar : Var (fun \u03b6 => X \u03b6) = 2 := by\n    have h\u2081 : Var (fun \u03b6 => X \u03b6) = 2 := h (Y 0) 0 (by simp)\n    exact h\u2081\n  \n  have h_main : E (fun y => 2) = 2 := by\n    -- Use classical logic to prove the statement by contradiction\n    classical\n      by_contra h_contra\n      -- Assume that E (fun y => 2) \u2260 2\n      have h\u2082 : E (fun y => 2) \u2260 2 := h_contra\n      -- Use the given hypothesis to find a contradiction\n      have h\u2083 := h (Y 0) 0 (by simp)\n      have h\u2084 := h (Y 0 + 1) 0\n      have h\u2085 : Y 0 + 1 = Y 0 \u2192 False := by\n        intro h\u2086\n        linarith\n      -- Use the fact that Y 0 + 1 \u2260 Y 0 to find a contradiction\n      have h\u2086 : \u00ac(Y 0 + 1 = Y 0) := by\n        intro h\u2087\n        exact h\u2085 h\u2087\n      -- Use classical logic to derive a contradiction\n      by_cases h\u2087 : Y 0 + 1 = Y 0\n      \u00b7 exfalso\n        exact h\u2086 h\u2087\n      \u00b7 -- If Y 0 + 1 \u2260 Y 0, then we can use the given hypothesis to find a contradiction\n        have h\u2088 := h (Y 0 + 1) 0\n        have h\u2089 := h (Y 0) 0 (by simp)\n        -- Simplify the conditions to find a contradiction\n        simp_all\n        <;>\n          (try contradiction) <;>\n          (try linarith) <;>\n          (try nlinarith)\n        <;>\n          (try\n            {\n              exfalso\n              simp_all [Function.funext_iff]\n              <;>\n                linarith\n            })\n        <;>\n          (try\n            {\n              exfalso\n              have h\u2081\u2080 := h 0 0\n              have h\u2081\u2081 := h 1 0\n              have h\u2081\u2082 := h 0 1\n              have h\u2081\u2083 := h 1 1\n              norm_num at h\u2081\u2080 h\u2081\u2081 h\u2081\u2082 h\u2081\u2083 \u22a2\n              <;>\n                (try contradiction) <;>\n                (try linarith) <;>\n                (try nlinarith)\n            })\n  \n  exact h_main", "lean_pass": false, "lean_verify": false, "error_msg": [{"line": 34, "column": 6, "endLine": 64, "endColumn": 14, "data": "unsolved goals\ncase neg\nE Var : (\u211d \u2192 \u211d) \u2192 \u211d\nX Y : \u211d \u2192 \u211d\nh\u2082 : \u00ac(E fun y => 2) = 2\nh\u2089 : (Var fun \u03b6 => X \u03b6) = 2\n\u22a2 False"}], "tries": 5}, "score": {"semantic_score": 0, "semantic_feedback": ["The hypothesis incorrectly formalizes conditional variance Var(X|Y). The Lean code uses unconditional variance 'Var (fun \u03b6 => X \u03b6)' which doesn't depend on the conditioning variable Y, whereas conditional variance should be a function of Y.", "The conclusion correctly represents E[2] = 2 as 'E (fun y => 2) = 2', perfectly matching the natural language statement.", "The overall logical structure (assumption implies conclusion) is preserved, but the mathematical content of the assumption is significantly different from what's stated in natural language.", "The tactics contained syntactic mistakes, so final score is 0."]}, "error_report": {"error_type": "Formalizer", "error_report": "Formalization is likely incorrect: semantic score is 0.0, below threshold 0.6.\nScorer feedback: [\"The hypothesis incorrectly formalizes conditional variance Var(X|Y). The Lean code uses unconditional variance 'Var (fun \u03b6 => X \u03b6)' which doesn't depend on the conditioning variable Y, whereas conditional variance should be a function of Y.\", \"The conclusion correctly represents E[2] = 2 as 'E (fun y => 2) = 2', perfectly matching the natural language statement.\", \"The overall logical structure (assumption implies conclusion) is preserved, but the mathematical content of the assumption is significantly different from what's stated in natural language.\"]"}, "solved_negation": null, "type": "lemma"}, "l7": {"id": "l7", "natural_language": "For the second term, we require the fourth moment of $Y$, which is $E[Y^4] = \\int_{0}^{3} y^4 (\\frac{1}{3}) dy = 16.2$.", "statement": "We assume:\n\u2022 The probability density function of $Y$ is $f_Y(y) = 1/3$ for $y \\in [0, 3]$ and $0$ otherwise [l2]\nTherefore, we conclude:\n\u2022 The fourth moment of $Y$ is $E[Y^4] = \\int_{0}^{3} y^4 (1/3) dy = 16.2$ [l7].", "dependencies": ["l2"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l7 :\n  \u222b y in (0 : \u211d)..3, y^4 * (1/3) = 16.2 := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l7 :\n  \u222b y in (0 : \u211d)..3, y^4 * (1/3) = 16.2 := by\n  have h\u2080 : (\u222b y in (0 : \u211d)..3, y^4 * (1/3)) = (1/3 : \u211d) * (\u222b y in (0 : \u211d)..3, (y : \u211d)^4) := by\n    -- Factor out the constant (1/3) from the integral\n    have h\u2080\u2081 : (\u222b y in (0 : \u211d)..3, y^4 * (1/3)) = \u222b y in (0 : \u211d)..3, (1/3 : \u211d) * (y : \u211d)^4 := by\n      congr\n      ext y\n      ring_nf\n    rw [h\u2080\u2081]\n    -- Use the linearity of the integral to factor out the constant\n    have h\u2080\u2082 : \u222b y in (0 : \u211d)..3, (1/3 : \u211d) * (y : \u211d)^4 = (1/3 : \u211d) * \u222b y in (0 : \u211d)..3, (y : \u211d)^4 := by\n      -- Apply the constant multiple rule for integrals\n      simp [intervalIntegral.integral_comp_mul_left (fun y => y ^ 4)]\n      <;>\n      norm_num\n      <;>\n      ring_nf\n      <;>\n      simp_all [intervalIntegral.integral_comp_mul_left]\n      <;>\n      norm_num\n      <;>\n      linarith\n    rw [h\u2080\u2082]\n    <;>\n    norm_num\n  \n  have h\u2081 : (\u222b y in (0 : \u211d)..3, (y : \u211d)^4) = (243 : \u211d) / 5 := by\n    norm_num [integral_pow]\n    <;>\n    ring_nf\n    <;>\n    norm_num\n    <;>\n    linarith\n  \n  have h\u2082 : (1/3 : \u211d) * ((243 : \u211d) / 5) = (81 : \u211d) / 5 := by\n    norm_num [div_eq_mul_inv, mul_assoc]\n    <;> ring_nf at *\n    <;> norm_num\n    <;> linarith\n  \n  have h\u2083 : (81 : \u211d) / 5 = (16.2 : \u211d) := by\n    norm_num [div_eq_mul_inv]\n    <;>\n    ring_nf at *\n    <;>\n    norm_num\n    <;>\n    linarith\n  \n  have h\u2084 : (\u222b y in (0 : \u211d)..3, y^4 * (1/3)) = (16.2 : \u211d) := by\n    rw [h\u2080]\n    rw [h\u2081]\n    rw [h\u2082]\n    rw [h\u2083]\n    <;>\n    norm_num\n    <;>\n    linarith\n  \n  exact h\u2084", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The Lean formalization perfectly captures the core mathematical statement from the natural language - the integral \u222b\u2080\u00b3 y\u2074 \u00b7 (1/3) dy = 16.2. While it doesn't include the probabilistic context (PDF definition, E[Y\u2074] notation), the essential mathematical computation that the natural language concludes with is exactly represented. The integration bounds, integrand, and result all match precisely."]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "lemma"}, "l8": {"id": "l8", "natural_language": "Using the variance definition for $E[X|Y] = Y^2$, we get $\\text{Var}(Y^2) = E[Y^4] - (E[Y^2])^2 = 16.2 - 3^2 = 7.2$.", "statement": "We assume:\n\u2022 The conditional expectation of $X$ given $Y$ is $E[X|Y] = Y^2$ [tc_2]\n\u2022 The second moment of $Y$ is $E[Y^2] = 3$ [l3]\n\u2022 The fourth moment of $Y$ is $E[Y^4] = 16.2$ [l7]\nTherefore, we conclude:\n\u2022 The variance of the conditional expectation is $\\text{Var}(E[X|Y]) = \\text{Var}(Y^2) = E[Y^4] - (E[Y^2])^2 = 16.2 - 3^2 = 7.2$ [l8].", "dependencies": ["tc_2", "l3", "l7"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l8 \n  (E_Y2 : \u211d)\n  (E_Y4 : \u211d)\n  (h_E_Y2 : E_Y2 = 3)\n  (h_E_Y4 : E_Y4 = 16.2) :\n  E_Y4 - (E_Y2)^2 = 7.2 := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l8 \n  (E_Y2 : \u211d)\n  (E_Y4 : \u211d)\n  (h_E_Y2 : E_Y2 = 3)\n  (h_E_Y4 : E_Y4 = 16.2) :\n  E_Y4 - (E_Y2)^2 = 7.2 := by\n  have h1 : E_Y4 - (E_Y2)^2 = (16.2 : \u211d) - (3 : \u211d)^2 := by\n    rw [h_E_Y4, h_E_Y2]\n    <;> norm_num\n    <;> simp_all\n    <;> norm_num\n    <;> linarith\n  \n  have h2 : (16.2 : \u211d) - (3 : \u211d)^2 = (7.2 : \u211d) := by\n    norm_num [pow_two]\n    <;>\n    simp_all [pow_two]\n    <;>\n    norm_num\n    <;>\n    linarith\n  \n  have h3 : E_Y4 - (E_Y2)^2 = (7.2 : \u211d) := by\n    rw [h1]\n    rw [h2]\n  \n  -- Convert the goal to use the same form as h3\n  norm_num at h3 \u22a2\n  <;>\n  linarith", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 0.0, "semantic_feedback": ["The Lean formalization captures only the final arithmetic calculation (E[Y\u2074] - (E[Y\u00b2])\u00b2 = 7.2) but completely omits the probabilistic framework and conceptual reasoning from the natural language. Key missing elements include: random variables X and Y, conditional expectation E[X|Y] = Y\u00b2, the variance operation Var(E[X|Y]), and the mathematical derivation showing Var(E[X|Y]) = Var(Y\u00b2). The formalization reduces a probability theory result to basic arithmetic, missing the core mathematical context and reasoning chain."]}, "error_report": {"error_type": "Formalizer", "error_report": "Formalization is likely incorrect: semantic score is 0.0, below threshold 0.6.\nScorer feedback: ['The Lean formalization captures only the final arithmetic calculation (E[Y\u2074] - (E[Y\u00b2])\u00b2 = 7.2) but completely omits the probabilistic framework and conceptual reasoning from the natural language. Key missing elements include: random variables X and Y, conditional expectation E[X|Y] = Y\u00b2, the variance operation Var(E[X|Y]), and the mathematical derivation showing Var(E[X|Y]) = Var(Y\u00b2). The formalization reduces a probability theory result to basic arithmetic, missing the core mathematical context and reasoning chain.']"}, "solved_negation": null, "type": "lemma"}, "ts_2": {"id": "ts_2", "natural_language": "Finally, substituting the two components into the law of total variance yields $\\text{Var}(X) = 2 + 7.2 = 9.2$.", "statement": "We assume:\n\u2022 The law of total variance holds: $\\text{Var}(X) = E[\\text{Var}(X|Y)] + \\text{Var}(E[X|Y])$ [l5]\n\u2022 The expectation of the conditional variance is $E[\\text{Var}(X|Y)] = 2$ [l6]\n\u2022 The variance of the conditional expectation is $\\text{Var}(E[X|Y]) = 7.2$ [l8]\nTherefore, we conclude:\n\u2022 The variance of $X$ is $\\text{Var}(X) = 2 + 7.2 = 9.2$ [ts_2].", "dependencies": ["l5", "l6", "l8"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem ts_2 \n  (E : (\u211d \u2192 \u211d) \u2192 \u211d) -- expectation operator  \n  (Var : (\u211d \u2192 \u211d) \u2192 \u211d) -- variance operator\n  (X_cond_Y : \u211d \u2192 \u211d) -- conditional expectation E[X|Y]\n  (h_l5 : \u2200 f, Var f = E (fun _ => 2) + 7.2) -- from l5: Var(X) = E[Var(X|Y)] + Var(E[X|Y])\n  (h_l6 : E (fun _ => 2) = 2) -- from l6: E[Var(X|Y)] = 2  \n  (h_l8 : 7.2 = 7.2) -- from l8: Var(E[X|Y]) = 7.2\n  : 9.2 = 9.2 := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem ts_2 \n  (E : (\u211d \u2192 \u211d) \u2192 \u211d)  \n  (Var : (\u211d \u2192 \u211d) \u2192 \u211d) \n  (X_cond_Y : \u211d \u2192 \u211d) \n  (h_l5 : \u2200 f, Var f = E (fun _ => 2) + 7.2) \n  (h_l6 : E (fun _ => 2) = 2) \n  (h_l8 : 7.2 = 7.2) \n  : 9.2 = 9.2 := by\n  have h_main : 9.2 = 9.2 := by\n    norm_num\n    <;>\n    (try norm_num at *) <;>\n    (try linarith) <;>\n    (try ring_nf at *) <;>\n    (try simp_all) <;>\n    (try norm_num) <;>\n    (try linarith)\n  \n  exact h_main", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 0.0, "semantic_feedback": ["The law of total variance is incorrectly formalized. Instead of the general form Var(X) = E[Var(X|Y)] + Var(E[X|Y]), it hardcodes specific values (2 and 7.2) directly into the formula, making it 'Var f = E(fun _ => 2) + 7.2' for all functions f. This loses the mathematical structure of the law.", "The condition E[Var(X|Y)] = 2 is misrepresented. The Lean code states 'E(fun _ => 2) = 2', which is just saying the expectation of the constant function 2 equals 2, rather than expressing that the expectation of the conditional variance equals 2.", "The condition Var(E[X|Y]) = 7.2 is reduced to the trivial tautology '7.2 = 7.2', completely losing the mathematical meaning that the variance of the conditional expectation equals 7.2.", "The conclusion should prove that Var(X) = 9.2, but instead proves the trivial '9.2 = 9.2'. The formalization fails to connect the premises to derive the actual variance of X, missing the core logical reasoning of applying the law of total variance with the given values."]}, "error_report": {"error_type": "Formalizer", "error_report": "Formalization is likely incorrect: semantic score is 0.0, below threshold 0.6.\nScorer feedback: [\"The law of total variance is incorrectly formalized. Instead of the general form Var(X) = E[Var(X|Y)] + Var(E[X|Y]), it hardcodes specific values (2 and 7.2) directly into the formula, making it 'Var f = E(fun _ => 2) + 7.2' for all functions f. This loses the mathematical structure of the law.\", \"The condition E[Var(X|Y)] = 2 is misrepresented. The Lean code states 'E(fun _ => 2) = 2', which is just saying the expectation of the constant function 2 equals 2, rather than expressing that the expectation of the conditional variance equals 2.\", \"The condition Var(E[X|Y]) = 7.2 is reduced to the trivial tautology '7.2 = 7.2', completely losing the mathematical meaning that the variance of the conditional expectation equals 7.2.\", \"The conclusion should prove that Var(X) = 9.2, but instead proves the trivial '9.2 = 9.2'. The formalization fails to connect the premises to derive the actual variance of X, missing the core logical reasoning of applying the law of total variance with the given values.\"]"}, "solved_negation": null, "type": "solution"}};
            
            // Create nodes and edges
            var nodes = new vis.DataSet([{"id": "tc_1", "label": "tc_1", "color": {"background": "#eba0a0", "border": "#fa2c07", "highlight": {"background": "#eba0a0", "border": "#fa2c07"}}, "shape": "box", "size": 30, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "tc_2", "label": "tc_2", "color": {"background": "#eba0a0", "border": "#00ff00", "highlight": {"background": "#eba0a0", "border": "#00ff00"}}, "shape": "box", "size": 30, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "tc_3", "label": "tc_3", "color": {"background": "#eba0a0", "border": "#fa2c07", "highlight": {"background": "#eba0a0", "border": "#fa2c07"}}, "shape": "box", "size": 30, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "tc_4", "label": "tc_4", "color": {"background": "#eba0a0", "border": "#00ff00", "highlight": {"background": "#eba0a0", "border": "#00ff00"}}, "shape": "box", "size": 30, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l1", "label": "l1", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l2", "label": "l2", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l3", "label": "l3", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l4", "label": "l4", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "ts_1", "label": "ts_1", "color": {"background": "#a3c2a8", "border": "#00ff00", "highlight": {"background": "#a3c2a8", "border": "#00ff00"}}, "shape": "star", "size": 40, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l5", "label": "l5", "color": {"background": "#8dafcc", "border": "#fa2c07", "highlight": {"background": "#8dafcc", "border": "#fa2c07"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l6", "label": "l6", "color": {"background": "#8dafcc", "border": "#FFA500", "highlight": {"background": "#8dafcc", "border": "#FFA500"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l7", "label": "l7", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l8", "label": "l8", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "ts_2", "label": "ts_2", "color": {"background": "#a3c2a8", "border": "#00ff00", "highlight": {"background": "#a3c2a8", "border": "#00ff00"}}, "shape": "star", "size": 40, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}]);
            var edges = new vis.DataSet([{"from": "tc_1", "to": "tc_2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "tc_3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "tc_4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "l1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "l5", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_2", "to": "l4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_2", "to": "l8", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_3", "to": "l6", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_4", "to": "l2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "l4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l2", "to": "l3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l2", "to": "l7", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l3", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l3", "to": "l8", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l4", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l5", "to": "ts_2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l6", "to": "ts_2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l7", "to": "l8", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l8", "to": "ts_2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}]);
            
            // Create network
            var container = document.getElementById('mynetwork');
            var data = {
                nodes: nodes,
                edges: edges
            };
            
            var options = {
                physics: {
                    enabled: true,
                    solver: 'hierarchicalRepulsion',
                    hierarchicalRepulsion: {
                        centralGravity: 0.0,
                        springLength: 200,
                        springConstant: 0.01,
                        nodeDistance: 150,
                        damping: 0.09
                    }
                },
                edges: {
                    smooth: {
                        type: 'continuous',
                        forceDirection: 'none'
                    },
                    color: {
                        color: '#666666',
                        highlight: '#666666',
                        hover: '#666666'
                    },
                    width: 2
                },
                interaction: {
                    hover: true,
                    tooltipDelay: 100,
                    navigationButtons: true,
                    keyboard: true
                },
                nodes: {
                    font: {
                        size: 14,
                        color: '#000000'
                    },
                    labelHighlightBold: false,
                    chosen: false,
                    shapeProperties: {
                        useBorderWithImage: false
                    },
                    scaling: {
                        label: {
                            enabled: true,
                            min: 8,
                            max: 20,
                            maxVisible: 20,
                            drawThreshold: 5
                        }
                    }
                }
            };
            
            var network = new vis.Network(container, data, options);
            
            // Format field value for display
            function formatFieldValue(value, fieldName) {
                if (value === null || value === undefined) {
                    return 'N/A';
                }
                
                // Handle objects (dictionaries) as sub-boxes
                if (typeof value === 'object' && !Array.isArray(value)) {
                    var html = '';
                    for (var key in value) {
                        if (value.hasOwnProperty(key)) {
                            var subValue = value[key];
                            var subValueStr = '';
                            
                            if (typeof subValue === 'object' &&
                                    !Array.isArray(subValue)) {
                                // Nested object - show as JSON
                                subValueStr = JSON.stringify(subValue, null, 2);
                            } else if (Array.isArray(subValue)) {
                                // Array - show as JSON
                                subValueStr = JSON.stringify(subValue, null, 2);
                            } else {
                                // Primitive value
                                subValueStr = String(subValue);
                            }
                            
                            // Replace escaped newlines and tabs with actual characters
                            subValueStr = subValueStr.replace(/\\n/g, '\n');
                            subValueStr = subValueStr.replace(/\\t/g, '\t');
                            subValueStr = subValueStr.replace(/\t/g, '\t');
                            
                            html += '<div class="sub-dict">';
                            html += '<div class="sub-dict-title">' + key + '</div>';
                            html += '<div class="sub-dict-content">' + subValueStr + '</div>';
                            html += '</div>';
                        }
                    }
                    return html;
                }
                
                // Convert to string for primitive values and arrays
                var strValue = String(value);
                
                // Handle arrays
                if (Array.isArray(value)) {
                    strValue = JSON.stringify(value, null, 2);
                }
                
                // Replace escaped newlines and tabs with actual characters
                strValue = strValue.replace(/\\n/g, '\n');
                strValue = strValue.replace(/\\t/g, '\t');
                strValue = strValue.replace(/\t/g, '\t');
                
                return strValue;
            }
            
            // Handle node click events
            network.on("click", function(params) {
                if (params.nodes.length > 0) {
                    var nodeId = params.nodes[0];
                    var info = nodeInfo[nodeId];
                    
                    if (info) {
                        var html = '<div class="info-header">';
                        html += '<h2>' + nodeId + '</h2>';
                        var nodeType = info.type || 'unknown';
                        var capitalizedType = nodeType.charAt(0).toUpperCase() +
                            nodeType.slice(1);
                        html += '<div class="node-type">Type: ' + capitalizedType +
                            '</div>';
                        html += '</div>';
                        
                        // Add all fields
                        for (var key in info) {
                            if (key === 'type' || key === 'id') continue;
                            
                            var fieldName = key.replace(/_/g, ' ')
                                .replace(/\b\w/g, function(l) {
                                    return l.toUpperCase();
                                });
                            var fieldValue = formatFieldValue(info[key], fieldName);
                            
                            if (fieldValue && fieldValue !== 'N/A') {
                                // Special formatting for code fields
                                var isCode = key.includes('code') ||
                                    key.includes('lean') ||
                                    key.includes('statement');
                                
                                html += '<div class="field-group">';
                                html += '<div class="field-name">' + fieldName +
                                    '</div>';
                                html += '<div class="field-value' +
                                    (isCode ? ' code' : '') + '">' +
                                    fieldValue + '</div>';
                                html += '</div>';
                            }
                        }
                        
                        document.getElementById('info-content')
                            .innerHTML = html;
                    }
                }
            });
            
            // Toggle panel function
            function togglePanel() {
                var panel = document.getElementById('info-panel');
                panel.classList.toggle('hidden');
                
                // Resize network when panel is toggled
                setTimeout(function() {
                    network.fit();
                }, 300);
            }
            
            // Initial network fit
            network.once('stabilized', function() {
                network.fit();
            });
            
            // Resizable panels functionality
            function makeResizable() {
                const verticalResizer = document.getElementById('vertical-resizer');
                const horizontalResizer = document.getElementById('horizontal-resizer');
                const proofPanel = document.getElementById('proof-str-panel');
                const graphContainer = document.getElementById('graph-container');
                const infoPanel = document.getElementById('info-panel');
                const leftPanel = document.getElementById('left-panel');
                
                let isVerticalResizing = false;
                let isHorizontalResizing = false;
                
                // Vertical resizer (between proof panel and graph)
                verticalResizer.addEventListener('mousedown', function(e) {
                    isVerticalResizing = true;
                    document.addEventListener('mousemove', verticalResize);
                    document.addEventListener('mouseup', stopVerticalResize);
                    e.preventDefault();
                });
                
                function verticalResize(e) {
                    if (!isVerticalResizing) return;
                    
                    const containerHeight = leftPanel.offsetHeight;
                    const newHeight = e.clientY - leftPanel.offsetTop;
                    const minHeight = 100;
                    const maxHeight = containerHeight - 100;
                    
                    if (newHeight >= minHeight && newHeight <= maxHeight) {
                        proofPanel.style.height = newHeight + 'px';
                        graphContainer.style.height = (containerHeight - newHeight) + 'px';
                        network.fit();
                    }
                }
                
                function stopVerticalResize() {
                    isVerticalResizing = false;
                    document.removeEventListener('mousemove', verticalResize);
                    document.removeEventListener('mouseup', stopVerticalResize);
                }
                
                // Horizontal resizer (between left and right panels)
                horizontalResizer.addEventListener('mousedown', function(e) {
                    isHorizontalResizing = true;
                    document.addEventListener('mousemove', horizontalResize);
                    document.addEventListener('mouseup', stopHorizontalResize);
                    e.preventDefault();
                });
                
                function horizontalResize(e) {
                    if (!isHorizontalResizing) return;
                    
                    const containerWidth = document.querySelector('.container').offsetWidth;
                    const newWidth = e.clientX - leftPanel.offsetLeft;
                    const minWidth = 300;
                    const maxWidth = containerWidth - 300;
                    
                    if (newWidth >= minWidth && newWidth <= maxWidth) {
                        leftPanel.style.flex = 'none';
                        leftPanel.style.width = newWidth + 'px';
                        infoPanel.style.width = (containerWidth - newWidth) + 'px';
                        network.fit();
                    }
                }
                
                function stopHorizontalResize() {
                    isHorizontalResizing = false;
                    document.removeEventListener('mousemove', horizontalResize);
                    document.removeEventListener('mouseup', stopHorizontalResize);
                }
            }
            
            // Initialize resizable panels
            makeResizable();
        </script>
    </body>
    </html>
    