
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Proof Graph Visualization</title>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
        <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.css" rel="stylesheet" type="text/css" />
        <style>
            body {
                margin: 0;
                padding: 0;
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
                height: 100vh;
                overflow: hidden;
            }
            
            .container {
                display: flex;
                height: 100vh;
                background: #f0f0f0;
            }
            
            #left-panel {
                flex: 1;
                display: flex;
                flex-direction: column;
                background: white;
                border-right: 2px solid #ddd;
                height: 100vh;
                overflow: hidden;
            }
            
            #proof-str-panel {
                background: #f8f9fa;
                border-bottom: 2px solid #ddd;
                padding: 15px;
                height: 200px;
                overflow-y: auto;
                flex-shrink: 0;
            }
            
            #proof-str-title {
                font-weight: 600;
                color: #2d3748;
                margin-bottom: 10px;
                font-size: 14px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
            
            #proof-str-content {
                color: #4a5568;
                line-height: 1.6;
                white-space: pre-wrap;
                word-wrap: break-word;
                font-family: 'Monaco', 'Courier New', monospace;
                font-size: 13px;
                background: white;
                padding: 12px;
                border-radius: 4px;
                border: 1px solid #e2e8f0;
            }
            
            #graph-container {
                flex: 1;
                position: relative;
                background: white;
                min-height: 0;
                overflow: hidden;
            }
            
            #mynetwork {
                width: 100%;
                height: 100%;
            }
            
            #info-panel {
                width: 40%;
                max-width: 600px;
                background: white;
                overflow-y: auto;
                padding: 20px;
                box-shadow: -2px 0 10px rgba(0,0,0,0.1);
            }
            
            #info-panel.hidden {
                display: none;
            }
            
            .info-header {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                padding: 15px;
                border-radius: 8px;
                margin-bottom: 20px;
            }
            
            .info-header h2 {
                margin: 0;
                font-size: 24px;
            }
            
            .info-header .node-type {
                opacity: 0.9;
                font-size: 14px;
                margin-top: 5px;
            }
            
            .field-group {
                background: #f8f9fa;
                border-left: 4px solid #667eea;
                padding: 15px;
                margin-bottom: 15px;
                border-radius: 4px;
            }
            
            .field-name {
                font-weight: 600;
                color: #2d3748;
                margin-bottom: 8px;
                font-size: 14px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
            
            .field-value {
                color: #4a5568;
                line-height: 1.6;
                white-space: pre-wrap;
                word-wrap: break-word;
                font-family: 'Monaco', 'Courier New', monospace;
                font-size: 13px;
            }
            
            .field-value.code {
                color: #4a5568;
                padding: 12px;
                border-radius: 4px;
                overflow-x: auto;
            }
            
            .sub-dict {
                background: #ffffff;
                border: 1px solid #e2e8f0;
                border-radius: 4px;
                padding: 10px;
                margin: 8px 0;
                box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            }
            
            .sub-dict-title {
                font-weight: 600;
                color: #4a5568;
                margin-bottom: 8px;
                font-size: 12px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                border-bottom: 1px solid #e2e8f0;
                padding-bottom: 4px;
            }
            
            .sub-dict-content {
                color: #2d3748;
                line-height: 1.5;
                font-size: 12px;
            }
            
            .placeholder {
                text-align: center;
                color: #718096;
                padding: 40px;
                font-size: 18px;
            }
            
            .placeholder-icon {
                font-size: 48px;
                margin-bottom: 20px;
                opacity: 0.3;
            }
            
            #toggle-panel {
                position: absolute;
                right: 10px;
                top: 10px;
                z-index: 1000;
                background: #667eea;
                color: white;
                border: none;
                padding: 10px 20px;
                border-radius: 5px;
                cursor: pointer;
                font-size: 14px;
                transition: background 0.3s;
            }
            
            #toggle-panel:hover {
                background: #764ba2;
            }
            
            .legend {
                position: absolute;
                top: 20px;
                left: 20px;
                background: white;
                padding: 15px;
                border-radius: 8px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
                z-index: 100;
                max-width: 300px;
            }
            
            .legend-section {
                margin-bottom: 15px;
            }
            
            .legend-section:last-child {
                margin-bottom: 0;
            }
            
            .legend-title {
                font-weight: 600;
                font-size: 12px;
                color: #2d3748;
                margin-bottom: 8px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                border-bottom: 1px solid #e2e8f0;
                padding-bottom: 4px;
            }
            
            .legend-item {
                display: flex;
                align-items: center;
                margin-bottom: 8px;
            }
            
            .legend-item:last-child {
                margin-bottom: 0;
            }
            
            .legend-color {
                width: 20px;
                height: 20px;
                margin-right: 10px;
                border-radius: 3px;
            }
            
            .resizer {
                background: #ddd;
                cursor: col-resize;
                width: 4px;
                height: 100%;
                position: absolute;
                right: 0;
                top: 0;
                z-index: 1000;
            }
            
            .resizer:hover {
                background: #bbb;
            }
            
            .resizer-vertical {
                background: #ddd;
                cursor: row-resize;
                height: 4px;
                width: 100%;
                position: absolute;
                bottom: 0;
                left: 0;
                z-index: 1000;
            }
            
            .resizer-vertical:hover {
                background: #bbb;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div id="left-panel">
                <div id="proof-str-panel">
                    <div id="proof-str-title">Informal theorem and proof</div>
                    <div id="proof-str-content">Theorem: Let $f(x)$ be a polynomial function such that $f(x) = x^3 - 3x^2 + 2x$. If $g(x) = f'(x) - 1$, then $g(2) = -1$.

Proof: We have $f(x) = x^3 - 3x^2 + 2x$. Therefore, $f'(x) = 3x^2 - 6x + 2$. Let $g(x) = f'(x) - 3$. Then $g(2) = (3(2)^2 - 6(2) + 2) - 3 = (12 - 12 + 2) - 3 = 2 - 3 = -1$.
</div>
                    <div class="resizer-vertical" id="vertical-resizer"></div>
                </div>
                <div id="graph-container">
                    <button id="toggle-panel" onclick="togglePanel()">Toggle Info Panel</button>
                    <div class="legend">
                        <div class="legend-section">
                            <div class="legend-title">Node Types</div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #eba0a0;"></div>
                                <span>Theorem Conditions (tc)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #cfb795 ;"></div>
                                <span>Theorem Definitions (def)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #8dafcc;"></div>
                                <span>Lemmas (l)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #a3c2a8;"></div>
                                <span>Theorem Solutions (ts)</span>
                            </div>

                        </div>
                        <div class="legend-section">
                            <div class="legend-title">Verification Status</div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #fa2c07;"></div>
                                <span>Formalization failed</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #FFA500;"></div>
                                <span>Formalization passed</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #00ff00;"></div>
                                <span>Fully verified</span>
                            </div>
                        </div>
                    </div>
                    <div id="mynetwork"></div>
                </div>
            </div>
            
            <div class="resizer" id="horizontal-resizer"></div>
            
            <div id="info-panel">
                <div id="info-content">
                    <div class="placeholder">
                        <div class="placeholder-icon">ðŸ“Š</div>
                        <p>Click on a node to view its details</p>
                    </div>
                </div>
            </div>
        </div>
        
        <script type="text/javascript">
            // Store node information
            var nodeInfo = {"tc_1": {"id": "tc_1", "natural_language": "We have $f(x) = x^3 - 3x^2 + 2x$.", "statement": "Premise:\n\u2022 f is a real-valued polynomial function defined as f(x) = x\u00b3 - 3x\u00b2 + 2x [tc_1].", "dependencies": [], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem condition : \u2203 f : \u211d \u2192 \u211d, \u2200 x, f x = x^3 - 3*x^2 + 2*x := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {}, "score": {"semantic_score": 0.5, "semantic_feedback": ["The Lean formalization captures that f is real-valued (\u211d \u2192 \u211d) but doesn't explicitly state that f is polynomial. However, the polynomial nature is implicitly captured through the specific functional form, so this is a minor structural difference rather than a major logical gap.", "The mathematical expression and domain specification match perfectly between the natural language and Lean formalization."]}, "error_report": {"error_type": "Formalizer", "error_report": "Formalization is likely incorrect: semantic score is 0.5, below threshold 0.6.\nScorer feedback: [\"The Lean formalization captures that f is real-valued (\u211d \u2192 \u211d) but doesn't explicitly state that f is polynomial. However, the polynomial nature is implicitly captured through the specific functional form, so this is a minor structural difference rather than a major logical gap.\", 'The mathematical expression and domain specification match perfectly between the natural language and Lean formalization.']"}, "type": "condition"}, "l1": {"id": "l1", "natural_language": "Therefore, $f'(x) = 3x^2 - 6x + 2$.", "statement": "We assume:\n\u2022 f is a real-valued polynomial function defined as f(x) = x\u00b3 - 3x\u00b2 + 2x [tc_1].\nTherefore, we conclude:\n\u2022 The derivative of f is f'(x) = 3x\u00b2 - 6x + 2 [l1].", "dependencies": ["tc_1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l1\n  (f : \u211d \u2192 \u211d)\n  (hf : \u2200 x, f x = x^3 - 3*x^2 + 2*x) :\n  \u2200 x, deriv f x = 3*x^2 - 6*x + 2 := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l1\n  (f : \u211d \u2192 \u211d)\n  (hf : \u2200 x, f x = x^3 - 3*x^2 + 2*x) :\n  \u2200 x, deriv f x = 3*x^2 - 6*x + 2 := by\n  have h_main : \u2200 (x : \u211d), deriv f x = 3*x^2 - 6*x + 2 := by\n    intro x\n    have h\u2081 : HasDerivAt f (3 * x ^ 2 - 6 * x + 2) x := by\n      -- Prove that f has the derivative 3x\u00b2 - 6x + 2 at x\n      have h\u2082 : HasDerivAt (fun x : \u211d => x ^ 3 - 3 * x ^ 2 + 2 * x) (3 * x ^ 2 - 6 * x + 2) x := by\n        -- Differentiate each term separately\n        have h\u2083 : HasDerivAt (fun x : \u211d => x ^ 3) (3 * x ^ 2) x := by\n          simpa using (hasDerivAt_pow 3 x)\n        have h\u2084 : HasDerivAt (fun x : \u211d => (3 : \u211d) * x ^ 2) (6 * x) x := by\n          have h\u2085 : HasDerivAt (fun x : \u211d => x ^ 2) (2 * x) x := by\n            simpa using (hasDerivAt_pow 2 x)\n          convert HasDerivAt.const_mul (3 : \u211d) h\u2085 using 1 <;> ring\n        have h\u2086 : HasDerivAt (fun x : \u211d => (2 : \u211d) * x) (2 : \u211d) x := by\n          simpa using (hasDerivAt_id x).const_mul (2 : \u211d)\n        -- Combine the derivatives using subtraction and addition\n        have h\u2087 : HasDerivAt (fun x : \u211d => x ^ 3 - 3 * x ^ 2) (3 * x ^ 2 - 6 * x) x := by\n          have h\u2088 : HasDerivAt (fun x : \u211d => (3 : \u211d) * x ^ 2) (6 * x) x := h\u2084\n          have h\u2089 : HasDerivAt (fun x : \u211d => x ^ 3) (3 * x ^ 2) x := h\u2083\n          have h\u2081\u2080 : HasDerivAt (fun x : \u211d => x ^ 3 - 3 * x ^ 2) (3 * x ^ 2 - 6 * x) x := by\n            convert h\u2089.sub h\u2088 using 1 <;> ring\n          exact h\u2081\u2080\n        have h\u2081\u2081 : HasDerivAt (fun x : \u211d => x ^ 3 - 3 * x ^ 2 + 2 * x) (3 * x ^ 2 - 6 * x + 2) x := by\n          have h\u2081\u2082 : HasDerivAt (fun x : \u211d => (2 : \u211d) * x) (2 : \u211d) x := h\u2086\n          have h\u2081\u2083 : HasDerivAt (fun x : \u211d => x ^ 3 - 3 * x ^ 2) (3 * x ^ 2 - 6 * x) x := h\u2087\n          convert h\u2081\u2083.add h\u2081\u2082 using 1 <;> ring\n        exact h\u2081\u2081\n      -- Use the fact that f(x) = x\u00b3 - 3x\u00b2 + 2x to conclude the derivative of f\n      have h\u2081\u2084 : f = (fun x : \u211d => x ^ 3 - 3 * x ^ 2 + 2 * x) := by\n        funext x\n        rw [hf]\n      rw [h\u2081\u2084]\n      exact h\u2082\n    -- Use the uniqueness of the derivative to get deriv f x = 3x\u00b2 - 6x + 2\n    have h\u2081\u2085 : deriv f x = 3 * x ^ 2 - 6 * x + 2 := by\n      apply HasDerivAt.deriv\n      exact h\u2081\n    exact h\u2081\u2085\n  exact h_main", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The Lean formalization correctly captures the polynomial function definition and its derivative. The use of universal quantification (\u2200 x) properly formalizes the function definitions, and the mathematical expressions are identical. The logical structure from premise to conclusion is preserved accurately."]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "lemma"}, "def_1": {"id": "def_1", "natural_language": "Let $g(x) = f'(x) - 3$.", "statement": "Definition:\n\u2022 g is a real-valued function defined by the proof as g(x) = f'(x) - 3 [def_1].", "dependencies": [], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem def_1 : \n  let f : \u211d \u2192 \u211d := fun x => x^3 - 3*x^2 + 2*x\n  let g : \u211d \u2192 \u211d := fun x => (deriv f) x - 3\n  g 2 = -1 := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {}, "score": {"semantic_score": 0.0, "semantic_feedback": ["The natural language states that f'(x) exists (f is differentiable) as a general condition, but the Lean code defines a specific polynomial function f(x) = x\u00b3 - 3x\u00b2 + 2x. While this specific function is indeed differentiable, the Lean formalization is more restrictive than the general statement in natural language.", "Both the natural language and Lean code establish g as a real-valued function, which matches perfectly.", "The natural language concludes with the definition g(x) = f'(x) - 3, but the Lean code concludes with a specific numerical evaluation g(2) = -1. The Lean code does contain the definition in the let statement, but the theorem's conclusion is about a specific value rather than the general definition relationship."]}, "error_report": {"error_type": "Formalizer", "error_report": "Formalization is likely incorrect: semantic score is 0.0, below threshold 0.6.\nScorer feedback: [\"The natural language states that f'(x) exists (f is differentiable) as a general condition, but the Lean code defines a specific polynomial function f(x) = x\u00b3 - 3x\u00b2 + 2x. While this specific function is indeed differentiable, the Lean formalization is more restrictive than the general statement in natural language.\", 'Both the natural language and Lean code establish g as a real-valued function, which matches perfectly.', \"The natural language concludes with the definition g(x) = f'(x) - 3, but the Lean code concludes with a specific numerical evaluation g(2) = -1. The Lean code does contain the definition in the let statement, but the theorem's conclusion is about a specific value rather than the general definition relationship.\"]"}, "type": "definition"}, "l2": {"id": "l2", "natural_language": "Then $g(2) = (3(2)^2 - 6(2) + 2) - 3$", "statement": "We assume:\n\u2022 The derivative of f is f'(x) = 3x\u00b2 - 6x + 2 [l1].\n\u2022 g is a real-valued function defined by g(x) = f'(x) - 3 [def_1].\nTherefore, we conclude:\n\u2022 The value of g at x=2 is g(2) = (3(2)\u00b2 - 6(2) + 2) - 3 [l2].", "dependencies": ["l1", "def_1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l2\n  (f : \u211d \u2192 \u211d)\n  (hf : \u2200 x, f x = x^3 - 3*x^2 + 2*x)\n  (l1 : \u2200 x, deriv f x = 3*x^2 - 6*x + 2) :\n  let g : \u211d \u2192 \u211d := fun x => (deriv f) x - 3\n  g 2 = -1 := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l2\n  (f : \u211d \u2192 \u211d)\n  (hf : \u2200 x, f x = x^3 - 3*x^2 + 2*x)\n  (l1 : \u2200 x, deriv f x = 3*x^2 - 6*x + 2) :\n  let g : \u211d \u2192 \u211d := fun x => (deriv f) x - 3\n  g 2 = -1 := by\n  intro g\n  have h_deriv_f_2 : deriv f 2 = 2 := by\n    have h\u2081 : deriv f 2 = 3 * (2 : \u211d) ^ 2 - 6 * (2 : \u211d) + 2 := by\n      apply l1\n    rw [h\u2081]\n    norm_num\n  \n  have h_g_2 : g 2 = -1 := by\n    dsimp only [g] at *\n    rw [h_deriv_f_2]\n    <;> norm_num\n  \n  exact h_g_2", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The derivative assumption l1 is correctly formalized using universal quantification over real numbers.", "The definition of function g is accurately captured with proper type annotation and the exact mathematical relationship g(x) = f'(x) - 3.", "The conclusion about g(2) is mathematically equivalent - the Lean shows the computed result (-1) while natural language shows the calculation steps, both representing the same mathematical fact.", "The additional hypothesis defining f(x) is not mentioned in natural language but is logically consistent and helpful context that doesn't contradict anything stated."]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "lemma"}, "ts_1": {"id": "ts_1", "natural_language": "= (12 - 12 + 2) - 3 = 2 - 3 = -1.", "statement": "We assume:\n\u2022 The value of g at x=2 is g(2) = (3(2)\u00b2 - 6(2) + 2) - 3 [l2].\nTherefore, we conclude:\n\u2022 g(2) = -1 [ts_1].", "dependencies": ["l2"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem ts_1\n  (g : \u211d \u2192 \u211d)\n  (h : g 2 = (3 * 2^2 - 6 * 2 + 2) - 3) :\n  g 2 = -1 := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem ts_1\n  (g : \u211d \u2192 \u211d)\n  (h : g 2 = (3 * 2^2 - 6 * 2 + 2) - 3) :\n  g 2 = -1 := by\n  have h\u2081 : g 2 = -1 := by\n    norm_num at h \u22a2\n    <;>\n    (try linarith) <;>\n    (try assumption) <;>\n    (try simp_all) <;>\n    (try ring_nf at * <;> linarith)\n    <;>\n    (try nlinarith)\n    <;>\n    (try\n      {\n        norm_num at h \u22a2\n        <;>\n        linarith\n      })\n    <;>\n    (try\n      {\n        simp_all [h]\n        <;>\n        norm_num\n        <;>\n        linarith\n      })\n    <;>\n    (try\n      {\n        linarith\n      })\n    <;>\n    (try\n      {\n        norm_num at h \u22a2\n        <;>\n        linarith\n      })\n    <;>\n    (try\n      {\n        simp_all [h]\n        <;>\n        norm_num\n        <;>\n        linarith\n      })\n    <;>\n    (try\n      {\n        linarith\n      })\n  \n  exact h\u2081", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The Lean formalization perfectly captures the natural language statement. The premise that g(2) equals the given expression is correctly represented as hypothesis h, and the conclusion that g(2) = -1 is properly stated as the theorem goal. The mathematical expression is accurately translated from natural language notation to Lean syntax, and the logical structure (premise implies conclusion) is correctly formalized."]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "solution"}};
            
            // Create nodes and edges
            var nodes = new vis.DataSet([{"id": "tc_1", "label": "tc_1", "color": {"background": "#eba0a0", "border": "#00ff00", "highlight": {"background": "#eba0a0", "border": "#00ff00"}}, "shape": "box", "size": 30, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l1", "label": "l1", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "def_1", "label": "def_1", "color": {"background": "#cfb795", "border": "#00ff00", "highlight": {"background": "#cfb795", "border": "#00ff00"}}, "shape": "box", "size": 30, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l2", "label": "l2", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "ts_1", "label": "ts_1", "color": {"background": "#a3c2a8", "border": "#00ff00", "highlight": {"background": "#a3c2a8", "border": "#00ff00"}}, "shape": "star", "size": 40, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}]);
            var edges = new vis.DataSet([{"from": "tc_1", "to": "l1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "l2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_1", "to": "l2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l2", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}]);
            
            // Create network
            var container = document.getElementById('mynetwork');
            var data = {
                nodes: nodes,
                edges: edges
            };
            
            var options = {
                physics: {
                    enabled: true,
                    solver: 'hierarchicalRepulsion',
                    hierarchicalRepulsion: {
                        centralGravity: 0.0,
                        springLength: 200,
                        springConstant: 0.01,
                        nodeDistance: 150,
                        damping: 0.09
                    }
                },
                edges: {
                    smooth: {
                        type: 'continuous',
                        forceDirection: 'none'
                    },
                    color: {
                        color: '#666666',
                        highlight: '#666666',
                        hover: '#666666'
                    },
                    width: 2
                },
                interaction: {
                    hover: true,
                    tooltipDelay: 100,
                    navigationButtons: true,
                    keyboard: true
                },
                nodes: {
                    font: {
                        size: 14,
                        color: '#000000'
                    },
                    labelHighlightBold: false,
                    chosen: false,
                    shapeProperties: {
                        useBorderWithImage: false
                    },
                    scaling: {
                        label: {
                            enabled: true,
                            min: 8,
                            max: 20,
                            maxVisible: 20,
                            drawThreshold: 5
                        }
                    }
                }
            };
            
            var network = new vis.Network(container, data, options);
            
            // Format field value for display
            function formatFieldValue(value, fieldName) {
                if (value === null || value === undefined) {
                    return 'N/A';
                }
                
                // Handle objects (dictionaries) as sub-boxes
                if (typeof value === 'object' && !Array.isArray(value)) {
                    var html = '';
                    for (var key in value) {
                        if (value.hasOwnProperty(key)) {
                            var subValue = value[key];
                            var subValueStr = '';
                            
                            if (typeof subValue === 'object' &&
                                    !Array.isArray(subValue)) {
                                // Nested object - show as JSON
                                subValueStr = JSON.stringify(subValue, null, 2);
                            } else if (Array.isArray(subValue)) {
                                // Array - show as JSON
                                subValueStr = JSON.stringify(subValue, null, 2);
                            } else {
                                // Primitive value
                                subValueStr = String(subValue);
                            }
                            
                            // Replace escaped newlines and tabs with actual characters
                            subValueStr = subValueStr.replace(/\\n/g, '\n');
                            subValueStr = subValueStr.replace(/\\t/g, '\t');
                            subValueStr = subValueStr.replace(/\t/g, '\t');
                            
                            html += '<div class="sub-dict">';
                            html += '<div class="sub-dict-title">' + key + '</div>';
                            html += '<div class="sub-dict-content">' + subValueStr + '</div>';
                            html += '</div>';
                        }
                    }
                    return html;
                }
                
                // Convert to string for primitive values and arrays
                var strValue = String(value);
                
                // Handle arrays
                if (Array.isArray(value)) {
                    strValue = JSON.stringify(value, null, 2);
                }
                
                // Replace escaped newlines and tabs with actual characters
                strValue = strValue.replace(/\\n/g, '\n');
                strValue = strValue.replace(/\\t/g, '\t');
                strValue = strValue.replace(/\t/g, '\t');
                
                return strValue;
            }
            
            // Handle node click events
            network.on("click", function(params) {
                if (params.nodes.length > 0) {
                    var nodeId = params.nodes[0];
                    var info = nodeInfo[nodeId];
                    
                    if (info) {
                        var html = '<div class="info-header">';
                        html += '<h2>' + nodeId + '</h2>';
                        var nodeType = info.type || 'unknown';
                        var capitalizedType = nodeType.charAt(0).toUpperCase() +
                            nodeType.slice(1);
                        html += '<div class="node-type">Type: ' + capitalizedType +
                            '</div>';
                        html += '</div>';
                        
                        // Add all fields
                        for (var key in info) {
                            if (key === 'type' || key === 'id') continue;
                            
                            var fieldName = key.replace(/_/g, ' ')
                                .replace(/\b\w/g, function(l) {
                                    return l.toUpperCase();
                                });
                            var fieldValue = formatFieldValue(info[key], fieldName);
                            
                            if (fieldValue && fieldValue !== 'N/A') {
                                // Special formatting for code fields
                                var isCode = key.includes('code') ||
                                    key.includes('lean') ||
                                    key.includes('statement');
                                
                                html += '<div class="field-group">';
                                html += '<div class="field-name">' + fieldName +
                                    '</div>';
                                html += '<div class="field-value' +
                                    (isCode ? ' code' : '') + '">' +
                                    fieldValue + '</div>';
                                html += '</div>';
                            }
                        }
                        
                        document.getElementById('info-content')
                            .innerHTML = html;
                    }
                }
            });
            
            // Toggle panel function
            function togglePanel() {
                var panel = document.getElementById('info-panel');
                panel.classList.toggle('hidden');
                
                // Resize network when panel is toggled
                setTimeout(function() {
                    network.fit();
                }, 300);
            }
            
            // Initial network fit
            network.once('stabilized', function() {
                network.fit();
            });
            
            // Resizable panels functionality
            function makeResizable() {
                const verticalResizer = document.getElementById('vertical-resizer');
                const horizontalResizer = document.getElementById('horizontal-resizer');
                const proofPanel = document.getElementById('proof-str-panel');
                const graphContainer = document.getElementById('graph-container');
                const infoPanel = document.getElementById('info-panel');
                const leftPanel = document.getElementById('left-panel');
                
                let isVerticalResizing = false;
                let isHorizontalResizing = false;
                
                // Vertical resizer (between proof panel and graph)
                verticalResizer.addEventListener('mousedown', function(e) {
                    isVerticalResizing = true;
                    document.addEventListener('mousemove', verticalResize);
                    document.addEventListener('mouseup', stopVerticalResize);
                    e.preventDefault();
                });
                
                function verticalResize(e) {
                    if (!isVerticalResizing) return;
                    
                    const containerHeight = leftPanel.offsetHeight;
                    const newHeight = e.clientY - leftPanel.offsetTop;
                    const minHeight = 100;
                    const maxHeight = containerHeight - 100;
                    
                    if (newHeight >= minHeight && newHeight <= maxHeight) {
                        proofPanel.style.height = newHeight + 'px';
                        graphContainer.style.height = (containerHeight - newHeight) + 'px';
                        network.fit();
                    }
                }
                
                function stopVerticalResize() {
                    isVerticalResizing = false;
                    document.removeEventListener('mousemove', verticalResize);
                    document.removeEventListener('mouseup', stopVerticalResize);
                }
                
                // Horizontal resizer (between left and right panels)
                horizontalResizer.addEventListener('mousedown', function(e) {
                    isHorizontalResizing = true;
                    document.addEventListener('mousemove', horizontalResize);
                    document.addEventListener('mouseup', stopHorizontalResize);
                    e.preventDefault();
                });
                
                function horizontalResize(e) {
                    if (!isHorizontalResizing) return;
                    
                    const containerWidth = document.querySelector('.container').offsetWidth;
                    const newWidth = e.clientX - leftPanel.offsetLeft;
                    const minWidth = 300;
                    const maxWidth = containerWidth - 300;
                    
                    if (newWidth >= minWidth && newWidth <= maxWidth) {
                        leftPanel.style.flex = 'none';
                        leftPanel.style.width = newWidth + 'px';
                        infoPanel.style.width = (containerWidth - newWidth) + 'px';
                        network.fit();
                    }
                }
                
                function stopHorizontalResize() {
                    isHorizontalResizing = false;
                    document.removeEventListener('mousemove', horizontalResize);
                    document.removeEventListener('mouseup', stopHorizontalResize);
                }
            }
            
            // Initialize resizable panels
            makeResizable();
        </script>
    </body>
    </html>
    