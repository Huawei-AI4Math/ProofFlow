
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Proof Graph Visualization</title>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
        <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.css" rel="stylesheet" type="text/css" />
        <style>
            body {
                margin: 0;
                padding: 0;
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
                height: 100vh;
                overflow: hidden;
            }
            
            .container {
                display: flex;
                height: 100vh;
                background: #f0f0f0;
            }
            
            #left-panel {
                flex: 1;
                display: flex;
                flex-direction: column;
                background: white;
                border-right: 2px solid #ddd;
                height: 100vh;
                overflow: hidden;
            }
            
            #proof-str-panel {
                background: #f8f9fa;
                border-bottom: 2px solid #ddd;
                padding: 15px;
                height: 200px;
                overflow-y: auto;
                flex-shrink: 0;
            }
            
            #proof-str-title {
                font-weight: 600;
                color: #2d3748;
                margin-bottom: 10px;
                font-size: 14px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
            
            #proof-str-content {
                color: #4a5568;
                line-height: 1.6;
                white-space: pre-wrap;
                word-wrap: break-word;
                font-family: 'Monaco', 'Courier New', monospace;
                font-size: 13px;
                background: white;
                padding: 12px;
                border-radius: 4px;
                border: 1px solid #e2e8f0;
            }
            
            #graph-container {
                flex: 1;
                position: relative;
                background: white;
                min-height: 0;
                overflow: hidden;
            }
            
            #mynetwork {
                width: 100%;
                height: 100%;
            }
            
            #info-panel {
                width: 40%;
                max-width: 600px;
                background: white;
                overflow-y: auto;
                padding: 20px;
                box-shadow: -2px 0 10px rgba(0,0,0,0.1);
            }
            
            #info-panel.hidden {
                display: none;
            }
            
            .info-header {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                padding: 15px;
                border-radius: 8px;
                margin-bottom: 20px;
            }
            
            .info-header h2 {
                margin: 0;
                font-size: 24px;
            }
            
            .info-header .node-type {
                opacity: 0.9;
                font-size: 14px;
                margin-top: 5px;
            }
            
            .field-group {
                background: #f8f9fa;
                border-left: 4px solid #667eea;
                padding: 15px;
                margin-bottom: 15px;
                border-radius: 4px;
            }
            
            .field-name {
                font-weight: 600;
                color: #2d3748;
                margin-bottom: 8px;
                font-size: 14px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
            
            .field-value {
                color: #4a5568;
                line-height: 1.6;
                white-space: pre-wrap;
                word-wrap: break-word;
                font-family: 'Monaco', 'Courier New', monospace;
                font-size: 13px;
            }
            
            .field-value.code {
                color: #4a5568;
                padding: 12px;
                border-radius: 4px;
                overflow-x: auto;
            }
            
            .sub-dict {
                background: #ffffff;
                border: 1px solid #e2e8f0;
                border-radius: 4px;
                padding: 10px;
                margin: 8px 0;
                box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            }
            
            .sub-dict-title {
                font-weight: 600;
                color: #4a5568;
                margin-bottom: 8px;
                font-size: 12px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                border-bottom: 1px solid #e2e8f0;
                padding-bottom: 4px;
            }
            
            .sub-dict-content {
                color: #2d3748;
                line-height: 1.5;
                font-size: 12px;
            }
            
            .placeholder {
                text-align: center;
                color: #718096;
                padding: 40px;
                font-size: 18px;
            }
            
            .placeholder-icon {
                font-size: 48px;
                margin-bottom: 20px;
                opacity: 0.3;
            }
            
            #toggle-panel {
                position: absolute;
                right: 10px;
                top: 10px;
                z-index: 1000;
                background: #667eea;
                color: white;
                border: none;
                padding: 10px 20px;
                border-radius: 5px;
                cursor: pointer;
                font-size: 14px;
                transition: background 0.3s;
            }
            
            #toggle-panel:hover {
                background: #764ba2;
            }
            
            .legend {
                position: absolute;
                top: 20px;
                left: 20px;
                background: white;
                padding: 15px;
                border-radius: 8px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
                z-index: 100;
                max-width: 300px;
            }
            
            .legend-section {
                margin-bottom: 15px;
            }
            
            .legend-section:last-child {
                margin-bottom: 0;
            }
            
            .legend-title {
                font-weight: 600;
                font-size: 12px;
                color: #2d3748;
                margin-bottom: 8px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                border-bottom: 1px solid #e2e8f0;
                padding-bottom: 4px;
            }
            
            .legend-item {
                display: flex;
                align-items: center;
                margin-bottom: 8px;
            }
            
            .legend-item:last-child {
                margin-bottom: 0;
            }
            
            .legend-color {
                width: 20px;
                height: 20px;
                margin-right: 10px;
                border-radius: 3px;
            }
            
            .resizer {
                background: #ddd;
                cursor: col-resize;
                width: 4px;
                height: 100%;
                position: absolute;
                right: 0;
                top: 0;
                z-index: 1000;
            }
            
            .resizer:hover {
                background: #bbb;
            }
            
            .resizer-vertical {
                background: #ddd;
                cursor: row-resize;
                height: 4px;
                width: 100%;
                position: absolute;
                bottom: 0;
                left: 0;
                z-index: 1000;
            }
            
            .resizer-vertical:hover {
                background: #bbb;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div id="left-panel">
                <div id="proof-str-panel">
                    <div id="proof-str-title">Informal theorem and proof</div>
                    <div id="proof-str-content">Theorem: For any integer~$a$,
$$
\sum_{n=0}^{p-1} \zeta^{an} = \begin{cases}
        p & 	ext{\rm if $a \con 0\pmod{p}$,}\\
        0 & 	ext{\rm otherwise.}  \end{cases}
$$

Proof: If $a\con 0\pmod{p}$, then $\zeta^a=1$, so the sum equals the number of summands,
which is~$p$.  If $a
ot\con 0\pmod{p}$, then we use the
identity $$x^p - 1 = (x-1)(x^{p-1} + \cdots + x + 1)$$ with $x = \zeta^a$. We have
 $\zeta^a
eq 1$, so $\zeta^a - 1 
eq 0$ and
$$
\sum_{n=0}^{p-1} \zeta^{an} = \frac{\zeta^{ap}-1}{\zeta^a-1} =
\frac{1-1}{\zeta^a-1} = 0.
$$
</div>
                    <div class="resizer-vertical" id="vertical-resizer"></div>
                </div>
                <div id="graph-container">
                    <button id="toggle-panel" onclick="togglePanel()">Toggle Info Panel</button>
                    <div class="legend">
                        <div class="legend-section">
                            <div class="legend-title">Node Types</div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #eba0a0;"></div>
                                <span>Theorem Conditions (tc)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #cfb795 ;"></div>
                                <span>Theorem Definitions (def)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #8dafcc;"></div>
                                <span>Lemmas (l)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #a3c2a8;"></div>
                                <span>Theorem Solutions (ts)</span>
                            </div>

                        </div>
                        <div class="legend-section">
                            <div class="legend-title">Verification Status</div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #fa2c07;"></div>
                                <span>Formalization failed</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #FFA500;"></div>
                                <span>Formalization passed</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #00ff00;"></div>
                                <span>Fully verified</span>
                            </div>
                        </div>
                    </div>
                    <div id="mynetwork"></div>
                </div>
            </div>
            
            <div class="resizer" id="horizontal-resizer"></div>
            
            <div id="info-panel">
                <div id="info-content">
                    <div class="placeholder">
                        <div class="placeholder-icon">📊</div>
                        <p>Click on a node to view its details</p>
                    </div>
                </div>
            </div>
        </div>
        
        <script type="text/javascript">
            // Store node information
            var nodeInfo = {"tc_1": {"id": "tc_1", "natural_language": "For any integer~$a$,\n$$\n\\sum_{n=0}^{p-1} \\zeta^{an}\n$$", "statement": "Premise:\n\u2022 p is a prime number\n\u2022 \u03b6 = e^(2\u03c0i/p) is a primitive p-th root of unity\n\u2022 a is an integer [tc_1].", "dependencies": [], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nvariable\n  (p : \u2115)\n  (hp : Nat.Prime p)\n  (\u03b6 : \u2102)\n  (h\u03b6 : IsPrimitiveRoot \u03b6 p)\n  (a : \u2124)", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The Lean formalization correctly captures that p is a prime number using Nat.Prime p", "The Lean formalization uses IsPrimitiveRoot \u03b6 p which correctly captures the mathematical property of being a primitive p-th root of unity, even though it doesn't explicitly show the exponential form e^(2\u03c0i/p)", "Both versions state that a is an integer - perfect match"]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "type": "condition"}, "tc_2": {"id": "tc_2", "natural_language": "If $a\\con 0\\pmod{p}$", "statement": "Premise:\n\u2022 p is a prime number, \u03b6 is a primitive p-th root of unity, and a is an integer [tc_1]\n\u2022 a \u2261 0 (mod p) [tc_2].", "dependencies": ["tc_1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nvariable\n  (p : \u2115)\n  (hp : Nat.Prime p)\n  (\u03b6 : \u2102)\n  (h\u03b6 : IsPrimitiveRoot \u03b6 p)\n  (a : \u2124)\n  (tc_2 : a \u2261 0 [ZMOD p])", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The Lean formalization correctly captures that p is prime. The additional constraint that p is a natural number is mathematically appropriate since primes are conventionally natural numbers.", "The Lean formalization perfectly matches the mathematical concept of \u03b6 being a primitive p-th root of unity.", "The Lean formalization perfectly matches the condition that a is an integer.", "The Lean formalization perfectly captures the modular arithmetic condition, just using Lean's notation [ZMOD p] instead of mathematical notation (mod p)."]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "type": "condition"}, "l1": {"id": "l1", "natural_language": "then $\\zeta^a=1$", "statement": "We assume:\n\u2022 p is a prime number, \u03b6 is a primitive p-th root of unity, and a is an integer [tc_1]\n\u2022 a \u2261 0 (mod p) [tc_2]\nTherefore, we conclude:\n\u2022 \u03b6^a = 1 [l1].", "dependencies": ["tc_1", "tc_2"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l1\n  (p : \u2115) (hp : Nat.Prime p) (\u03b6 : \u2102) (h\u03b6 : IsPrimitiveRoot \u03b6 p) (a : \u2124)\n  (tc_2 : a \u2261 0 [ZMOD p]) :\n  \u03b6 ^ a = 1 := by\nsorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l1\n  (p : \u2115) (hp : Nat.Prime p) (\u03b6 : \u2102) (h\u03b6 : IsPrimitiveRoot \u03b6 p) (a : \u2124)\n  (tc_2 : \u2191p \u2223 a) :\n  \u03b6 ^ a = 1 := by\n  rw [IsPrimitiveRoot.zpow_eq_one_iff_dvd h\u03b6]\n  exact tc_2", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 4}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The Lean formalization correctly captures all mathematical content from the natural language. The prime number p, primitive p-th root of unity \u03b6, integer a, modular congruence condition a \u2261 0 (mod p), and the conclusion \u03b6^a = 1 are all properly formalized. The logical structure of assumptions leading to a conclusion is preserved. The only minor difference is that the natural language reference '[tc_1]' doesn't have a direct correspondence in the Lean code, but this is just a labeling matter that doesn't affect the mathematical meaning."]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "lemma"}, "l2": {"id": "l2", "natural_language": "so the sum equals the number of summands,", "statement": "We assume:\n\u2022 \u03b6^a = 1 [l1]\nTherefore, we conclude:\n\u2022 \u2211_{n=0}^{p-1} \u03b6^(an) = \u2211_{n=0}^{p-1} 1 [l2].", "dependencies": ["l1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l2\n  (p : \u2115) (hp : Nat.Prime p) (\u03b6 : \u2102) (h\u03b6 : IsPrimitiveRoot \u03b6 p) (a : \u2124)\n  (l1 : \u03b6 ^ a = 1) :\n  \u2211 n in Finset.range p, \u03b6 ^ (a * n) = \u2211 n in Finset.range p, 1 := by\nsorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l2\n  (p : \u2115) (hp : Nat.Prime p) (\u03b6 : \u2102) (h\u03b6 : IsPrimitiveRoot \u03b6 p) (a : \u2124)\n  (l1 : \u03b6 ^ a = 1) :\n  \u2211 n in Finset.range p, \u03b6 ^ (a * n) = \u2211 n in Finset.range p, 1 := by\n  simp_rw [\u2190 pow_mul, l1, one_pow]", "lean_pass": false, "lean_verify": false, "error_msg": [{"line": 9, "column": 11, "endLine": 9, "endColumn": 20, "data": "simp made no progress"}], "tries": 5}, "score": {"semantic_score": 0, "semantic_feedback": ["The assumption \u03b6^a = 1 is correctly captured as hypothesis l1 in the Lean formalization.", "The summation equality is perfectly translated, with proper indexing from 0 to p-1 using Finset.range p and correct exponentiation \u03b6^(a*n).", "The additional type declarations and mathematical context (prime p, primitive root \u03b6, integer a) are reasonable implicit assumptions that enhance the formalization without contradicting the natural language.", "The logical flow from assumption to conclusion is properly structured as a lemma with hypothesis leading to the goal statement.", "The tactics contained syntactic mistakes, so final score is 0."]}, "error_report": {"error_type": "Prover", "error_report": "Formalization appears correct (score=1.0 > 0.6), but the prover could neither prove the lemma nor its negation. This may be due to prover limitations, missing lemmas, or incomplete context."}, "solved_negation": {"lean_verify": false, "lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter Complex\n\nlemma neg_l2\n  (p : \u2115) (hp : Nat.Prime p) (\u03b6 : \u2102) (h\u03b6 : IsPrimitiveRoot \u03b6 p) (a : \u2124)\n  (l1 : \u03b6 ^ a = 1) :\n  \u00ac (\u2211 n in Finset.range p, \u03b6 ^ (a * n) = \u2211 n in Finset.range p, 1) := by\n  intro h\n  have h1 : \u2211 n in Finset.range p, \u03b6 ^ (a * n) = p := by\n    rw [h]\n    simp\n  have h2 : \u2211 n in Finset.range p, \u03b6 ^ (a * n) = if a % p = 0 then p else 0 := by\n    exact IsPrimitiveRoot.sum_pow h\u03b6 hp.pos\n  rw [h1] at h2\n  by_cases ha : a % p = 0\n  \u00b7 simp [ha] at h2\n  \u00b7 simp [ha] at h2\n    exact Nat.Prime.ne_zero hp h2"}, "type": "lemma"}, "ts_1": {"id": "ts_1", "natural_language": "which is~$p$.", "statement": "We assume:\n\u2022 \u2211_{n=0}^{p-1} \u03b6^(an) = \u2211_{n=0}^{p-1} 1 [l2]\nTherefore, we conclude:\n\u2022 \u2211_{n=0}^{p-1} \u03b6^(an) = p [ts_1].", "dependencies": ["l2"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma ts_1\n  (p : \u2115) (hp : Nat.Prime p) (\u03b6 : \u2102) (a : \u2124)\n  (l2 : \u2211 n in Finset.range p, \u03b6 ^ (a * n) = \u2211 n in Finset.range p, 1) :\n  \u2211 n in Finset.range p, \u03b6 ^ (a * n) = p := by\nsorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma ts_1\n  (p : \u2115) (hp : Nat.Prime p) (\u03b6 : \u2102) (a : \u2124)\n  (l2 : \u2211 n in Finset.range p, \u03b6 ^ (a * n) = \u2211 n in Finset.range p, 1) :\n  \u2211 n in Finset.range p, \u03b6 ^ (a * n) = p := by\n  rw [l2]\n  simp [Finset.sum_const, Finset.card_range, smul_eq_mul, mul_one]", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 4}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The Lean formalization correctly captures all the mathematical content and logical structure from the natural language. The summation notation, variable relationships, assumption l2, and conclusion ts_1 are all properly translated. The additional type constraints (like hp : Nat.Prime p) are reasonable mathematical assumptions that don't contradict the natural language statement. The logical flow from assumption to conclusion is preserved accurately."]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "solution"}, "tc_3": {"id": "tc_3", "natural_language": "If $a\\not\\con 0\\pmod{p}$", "statement": "Premise:\n\u2022 p is a prime number, \u03b6 is a primitive p-th root of unity, and a is an integer [tc_1]\n\u2022 a \u2262 0 (mod p) [tc_3].", "dependencies": ["tc_1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nvariable\n  (p : \u2115)\n  (hp : Nat.Prime p)\n  (\u03b6 : \u2102)\n  (h\u03b6 : IsPrimitiveRoot \u03b6 p)\n  (a : \u2124)\n  (tc_3 : a % p \u2260 0)", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {}, "score": {"semantic_score": 0.75, "semantic_feedback": ["The natural language states 'p is a prime number' without specifying the type, while Lean specifies 'Nat.Prime p' indicating p is a natural number. This is a reasonable mathematical assumption since primes are typically natural numbers, but it adds a type constraint not explicitly stated.", "Direct correspondence between '\u03b6 is a primitive p-th root of unity' and 'IsPrimitiveRoot \u03b6 p'.", "Direct correspondence between 'a is an integer' and 'a : \u2124'.", "Mathematical equivalence between 'a \u2262 0 (mod p)' and 'a % p \u2260 0' - both express that a is not congruent to 0 modulo p."]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "type": "condition"}, "l3": {"id": "l3", "natural_language": "We have $\\zeta^a\\neq 1$", "statement": "We assume:\n\u2022 p is a prime number, \u03b6 is a primitive p-th root of unity, and a is an integer [tc_1]\n\u2022 a \u2262 0 (mod p) [tc_3]\nTherefore, we conclude:\n\u2022 \u03b6^a \u2260 1 [l3].", "dependencies": ["tc_1", "tc_3"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l3\n  (p : \u2115) (hp : Nat.Prime p) (\u03b6 : \u2102) (h\u03b6 : IsPrimitiveRoot \u03b6 p) (a : \u2124)\n  (tc_1 : Nat.Prime p \u2227 IsPrimitiveRoot \u03b6 p \u2227 True)\n  (tc_3 : a % p \u2260 0) :\n  \u03b6^a \u2260 1 := by\nsorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l3\n  (p : \u2115) (hp : Nat.Prime p) (\u03b6 : \u2102) (h\u03b6 : IsPrimitiveRoot \u03b6 p) (a : \u2124)\n  (tc_1 : Nat.Prime p \u2227 IsPrimitiveRoot \u03b6 p \u2227 True)\n  (tc_3 : a % p \u2260 0) :\n  \u03b6^a \u2260 1 := by\n  intro h\n  have h1 := IsPrimitiveRoot.pow_eq_one_iff_dvd h\u03b6\n  rw [\u2190Int.coe_nat_dvd] at h1\n  have hmod : (a : \u2124) % p = 0 := by\n    rw [\u2190h1]\n    exact_mod_cast h\n  exact tc_3 hmod", "lean_pass": false, "lean_verify": false, "error_msg": [{"line": 12, "column": 6, "endLine": 12, "endColumn": 22, "data": "tactic 'rewrite' failed, did not find instance of the pattern in the target expression\n  ?m.572 \u2223 ?m.573\np : \u2115\nhp : Nat.Prime p\n\u03b6 : \u2102\nh\u03b6 : IsPrimitiveRoot \u03b6 p\na : \u2124\ntc_1 : Nat.Prime p \u2227 IsPrimitiveRoot \u03b6 p \u2227 True\ntc_3 : a % \u2191p \u2260 0\nh : \u03b6 ^ a = 1\nh1 : \u2200 (l : \u2115), \u03b6 ^ l = 1 \u2194 p \u2223 l\n\u22a2 False"}], "tries": 5}, "score": {"semantic_score": 0, "semantic_feedback": ["The Lean formalization correctly captures all components of the natural language statement. The prime condition on p is properly formalized with Nat.Prime p, the primitive root condition is correctly expressed with IsPrimitiveRoot \u03b6 p, the integer constraint on a is properly typed as \u2124, the modular arithmetic condition a \u2262 0 (mod p) is correctly translated to a % p \u2260 0, and the conclusion \u03b6^a \u2260 1 matches exactly. The redundant tc_1 condition doesn't introduce any logical inconsistency, just provides extra (unnecessary) constraints that are already covered by other hypotheses.", "The tactics contained syntactic mistakes, so final score is 0."]}, "error_report": {"error_type": "Prover", "error_report": "Formalization appears correct (score=1.0 > 0.6), but the prover could neither prove the lemma nor its negation. This may be due to prover limitations, missing lemmas, or incomplete context."}, "solved_negation": {"lean_verify": false, "lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma not_l3\n  (p : \u2115) (hp : Nat.Prime p) (\u03b6 : \u2102) (h\u03b6 : IsPrimitiveRoot \u03b6 p) (a : \u2124)\n  (tc_1 : Nat.Prime p \u2227 IsPrimitiveRoot \u03b6 p \u2227 True)\n  (tc_3 : a % p \u2260 0) :\n  \u00ac(\u03b6^a \u2260 1) := by\n  simp [h\u03b6.pow_eq_one_iff_dvd a.toNat]\n  rw [\u2190 Int.coe_nat_dvd, Int.coe_nat_dvd_left]\n  intro h\n  apply tc_3\n  exact h"}, "type": "lemma"}, "l4": {"id": "l4", "natural_language": "so $\\zeta^a - 1 \\neq 0$", "statement": "We assume:\n\u2022 \u03b6^a \u2260 1 [l3]\nTherefore, we conclude:\n\u2022 \u03b6^a - 1 \u2260 0 [l4].", "dependencies": ["l3"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l4\n  (p : \u2115) (hp : Nat.Prime p) (\u03b6 : \u2102) (h\u03b6 : IsPrimitiveRoot \u03b6 p) (a : \u2124)\n  (tc_1 : Nat.Prime p \u2227 IsPrimitiveRoot \u03b6 p \u2227 True)\n  (tc_3 : a % p \u2260 0)\n  (l3 : \u03b6^a \u2260 1) :\n  \u03b6^a - 1 \u2260 0 := by\nsorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l4\n  (p : \u2115) (hp : Nat.Prime p) (\u03b6 : \u2102) (h\u03b6 : IsPrimitiveRoot \u03b6 p) (a : \u2124)\n  (tc_1 : Nat.Prime p \u2227 IsPrimitiveRoot \u03b6 p \u2227 True)\n  (tc_3 : a % p \u2260 0)\n  (l3 : \u03b6^a \u2260 1) :\n  \u03b6^a - 1 \u2260 0 := by\n  exact sub_ne_zero.mpr l3", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The Lean formalization correctly captures the core logical relationship from natural language: \u03b6^a \u2260 1 implies \u03b6^a - 1 \u2260 0. The additional mathematical context (primitive roots, prime conditions, and extra constraints) provides proper mathematical framework without contradicting the stated logic. The assumption l3 and conclusion l4 are faithfully represented."]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "lemma"}, "ts_2": {"id": "ts_2", "natural_language": "$$\n\\sum_{n=0}^{p-1} \\zeta^{an} = \\frac{\\zeta^{ap}-1}{\\zeta^a-1} =\n\\frac{1-1}{\\zeta^a-1} = 0.\n$$", "statement": "We assume:\n\u2022 p is a prime number, \u03b6 is a primitive p-th root of unity, and a is an integer [tc_1]\n\u2022 \u03b6^a \u2260 1 [l3]\n\u2022 \u03b6^a - 1 \u2260 0 [l4]\nTherefore, we conclude:\n\u2022 \u2211_{n=0}^{p-1} \u03b6^(an) = 0 [ts_2].", "dependencies": ["tc_1", "l3", "l4"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma ts_2\n  (p : \u2115) (hp : Nat.Prime p) (\u03b6 : \u2102) (h\u03b6 : IsPrimitiveRoot \u03b6 p) (a : \u2124)\n  (tc_1 : Nat.Prime p \u2227 IsPrimitiveRoot \u03b6 p \u2227 True)\n  (l3 : \u03b6^a \u2260 1)\n  (l4 : \u03b6^a - 1 \u2260 0) :\n  \u2211 n : Fin p, \u03b6^(a * n.val) = 0 := by\nsorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma ts_2\n  (p : \u2115) (hp : Nat.Prime p) (\u03b6 : \u2102) (h\u03b6 : IsPrimitiveRoot \u03b6 p) (a : \u2124)\n  (tc_1 : Nat.Prime p \u2227 IsPrimitiveRoot \u03b6 p \u2227 True)\n  (l3 : \u03b6^a \u2260 1)\n  (l4 : \u03b6^a - 1 \u2260 0) :\n  \u2211 n : Fin p, \u03b6^(a * n.val) = 0 := by\n  have hsum : (\u03b6^a - 1) * \u2211 n : Fin p, \u03b6^(a * n.val) = \u2211 n : Fin p, \u03b6^(a * (n.val + 1)) - \u2211 n : Fin p, \u03b6^(a * n.val) := by\n    simp [mul_sum, Finset.sum_sub_distrib, \u2190 mul_assoc, \u2190 pow_add]\n  have hshift : \u2211 n : Fin p, \u03b6^(a * (n.val + 1)) = \u2211 n : Fin p, \u03b6^(a * n.val) := by\n    rw [Finset.sum_eq_sum_shift _ 1]\n    simp [Fin.val_add_one]\n  rw [hshift, sub_self] at hsum\n  exact eq_zero_of_mul_eq_zero_left hsum l4", "lean_pass": false, "lean_verify": false, "error_msg": [{"line": 12, "column": 10, "endLine": 12, "endColumn": 17, "data": "unknown identifier 'mul_sum'"}, {"line": 12, "column": 4, "endLine": 12, "endColumn": 66, "data": "simp made no progress"}, {"line": 14, "column": 8, "endLine": 14, "endColumn": 35, "data": "unknown constant 'Finset.sum_eq_sum_shift'"}, {"line": 14, "column": 8, "endLine": 14, "endColumn": 35, "data": "tactic 'rewrite' failed, equality or iff proof expected\n  ?m.10428\np : \u2115\nhp : Nat.Prime p\n\u03b6 : \u2102\nh\u03b6 : IsPrimitiveRoot \u03b6 p\na : \u2124\ntc_1 : Nat.Prime p \u2227 IsPrimitiveRoot \u03b6 p \u2227 True\nl3 : \u03b6 ^ a \u2260 1\nl4 : \u03b6 ^ a - 1 \u2260 0\nhsum : (\u03b6 ^ a - 1) * \u2211 n : Fin p, \u03b6 ^ (a * \u2191\u2191n) = \u2211 n : Fin p, \u03b6 ^ (a * (\u2191\u2191n + 1)) - \u2211 n : Fin p, \u03b6 ^ (a * \u2191\u2191n)\n\u22a2 \u2211 n : Fin p, \u03b6 ^ (a * (\u2191\u2191n + 1)) = \u2211 n : Fin p, \u03b6 ^ (a * \u2191\u2191n)"}, {"line": 17, "column": 8, "endLine": 17, "endColumn": 35, "data": "unknown identifier 'eq_zero_of_mul_eq_zero_left'"}], "tries": 5}, "score": {"semantic_score": 0, "semantic_feedback": ["The Lean formalization correctly captures all the mathematical content from the natural language. The assumptions about p being prime, \u03b6 being a primitive p-th root of unity, a being an integer, and the two non-equality conditions are all properly represented. The conclusion about the sum equaling zero is mathematically equivalent between both versions. The Lean version includes some redundant conditions (tc_1) and uses Lean-specific notation (Fin p, n.val), but these don't change the mathematical meaning and are acceptable additional details.", "The tactics contained syntactic mistakes, so final score is 0."]}, "error_report": {"error_type": "Prover", "error_report": "Formalization appears correct (score=1.0 > 0.6), but the prover could neither prove the lemma nor its negation. This may be due to prover limitations, missing lemmas, or incomplete context."}, "solved_negation": {"lean_verify": false, "lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma neg_ts_2\n  (p : \u2115) (hp : Nat.Prime p) (\u03b6 : \u2102) (h\u03b6 : IsPrimitiveRoot \u03b6 p) (a : \u2124)\n  (tc_1 : Nat.Prime p \u2227 IsPrimitiveRoot \u03b6 p \u2227 True)\n  (l3 : \u03b6^a \u2260 1)\n  (l4 : \u03b6^a - 1 \u2260 0) :\n  \u00ac (\u2211 n : Fin p, \u03b6^(a * n.val) = 0) := by\n  have h : \u03b6^a \u2260 1 := l3\n  have hsum : \u2211 n : Fin p, \u03b6^(a * n.val) = (1 - \u03b6^(a * p)) / (1 - \u03b6^a) := by\n    simp [\u2190 Finset.sum_geom (\u03b6^a) h, Finset.sum_range_eq_sum_Fin]\n    simp [h\u03b6.pow_eq_one, \u2190 Int.cast_ofNat p, mul_comm]\n  simp [hsum, l4, div_eq_zero_iff]\n  push_neg\n  exact h"}, "type": "solution"}};
            
            // Create nodes and edges
            var nodes = new vis.DataSet([{"id": "tc_1", "label": "tc_1", "color": {"background": "#eba0a0", "border": "#00ff00", "highlight": {"background": "#eba0a0", "border": "#00ff00"}}, "shape": "box", "size": 30, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "tc_2", "label": "tc_2", "color": {"background": "#eba0a0", "border": "#00ff00", "highlight": {"background": "#eba0a0", "border": "#00ff00"}}, "shape": "box", "size": 30, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l1", "label": "l1", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l2", "label": "l2", "color": {"background": "#8dafcc", "border": "#FFA500", "highlight": {"background": "#8dafcc", "border": "#FFA500"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "ts_1", "label": "ts_1", "color": {"background": "#a3c2a8", "border": "#00ff00", "highlight": {"background": "#a3c2a8", "border": "#00ff00"}}, "shape": "star", "size": 40, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "tc_3", "label": "tc_3", "color": {"background": "#eba0a0", "border": "#00ff00", "highlight": {"background": "#eba0a0", "border": "#00ff00"}}, "shape": "box", "size": 30, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l3", "label": "l3", "color": {"background": "#8dafcc", "border": "#FFA500", "highlight": {"background": "#8dafcc", "border": "#FFA500"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l4", "label": "l4", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "ts_2", "label": "ts_2", "color": {"background": "#a3c2a8", "border": "#FFA500", "highlight": {"background": "#a3c2a8", "border": "#FFA500"}}, "shape": "star", "size": 40, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}]);
            var edges = new vis.DataSet([{"from": "tc_1", "to": "tc_2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "l1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "tc_3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "l3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "ts_2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_2", "to": "l1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "l2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l2", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_3", "to": "l3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l3", "to": "l4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l3", "to": "ts_2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l4", "to": "ts_2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}]);
            
            // Create network
            var container = document.getElementById('mynetwork');
            var data = {
                nodes: nodes,
                edges: edges
            };
            
            var options = {
                physics: {
                    enabled: true,
                    solver: 'hierarchicalRepulsion',
                    hierarchicalRepulsion: {
                        centralGravity: 0.0,
                        springLength: 200,
                        springConstant: 0.01,
                        nodeDistance: 150,
                        damping: 0.09
                    }
                },
                edges: {
                    smooth: {
                        type: 'continuous',
                        forceDirection: 'none'
                    },
                    color: {
                        color: '#666666',
                        highlight: '#666666',
                        hover: '#666666'
                    },
                    width: 2
                },
                interaction: {
                    hover: true,
                    tooltipDelay: 100,
                    navigationButtons: true,
                    keyboard: true
                },
                nodes: {
                    font: {
                        size: 14,
                        color: '#000000'
                    },
                    labelHighlightBold: false,
                    chosen: false,
                    shapeProperties: {
                        useBorderWithImage: false
                    },
                    scaling: {
                        label: {
                            enabled: true,
                            min: 8,
                            max: 20,
                            maxVisible: 20,
                            drawThreshold: 5
                        }
                    }
                }
            };
            
            var network = new vis.Network(container, data, options);
            
            // Format field value for display
            function formatFieldValue(value, fieldName) {
                if (value === null || value === undefined) {
                    return 'N/A';
                }
                
                // Handle objects (dictionaries) as sub-boxes
                if (typeof value === 'object' && !Array.isArray(value)) {
                    var html = '';
                    for (var key in value) {
                        if (value.hasOwnProperty(key)) {
                            var subValue = value[key];
                            var subValueStr = '';
                            
                            if (typeof subValue === 'object' &&
                                    !Array.isArray(subValue)) {
                                // Nested object - show as JSON
                                subValueStr = JSON.stringify(subValue, null, 2);
                            } else if (Array.isArray(subValue)) {
                                // Array - show as JSON
                                subValueStr = JSON.stringify(subValue, null, 2);
                            } else {
                                // Primitive value
                                subValueStr = String(subValue);
                            }
                            
                            // Replace escaped newlines and tabs with actual characters
                            subValueStr = subValueStr.replace(/\\n/g, '\n');
                            subValueStr = subValueStr.replace(/\\t/g, '\t');
                            subValueStr = subValueStr.replace(/\t/g, '\t');
                            
                            html += '<div class="sub-dict">';
                            html += '<div class="sub-dict-title">' + key + '</div>';
                            html += '<div class="sub-dict-content">' + subValueStr + '</div>';
                            html += '</div>';
                        }
                    }
                    return html;
                }
                
                // Convert to string for primitive values and arrays
                var strValue = String(value);
                
                // Handle arrays
                if (Array.isArray(value)) {
                    strValue = JSON.stringify(value, null, 2);
                }
                
                // Replace escaped newlines and tabs with actual characters
                strValue = strValue.replace(/\\n/g, '\n');
                strValue = strValue.replace(/\\t/g, '\t');
                strValue = strValue.replace(/\t/g, '\t');
                
                return strValue;
            }
            
            // Handle node click events
            network.on("click", function(params) {
                if (params.nodes.length > 0) {
                    var nodeId = params.nodes[0];
                    var info = nodeInfo[nodeId];
                    
                    if (info) {
                        var html = '<div class="info-header">';
                        html += '<h2>' + nodeId + '</h2>';
                        var nodeType = info.type || 'unknown';
                        var capitalizedType = nodeType.charAt(0).toUpperCase() +
                            nodeType.slice(1);
                        html += '<div class="node-type">Type: ' + capitalizedType +
                            '</div>';
                        html += '</div>';
                        
                        // Add all fields
                        for (var key in info) {
                            if (key === 'type' || key === 'id') continue;
                            
                            var fieldName = key.replace(/_/g, ' ')
                                .replace(/\b\w/g, function(l) {
                                    return l.toUpperCase();
                                });
                            var fieldValue = formatFieldValue(info[key], fieldName);
                            
                            if (fieldValue && fieldValue !== 'N/A') {
                                // Special formatting for code fields
                                var isCode = key.includes('code') ||
                                    key.includes('lean') ||
                                    key.includes('statement');
                                
                                html += '<div class="field-group">';
                                html += '<div class="field-name">' + fieldName +
                                    '</div>';
                                html += '<div class="field-value' +
                                    (isCode ? ' code' : '') + '">' +
                                    fieldValue + '</div>';
                                html += '</div>';
                            }
                        }
                        
                        document.getElementById('info-content')
                            .innerHTML = html;
                    }
                }
            });
            
            // Toggle panel function
            function togglePanel() {
                var panel = document.getElementById('info-panel');
                panel.classList.toggle('hidden');
                
                // Resize network when panel is toggled
                setTimeout(function() {
                    network.fit();
                }, 300);
            }
            
            // Initial network fit
            network.once('stabilized', function() {
                network.fit();
            });
            
            // Resizable panels functionality
            function makeResizable() {
                const verticalResizer = document.getElementById('vertical-resizer');
                const horizontalResizer = document.getElementById('horizontal-resizer');
                const proofPanel = document.getElementById('proof-str-panel');
                const graphContainer = document.getElementById('graph-container');
                const infoPanel = document.getElementById('info-panel');
                const leftPanel = document.getElementById('left-panel');
                
                let isVerticalResizing = false;
                let isHorizontalResizing = false;
                
                // Vertical resizer (between proof panel and graph)
                verticalResizer.addEventListener('mousedown', function(e) {
                    isVerticalResizing = true;
                    document.addEventListener('mousemove', verticalResize);
                    document.addEventListener('mouseup', stopVerticalResize);
                    e.preventDefault();
                });
                
                function verticalResize(e) {
                    if (!isVerticalResizing) return;
                    
                    const containerHeight = leftPanel.offsetHeight;
                    const newHeight = e.clientY - leftPanel.offsetTop;
                    const minHeight = 100;
                    const maxHeight = containerHeight - 100;
                    
                    if (newHeight >= minHeight && newHeight <= maxHeight) {
                        proofPanel.style.height = newHeight + 'px';
                        graphContainer.style.height = (containerHeight - newHeight) + 'px';
                        network.fit();
                    }
                }
                
                function stopVerticalResize() {
                    isVerticalResizing = false;
                    document.removeEventListener('mousemove', verticalResize);
                    document.removeEventListener('mouseup', stopVerticalResize);
                }
                
                // Horizontal resizer (between left and right panels)
                horizontalResizer.addEventListener('mousedown', function(e) {
                    isHorizontalResizing = true;
                    document.addEventListener('mousemove', horizontalResize);
                    document.addEventListener('mouseup', stopHorizontalResize);
                    e.preventDefault();
                });
                
                function horizontalResize(e) {
                    if (!isHorizontalResizing) return;
                    
                    const containerWidth = document.querySelector('.container').offsetWidth;
                    const newWidth = e.clientX - leftPanel.offsetLeft;
                    const minWidth = 300;
                    const maxWidth = containerWidth - 300;
                    
                    if (newWidth >= minWidth && newWidth <= maxWidth) {
                        leftPanel.style.flex = 'none';
                        leftPanel.style.width = newWidth + 'px';
                        infoPanel.style.width = (containerWidth - newWidth) + 'px';
                        network.fit();
                    }
                }
                
                function stopHorizontalResize() {
                    isHorizontalResizing = false;
                    document.removeEventListener('mousemove', horizontalResize);
                    document.removeEventListener('mouseup', stopHorizontalResize);
                }
            }
            
            // Initialize resizable panels
            makeResizable();
        </script>
    </body>
    </html>
    