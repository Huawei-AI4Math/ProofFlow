
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Proof Graph Visualization</title>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
        <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.css" rel="stylesheet" type="text/css" />
        <style>
            body {
                margin: 0;
                padding: 0;
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
                height: 100vh;
                overflow: hidden;
            }
            
            .container {
                display: flex;
                height: 100vh;
                background: #f0f0f0;
            }
            
            #left-panel {
                flex: 1;
                display: flex;
                flex-direction: column;
                background: white;
                border-right: 2px solid #ddd;
                height: 100vh;
                overflow: hidden;
            }
            
            #proof-str-panel {
                background: #f8f9fa;
                border-bottom: 2px solid #ddd;
                padding: 15px;
                height: 200px;
                overflow-y: auto;
                flex-shrink: 0;
            }
            
            #proof-str-title {
                font-weight: 600;
                color: #2d3748;
                margin-bottom: 10px;
                font-size: 14px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
            
            #proof-str-content {
                color: #4a5568;
                line-height: 1.6;
                white-space: pre-wrap;
                word-wrap: break-word;
                font-family: 'Monaco', 'Courier New', monospace;
                font-size: 13px;
                background: white;
                padding: 12px;
                border-radius: 4px;
                border: 1px solid #e2e8f0;
            }
            
            #graph-container {
                flex: 1;
                position: relative;
                background: white;
                min-height: 0;
                overflow: hidden;
            }
            
            #mynetwork {
                width: 100%;
                height: 100%;
            }
            
            #info-panel {
                width: 40%;
                max-width: 600px;
                background: white;
                overflow-y: auto;
                padding: 20px;
                box-shadow: -2px 0 10px rgba(0,0,0,0.1);
            }
            
            #info-panel.hidden {
                display: none;
            }
            
            .info-header {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                padding: 15px;
                border-radius: 8px;
                margin-bottom: 20px;
            }
            
            .info-header h2 {
                margin: 0;
                font-size: 24px;
            }
            
            .info-header .node-type {
                opacity: 0.9;
                font-size: 14px;
                margin-top: 5px;
            }
            
            .field-group {
                background: #f8f9fa;
                border-left: 4px solid #667eea;
                padding: 15px;
                margin-bottom: 15px;
                border-radius: 4px;
            }
            
            .field-name {
                font-weight: 600;
                color: #2d3748;
                margin-bottom: 8px;
                font-size: 14px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
            
            .field-value {
                color: #4a5568;
                line-height: 1.6;
                white-space: pre-wrap;
                word-wrap: break-word;
                font-family: 'Monaco', 'Courier New', monospace;
                font-size: 13px;
            }
            
            .field-value.code {
                color: #4a5568;
                padding: 12px;
                border-radius: 4px;
                overflow-x: auto;
            }
            
            .sub-dict {
                background: #ffffff;
                border: 1px solid #e2e8f0;
                border-radius: 4px;
                padding: 10px;
                margin: 8px 0;
                box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            }
            
            .sub-dict-title {
                font-weight: 600;
                color: #4a5568;
                margin-bottom: 8px;
                font-size: 12px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                border-bottom: 1px solid #e2e8f0;
                padding-bottom: 4px;
            }
            
            .sub-dict-content {
                color: #2d3748;
                line-height: 1.5;
                font-size: 12px;
            }
            
            .placeholder {
                text-align: center;
                color: #718096;
                padding: 40px;
                font-size: 18px;
            }
            
            .placeholder-icon {
                font-size: 48px;
                margin-bottom: 20px;
                opacity: 0.3;
            }
            
            #toggle-panel {
                position: absolute;
                right: 10px;
                top: 10px;
                z-index: 1000;
                background: #667eea;
                color: white;
                border: none;
                padding: 10px 20px;
                border-radius: 5px;
                cursor: pointer;
                font-size: 14px;
                transition: background 0.3s;
            }
            
            #toggle-panel:hover {
                background: #764ba2;
            }
            
            .legend {
                position: absolute;
                top: 20px;
                left: 20px;
                background: white;
                padding: 15px;
                border-radius: 8px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
                z-index: 100;
                max-width: 300px;
            }
            
            .legend-section {
                margin-bottom: 15px;
            }
            
            .legend-section:last-child {
                margin-bottom: 0;
            }
            
            .legend-title {
                font-weight: 600;
                font-size: 12px;
                color: #2d3748;
                margin-bottom: 8px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                border-bottom: 1px solid #e2e8f0;
                padding-bottom: 4px;
            }
            
            .legend-item {
                display: flex;
                align-items: center;
                margin-bottom: 8px;
            }
            
            .legend-item:last-child {
                margin-bottom: 0;
            }
            
            .legend-color {
                width: 20px;
                height: 20px;
                margin-right: 10px;
                border-radius: 3px;
            }
            
            .resizer {
                background: #ddd;
                cursor: col-resize;
                width: 4px;
                height: 100%;
                position: absolute;
                right: 0;
                top: 0;
                z-index: 1000;
            }
            
            .resizer:hover {
                background: #bbb;
            }
            
            .resizer-vertical {
                background: #ddd;
                cursor: row-resize;
                height: 4px;
                width: 100%;
                position: absolute;
                bottom: 0;
                left: 0;
                z-index: 1000;
            }
            
            .resizer-vertical:hover {
                background: #bbb;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div id="left-panel">
                <div id="proof-str-panel">
                    <div id="proof-str-title">Informal theorem and proof</div>
                    <div id="proof-str-content">Theorem: Let $z$ be a complex number. If $z^2 + 2\bar{z} + 1 = 0$ and $\operatorname{Im}(z) < 0$, then $z = 1 - 2i$.

Proof: Let $z = x+iy$ for real numbers $x, y$. Substituting this form into the equation $z^2 + 2\bar{z} + 1 = 0$ and equating the real and imaginary parts to zero gives the system of equations $x^2 - y^2 + 2x + 1 = 0$ and $2y(x-1) = 0$. From the condition $\operatorname{Im}(z) < 0$, we know $y 
eq 0$, so from the second equation we deduce $x=1$. Substituting $x=1$ into the first equation gives $1 - y^2 + 2 + 1 = 0$, which simplifies to $y^2=4$. Since $\operatorname{Im}(z) < 0$, we must have $y=-2$, which means $z=1-2i$.
</div>
                    <div class="resizer-vertical" id="vertical-resizer"></div>
                </div>
                <div id="graph-container">
                    <button id="toggle-panel" onclick="togglePanel()">Toggle Info Panel</button>
                    <div class="legend">
                        <div class="legend-section">
                            <div class="legend-title">Node Types</div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #eba0a0;"></div>
                                <span>Theorem Conditions (tc)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #cfb795 ;"></div>
                                <span>Theorem Definitions (def)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #8dafcc;"></div>
                                <span>Lemmas (l)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #a3c2a8;"></div>
                                <span>Theorem Solutions (ts)</span>
                            </div>

                        </div>
                        <div class="legend-section">
                            <div class="legend-title">Verification Status</div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #fa2c07;"></div>
                                <span>Formalization failed</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #FFA500;"></div>
                                <span>Formalization passed</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #00ff00;"></div>
                                <span>Fully verified</span>
                            </div>
                        </div>
                    </div>
                    <div id="mynetwork"></div>
                </div>
            </div>
            
            <div class="resizer" id="horizontal-resizer"></div>
            
            <div id="info-panel">
                <div id="info-content">
                    <div class="placeholder">
                        <div class="placeholder-icon">📊</div>
                        <p>Click on a node to view its details</p>
                    </div>
                </div>
            </div>
        </div>
        
        <script type="text/javascript">
            // Store node information
            var nodeInfo = {"tc_1": {"id": "tc_1", "natural_language": "Let $z$ be a complex number. If $z^2 + 2\\bar{z} + 1 = 0$ and $\\operatorname{Im}(z) < 0$", "statement": "Premise:\n\u2022 $z$ is a complex number such that $z^2 + 2\\bar{z} + 1 = 0$ and $\\operatorname{Im}(z) < 0$ [tc_1].", "dependencies": [], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nvariable (z : \u2102)\n(tc_1 : z^2 + 2 * conj z + 1 = 0 \u2227 z.im < 0)", "lean_pass": false, "error_msg": [{"line": 6, "column": 18, "endLine": 6, "endColumn": 24, "data": "function expected at\n  conj\nterm has type\n  ?m.40"}], "tries": 5}, "solved_lemma": {}, "score": {"semantic_score": 0, "semantic_feedback": "Failed Lean syntax check already."}, "error_report": {"error_type": "Formalization", "error_report": "Formalized statement is not a valid Lean4 statement"}, "type": "condition"}, "def_1": {"id": "def_1", "natural_language": "Let $z = x+iy$ for real numbers $x, y$.", "statement": "Definition:\n\u2022 Let $z = x+iy$, where $x$ and $y$ are real numbers. This defines $x$ as the real part of $z$ and $y$ as the imaginary part of $z$ [def_1].", "dependencies": ["tc_1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nvariable\n  (z : \u2102)\n  (tc_1 : z ^ 2 + 2 * conj z + 1 = 0 \u2227 Im z < 0)\n  (x y : \u211d)\n  (def_1 : z = x + y * I \u2227 x = z.re \u2227 y = z.im)", "lean_pass": false, "error_msg": [{"line": 7, "column": 22, "endLine": 7, "endColumn": 28, "data": "function expected at\n  conj\nterm has type\n  ?m.40"}, {"line": 7, "column": 39, "endLine": 7, "endColumn": 43, "data": "function expected at\n  Im\nterm has type\n  ?m.411"}], "tries": 5}, "solved_lemma": {}, "score": {"semantic_score": 0, "semantic_feedback": "Failed Lean syntax check already."}, "error_report": {"error_type": "Formalization", "error_report": "Formalized statement is not a valid Lean4 statement"}, "type": "definition"}, "l1": {"id": "l1", "natural_language": "Substituting this form into the equation $z^2 + 2\\bar{z} + 1 = 0$ and equating the real and imaginary parts to zero gives the system of equations $x^2 - y^2 + 2x + 1 = 0$ and $2y(x-1) = 0$.", "statement": "We assume:\n\u2022 $z$ is a complex number such that $z^2 + 2\\bar{z} + 1 = 0$ [tc_1]\n\u2022 Let $z = x+iy$, where $x, y$ are real numbers [def_1]\nTherefore, we conclude:\n\u2022 The system of equations $x^2 - y^2 + 2x + 1 = 0$ and $2y(x-1) = 0$ holds [l1].", "dependencies": ["tc_1", "def_1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l1\n  (z : \u2102) (x y : \u211d)\n  (tc_1 : z^2 + 2 * conj z + 1 = 0)\n  (def_1 : z = x + y * I) :\n  (x^2 - y^2 + 2 * x + 1 = 0) \u2227 (2 * y * (x - 1) = 0) := by\nsorry", "lean_pass": false, "error_msg": [{"line": 7, "column": 20, "endLine": 7, "endColumn": 26, "data": "function expected at\n  conj\nterm has type\n  ?m.44"}], "tries": 5}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter Complex\n\nlemma l1\n  (z : \u2102) (x y : \u211d)\n  (tc_1 : z^2 + 2 * (conj z) + 1 = 0)\n  (def_1 : z = x + y * I) :\n  (x^2 - y^2 + 2 * x + 1 = 0) \u2227 (2 * y * (x - 1) = 0) := by\n  have h1 : conj z = x - y * I := by rw [def_1]; simp\n  have h2 := congr_arg (fun w : \u2102 => (re w, im w)) tc_1\n  simp [def_1, h1, add_re, add_im, mul_re, mul_im, conj_re, conj_im, I_re, I_im] at h2\n  simp [h2]", "lean_pass": false, "lean_verify": false, "error_msg": [{"line": 7, "column": 21, "endLine": 7, "endColumn": 27, "data": "function expected at\n  conj\nterm has type\n  ?m.44"}, {"line": 10, "column": 12, "endLine": 10, "endColumn": 18, "data": "function expected at\n  conj\nterm has type\n  x\u271d"}, {"line": 10, "column": 41, "endLine": 10, "endColumn": 46, "data": "tactic 'rewrite' failed, did not find instance of the pattern in the target expression\n  z\nx\u271d : Sort u_1\nconj : x\u271d\nz : \u2102\nx y : \u211d\ntc_1 : z ^ 2 + 2 * sorry + 1 = 0\ndef_1 : z = \u2191x + \u2191y * I\n\u22a2 sorry = \u2191x - \u2191y * I"}, {"line": 9, "column": 57, "endLine": 13, "endColumn": 11, "data": "unsolved goals\nx\u271d : Sort u_1\nconj : x\u271d\nz : \u2102\nx y : \u211d\ntc_1 : z ^ 2 + 2 * sorry + 1 = 0\ndef_1 : z = \u2191x + \u2191y * I\nh1 : sorry = \u2191x - \u2191y * I\nh2 : ((\u2191x + \u2191y * I) ^ 2).re + 2 * x + 1 = 0 \u2227 ((\u2191x + \u2191y * I) ^ 2).im + -(2 * y) = 0\n\u22a2 x ^ 2 - y ^ 2 + 2 * x + 1 = 0 \u2227 (y = 0 \u2228 x - 1 = 0)"}], "tries": 5}, "score": {"semantic_score": 0, "semantic_feedback": "Failed Lean syntax check already."}, "error_report": {"error_type": "Formalization", "error_report": "Formalized statement is not a valid Lean4 statement"}, "solved_negation": null, "type": "lemma"}, "l2": {"id": "l2", "natural_language": "From the condition $\\operatorname{Im}(z) < 0$, we know $y \\neq 0$", "statement": "We assume:\n\u2022 $z$ is a complex number such that $\\operatorname{Im}(z) < 0$ [tc_1]\n\u2022 Let $z = x+iy$, where $y$ is the imaginary part of $z$ [def_1]\nTherefore, we conclude:\n\u2022 $y < 0$ and thus $y \\neq 0$ [l2].", "dependencies": ["tc_1", "def_1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l2\n  (z : \u2102) (x y : \u211d)\n  (tc_1 : z.im < 0)\n  (def_1 : z = x + y * Complex.i) :\n  y < 0 \u2227 y \u2260 0 := by\n  sorry", "lean_pass": false, "error_msg": [{"line": 8, "column": 23, "endLine": 8, "endColumn": 32, "data": "unknown constant 'Complex.i'"}], "tries": 5}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l2\n  (z : \u2102) (x y : \u211d)\n  (tc_1 : z.im < 0)\n  (def_1 : z = x + y * Complex.I) :\n  y < 0 \u2227 y \u2260 0 := by\n  have : z.im = y := by simp [def_1]\n  rw [this] at tc_1\n  constructor\n  \u00b7 exact tc_1\n  \u00b7 linarith [tc_1]", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 5}, "score": {"semantic_score": 0, "semantic_feedback": "Failed Lean syntax check already."}, "error_report": {"error_type": "Formalization", "error_report": "Formalized statement is not a valid Lean4 statement"}, "solved_negation": null, "type": "lemma"}, "l3": {"id": "l3", "natural_language": "so from the second equation we deduce $x=1$.", "statement": "We assume:\n\u2022 The equation $2y(x-1) = 0$ holds (from [l1])\n\u2022 $y \\neq 0$ [l2]\nTherefore, we conclude:\n\u2022 $x=1$ [l3].", "dependencies": ["l1", "l2"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l3\n  (x y : \u211d)\n  (l1 : x^2 - y^2 + 2 * x + 1 = 0 \u2227 2 * y * (x - 1) = 0)\n  (l2 : y \u2260 0) :\n  x = 1 := by\nsorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l3\n  (x y : \u211d)\n  (l1 : x^2 - y^2 + 2 * x + 1 = 0 \u2227 2 * y * (x - 1) = 0)\n  (l2 : y \u2260 0) :\n  x = 1 := by\n  cases l1 with\n  | intro h1 h2 =>\n    have h : x - 1 = 0 := by\n      apply mul_eq_zero.mp at h2\n      cases h2 with\n      | inl h => simp [mul_eq_zero] at h; cases h; contradiction\n      | inr h => exact h\n    linarith", "lean_pass": false, "lean_verify": false, "error_msg": [{"line": 13, "column": 6, "endLine": 13, "endColumn": 32, "data": "Failed to find 2 * y * (x - 1) = 0 as the type of a parameter of ?m.1239 * ?m.1238 = 0 \u2192 ?m.1239 = 0 \u2228 ?m.1238 = 0."}], "tries": 5}, "score": {"semantic_score": 0, "semantic_feedback": ["The Lean formalization includes an additional equation x^2 - y^2 + 2*x + 1 = 0 in premise l1 that is not mentioned in the natural language, which significantly changes the mathematical content", "The premise l2 stating y \u2260 0 is correctly captured in both versions", "The conclusion x = 1 is correctly represented in both versions", "The overall logical structure is compromised by the introduction of an unmentiond equation that fundamentally alters the proof approach from a simple zero product property argument to a system of equations", "The tactics contained syntactic mistakes, so final score is 0."]}, "error_report": {"error_type": "Formalizer", "error_report": "Formalization is likely incorrect: semantic score is 0.0, below threshold 0.6.\nScorer feedback: ['The Lean formalization includes an additional equation x^2 - y^2 + 2*x + 1 = 0 in premise l1 that is not mentioned in the natural language, which significantly changes the mathematical content', 'The premise l2 stating y \u2260 0 is correctly captured in both versions', 'The conclusion x = 1 is correctly represented in both versions', 'The overall logical structure is compromised by the introduction of an unmentiond equation that fundamentally alters the proof approach from a simple zero product property argument to a system of equations']"}, "solved_negation": null, "type": "lemma"}, "l4": {"id": "l4", "natural_language": "Substituting $x=1$ into the first equation gives $1 - y^2 + 2 + 1 = 0$.", "statement": "We assume:\n\u2022 The equation $x^2 - y^2 + 2x + 1 = 0$ holds (from [l1])\n\u2022 $x=1$ [l3]\nTherefore, we conclude:\n\u2022 $1 - y^2 + 2 + 1 = 0$ [l4].", "dependencies": ["l1", "l3"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l4\n  (x y : \u211d)\n  (l1 : x^2 - y^2 + 2 * x + 1 = 0 \u2227 2 * y * (x - 1) = 0)\n  (l3 : x = 1) :\n  1 - y^2 + 2 + 1 = 0 := by\nsorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l4\n  (x y : \u211d)\n  (l1 : x^2 - y^2 + 2 * x + 1 = 0 \u2227 2 * y * (x - 1) = 0)\n  (l3 : x = 1) :\n  1 - y^2 + 2 + 1 = 0 := by\n  have h := l1.1\n  rw [l3] at h\n  simp at h\n  exact h", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 0.0, "semantic_feedback": ["The Lean formalization includes an additional constraint '2 * y * (x - 1) = 0' in premise l1 that is not mentioned in the natural language. The natural language only states the equation 'x^2 - y^2 + 2x + 1 = 0'.", "The premise l3 stating 'x = 1' is correctly captured in both natural language and Lean.", "The conclusion '1 - y^2 + 2 + 1 = 0' is correctly represented in both versions.", "The overall logical flow of substitution is preserved, but the extra constraint in l1 represents a significant addition to the problem setup not present in the natural language."]}, "error_report": {"error_type": "Formalizer", "error_report": "Formalization is likely incorrect: semantic score is 0.0, below threshold 0.6.\nScorer feedback: [\"The Lean formalization includes an additional constraint '2 * y * (x - 1) = 0' in premise l1 that is not mentioned in the natural language. The natural language only states the equation 'x^2 - y^2 + 2x + 1 = 0'.\", \"The premise l3 stating 'x = 1' is correctly captured in both natural language and Lean.\", \"The conclusion '1 - y^2 + 2 + 1 = 0' is correctly represented in both versions.\", 'The overall logical flow of substitution is preserved, but the extra constraint in l1 represents a significant addition to the problem setup not present in the natural language.']"}, "solved_negation": null, "type": "lemma"}, "l5": {"id": "l5", "natural_language": "which simplifies to $y^2=4$.", "statement": "We assume:\n\u2022 $1 - y^2 + 2 + 1 = 0$ [l4]\nTherefore, we conclude:\n\u2022 $y^2 = 4$ [l5].", "dependencies": ["l4"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l5\n  (y : \u211d)\n  (l4 : 1 - y^2 + 2 + 1 = 0) :\n  y^2 = 4 := by\nsorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l5\n  (y : \u211d)\n  (l4 : 1 - y^2 + 2 + 1 = 0) :\n  y^2 = 4 := by\n  linarith", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["Variable declaration as real number is a reasonable mathematical assumption not contradicting the natural language", "The premise l4 is exactly translated from natural language to Lean syntax", "The conclusion y^2 = 4 is perfectly captured in the goal", "The overall logical structure correctly represents the mathematical reasoning from premise to conclusion"]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "lemma"}, "l6": {"id": "l6", "natural_language": "Since $\\operatorname{Im}(z) < 0$, we must have $y=-2$.", "statement": "We assume:\n\u2022 $y^2 = 4$ [l5]\n\u2022 $y < 0$ [l2]\nTherefore, we conclude:\n\u2022 $y = -2$ [l6].", "dependencies": ["l2", "l5"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l6\n  (y : \u211d)\n  (l5 : y ^ 2 = 4)\n  (l2 : y < 0) :\n  y = -2 := by\nsorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma l6\n  (y : \u211d)\n  (l5 : y ^ 2 = 4)\n  (l2 : y < 0) :\n  y = -2 := by\n  have h : y = 2 \u2228 y = -2 := by\n    rw [\u2190 sq_eq_sq_iff_abs_eq_abs, abs_two, abs_two] at l5\n    exact l5\n  cases h with\n  | inl h1 => rw [h1] at l2; linarith\n  | inr h2 => exact h2", "lean_pass": false, "lean_verify": false, "error_msg": [{"line": 11, "column": 8, "endLine": 11, "endColumn": 33, "data": "tactic 'rewrite' failed, did not find instance of the pattern in the target expression\n  |?a| = |?b|\ny : \u211d\nl5 : y ^ 2 = 4\nl2 : y < 0\n\u22a2 y = 2 \u2228 y = -2"}], "tries": 5}, "score": {"semantic_score": 0, "semantic_feedback": ["Variable y is appropriately declared as a real number, making the implicit type explicit", "The premise y\u00b2 = 4 is correctly formalized as 'y ^ 2 = 4' with matching label l5", "The premise y < 0 is correctly formalized with matching label l2", "The conclusion y = -2 is correctly stated as the lemma goal with corresponding label l6", "The logical structure properly captures the implication from premises to conclusion", "The tactics contained syntactic mistakes, so final score is 0."]}, "error_report": {"error_type": "Prover", "error_report": "Formalization appears correct (score=1.0 > 0.6), but the prover could neither prove the lemma nor its negation. This may be due to prover limitations, missing lemmas, or incomplete context."}, "solved_negation": {"lean_verify": false, "lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma neg_l6\n  (y : \u211d)\n  (l5 : y ^ 2 = 4)\n  (l2 : y < 0) :\n  \u00ac(y = -2) := by\n  intro h\n  have : y = 2 \u2228 y = -2 := by rw [\u2190 sq_eq_sq_iff_eq_or_eq_neg, l5, (by norm_num : 4 = 2^2)]\n  cases this\n  \u00b7 rw [this] at l2\n    linarith\n  \u00b7 rw [h] at this\n    norm_num at this"}, "type": "lemma"}, "ts_1": {"id": "ts_1", "natural_language": "which means $z=1-2i$.", "statement": "We assume:\n\u2022 Let $z = x+iy$, where $x, y$ are real numbers [def_1]\n\u2022 $x=1$ [l3]\n\u2022 $y=-2$ [l6]\nTherefore, we conclude:\n\u2022 $z = 1 - 2i$ [ts_1].", "dependencies": ["def_1", "l3", "l6"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma ts_1\n  (x y : \u211d)\n  (def_1 : Complex.mk x y = x + y * Complex.I)\n  (l3 : x = 1)\n  (l6 : y = -2) :\n  Complex.mk x y = 1 - 2 * Complex.I := by\nsorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat Filter\n\nlemma ts_1\n  (x y : \u211d)\n  (def_1 : Complex.mk x y = x + y * Complex.I)\n  (l3 : x = 1)\n  (l6 : y = -2) :\n  Complex.mk x y = 1 - 2 * Complex.I := by\n  rw [def_1, l3, l6]\n  simp", "lean_pass": false, "lean_verify": false, "error_msg": [{"line": 10, "column": 40, "endLine": 12, "endColumn": 6, "data": "unsolved goals\nx y : \u211d\ndef_1 : { re := x, im := y } = \u2191x + \u2191y * Complex.I\nl3 : x = 1\nl6 : y = -2\n\u22a2 1 + -(2 * Complex.I) = 1 - 2 * Complex.I"}], "tries": 5}, "score": {"semantic_score": 0, "semantic_feedback": ["The formalization has a minor issue with def_1. The assumption 'Complex.mk x y = x + y * Complex.I' is definitionally true in Lean and shouldn't be stated as an assumption. The natural language 'Let z = x+iy' should either introduce z as a separate variable or be handled implicitly. However, the overall logical structure and conclusion are correct, and the mathematical meaning is preserved.", "The tactics contained syntactic mistakes, so final score is 0."]}, "error_report": {"error_type": "Formalizer", "error_report": "Formalization is likely incorrect: semantic score is 0.5, below threshold 0.6.\nScorer feedback: [\"The formalization has a minor issue with def_1. The assumption 'Complex.mk x y = x + y * Complex.I' is definitionally true in Lean and shouldn't be stated as an assumption. The natural language 'Let z = x+iy' should either introduce z as a separate variable or be handled implicitly. However, the overall logical structure and conclusion are correct, and the mathematical meaning is preserved.\"]"}, "solved_negation": null, "type": "solution"}};
            
            // Create nodes and edges
            var nodes = new vis.DataSet([{"id": "tc_1", "label": "tc_1", "color": {"background": "#eba0a0", "border": "#fa2c07", "highlight": {"background": "#eba0a0", "border": "#fa2c07"}}, "shape": "box", "size": 30, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "def_1", "label": "def_1", "color": {"background": "#cfb795", "border": "#fa2c07", "highlight": {"background": "#cfb795", "border": "#fa2c07"}}, "shape": "box", "size": 30, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l1", "label": "l1", "color": {"background": "#8dafcc", "border": "#fa2c07", "highlight": {"background": "#8dafcc", "border": "#fa2c07"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l2", "label": "l2", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l3", "label": "l3", "color": {"background": "#8dafcc", "border": "#FFA500", "highlight": {"background": "#8dafcc", "border": "#FFA500"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l4", "label": "l4", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l5", "label": "l5", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l6", "label": "l6", "color": {"background": "#8dafcc", "border": "#FFA500", "highlight": {"background": "#8dafcc", "border": "#FFA500"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "ts_1", "label": "ts_1", "color": {"background": "#a3c2a8", "border": "#FFA500", "highlight": {"background": "#a3c2a8", "border": "#FFA500"}}, "shape": "star", "size": 40, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}]);
            var edges = new vis.DataSet([{"from": "tc_1", "to": "def_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "l1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "l2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_1", "to": "l1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_1", "to": "l2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_1", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "l3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "l4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l2", "to": "l3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l2", "to": "l6", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l3", "to": "l4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l3", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l4", "to": "l5", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l5", "to": "l6", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l6", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}]);
            
            // Create network
            var container = document.getElementById('mynetwork');
            var data = {
                nodes: nodes,
                edges: edges
            };
            
            var options = {
                physics: {
                    enabled: true,
                    solver: 'hierarchicalRepulsion',
                    hierarchicalRepulsion: {
                        centralGravity: 0.0,
                        springLength: 200,
                        springConstant: 0.01,
                        nodeDistance: 150,
                        damping: 0.09
                    }
                },
                edges: {
                    smooth: {
                        type: 'continuous',
                        forceDirection: 'none'
                    },
                    color: {
                        color: '#666666',
                        highlight: '#666666',
                        hover: '#666666'
                    },
                    width: 2
                },
                interaction: {
                    hover: true,
                    tooltipDelay: 100,
                    navigationButtons: true,
                    keyboard: true
                },
                nodes: {
                    font: {
                        size: 14,
                        color: '#000000'
                    },
                    labelHighlightBold: false,
                    chosen: false,
                    shapeProperties: {
                        useBorderWithImage: false
                    },
                    scaling: {
                        label: {
                            enabled: true,
                            min: 8,
                            max: 20,
                            maxVisible: 20,
                            drawThreshold: 5
                        }
                    }
                }
            };
            
            var network = new vis.Network(container, data, options);
            
            // Format field value for display
            function formatFieldValue(value, fieldName) {
                if (value === null || value === undefined) {
                    return 'N/A';
                }
                
                // Handle objects (dictionaries) as sub-boxes
                if (typeof value === 'object' && !Array.isArray(value)) {
                    var html = '';
                    for (var key in value) {
                        if (value.hasOwnProperty(key)) {
                            var subValue = value[key];
                            var subValueStr = '';
                            
                            if (typeof subValue === 'object' &&
                                    !Array.isArray(subValue)) {
                                // Nested object - show as JSON
                                subValueStr = JSON.stringify(subValue, null, 2);
                            } else if (Array.isArray(subValue)) {
                                // Array - show as JSON
                                subValueStr = JSON.stringify(subValue, null, 2);
                            } else {
                                // Primitive value
                                subValueStr = String(subValue);
                            }
                            
                            // Replace escaped newlines and tabs with actual characters
                            subValueStr = subValueStr.replace(/\\n/g, '\n');
                            subValueStr = subValueStr.replace(/\\t/g, '\t');
                            subValueStr = subValueStr.replace(/\t/g, '\t');
                            
                            html += '<div class="sub-dict">';
                            html += '<div class="sub-dict-title">' + key + '</div>';
                            html += '<div class="sub-dict-content">' + subValueStr + '</div>';
                            html += '</div>';
                        }
                    }
                    return html;
                }
                
                // Convert to string for primitive values and arrays
                var strValue = String(value);
                
                // Handle arrays
                if (Array.isArray(value)) {
                    strValue = JSON.stringify(value, null, 2);
                }
                
                // Replace escaped newlines and tabs with actual characters
                strValue = strValue.replace(/\\n/g, '\n');
                strValue = strValue.replace(/\\t/g, '\t');
                strValue = strValue.replace(/\t/g, '\t');
                
                return strValue;
            }
            
            // Handle node click events
            network.on("click", function(params) {
                if (params.nodes.length > 0) {
                    var nodeId = params.nodes[0];
                    var info = nodeInfo[nodeId];
                    
                    if (info) {
                        var html = '<div class="info-header">';
                        html += '<h2>' + nodeId + '</h2>';
                        var nodeType = info.type || 'unknown';
                        var capitalizedType = nodeType.charAt(0).toUpperCase() +
                            nodeType.slice(1);
                        html += '<div class="node-type">Type: ' + capitalizedType +
                            '</div>';
                        html += '</div>';
                        
                        // Add all fields
                        for (var key in info) {
                            if (key === 'type' || key === 'id') continue;
                            
                            var fieldName = key.replace(/_/g, ' ')
                                .replace(/\b\w/g, function(l) {
                                    return l.toUpperCase();
                                });
                            var fieldValue = formatFieldValue(info[key], fieldName);
                            
                            if (fieldValue && fieldValue !== 'N/A') {
                                // Special formatting for code fields
                                var isCode = key.includes('code') ||
                                    key.includes('lean') ||
                                    key.includes('statement');
                                
                                html += '<div class="field-group">';
                                html += '<div class="field-name">' + fieldName +
                                    '</div>';
                                html += '<div class="field-value' +
                                    (isCode ? ' code' : '') + '">' +
                                    fieldValue + '</div>';
                                html += '</div>';
                            }
                        }
                        
                        document.getElementById('info-content')
                            .innerHTML = html;
                    }
                }
            });
            
            // Toggle panel function
            function togglePanel() {
                var panel = document.getElementById('info-panel');
                panel.classList.toggle('hidden');
                
                // Resize network when panel is toggled
                setTimeout(function() {
                    network.fit();
                }, 300);
            }
            
            // Initial network fit
            network.once('stabilized', function() {
                network.fit();
            });
            
            // Resizable panels functionality
            function makeResizable() {
                const verticalResizer = document.getElementById('vertical-resizer');
                const horizontalResizer = document.getElementById('horizontal-resizer');
                const proofPanel = document.getElementById('proof-str-panel');
                const graphContainer = document.getElementById('graph-container');
                const infoPanel = document.getElementById('info-panel');
                const leftPanel = document.getElementById('left-panel');
                
                let isVerticalResizing = false;
                let isHorizontalResizing = false;
                
                // Vertical resizer (between proof panel and graph)
                verticalResizer.addEventListener('mousedown', function(e) {
                    isVerticalResizing = true;
                    document.addEventListener('mousemove', verticalResize);
                    document.addEventListener('mouseup', stopVerticalResize);
                    e.preventDefault();
                });
                
                function verticalResize(e) {
                    if (!isVerticalResizing) return;
                    
                    const containerHeight = leftPanel.offsetHeight;
                    const newHeight = e.clientY - leftPanel.offsetTop;
                    const minHeight = 100;
                    const maxHeight = containerHeight - 100;
                    
                    if (newHeight >= minHeight && newHeight <= maxHeight) {
                        proofPanel.style.height = newHeight + 'px';
                        graphContainer.style.height = (containerHeight - newHeight) + 'px';
                        network.fit();
                    }
                }
                
                function stopVerticalResize() {
                    isVerticalResizing = false;
                    document.removeEventListener('mousemove', verticalResize);
                    document.removeEventListener('mouseup', stopVerticalResize);
                }
                
                // Horizontal resizer (between left and right panels)
                horizontalResizer.addEventListener('mousedown', function(e) {
                    isHorizontalResizing = true;
                    document.addEventListener('mousemove', horizontalResize);
                    document.addEventListener('mouseup', stopHorizontalResize);
                    e.preventDefault();
                });
                
                function horizontalResize(e) {
                    if (!isHorizontalResizing) return;
                    
                    const containerWidth = document.querySelector('.container').offsetWidth;
                    const newWidth = e.clientX - leftPanel.offsetLeft;
                    const minWidth = 300;
                    const maxWidth = containerWidth - 300;
                    
                    if (newWidth >= minWidth && newWidth <= maxWidth) {
                        leftPanel.style.flex = 'none';
                        leftPanel.style.width = newWidth + 'px';
                        infoPanel.style.width = (containerWidth - newWidth) + 'px';
                        network.fit();
                    }
                }
                
                function stopHorizontalResize() {
                    isHorizontalResizing = false;
                    document.removeEventListener('mousemove', horizontalResize);
                    document.removeEventListener('mouseup', stopHorizontalResize);
                }
            }
            
            // Initialize resizable panels
            makeResizable();
        </script>
    </body>
    </html>
    