
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Proof Graph Visualization</title>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
        <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.css" rel="stylesheet" type="text/css" />
        <style>
            body {
                margin: 0;
                padding: 0;
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
                height: 100vh;
                overflow: hidden;
            }
            
            .container {
                display: flex;
                height: 100vh;
                background: #f0f0f0;
            }
            
            #left-panel {
                flex: 1;
                display: flex;
                flex-direction: column;
                background: white;
                border-right: 2px solid #ddd;
                height: 100vh;
                overflow: hidden;
            }
            
            #proof-str-panel {
                background: #f8f9fa;
                border-bottom: 2px solid #ddd;
                padding: 15px;
                height: 200px;
                overflow-y: auto;
                flex-shrink: 0;
            }
            
            #proof-str-title {
                font-weight: 600;
                color: #2d3748;
                margin-bottom: 10px;
                font-size: 14px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
            
            #proof-str-content {
                color: #4a5568;
                line-height: 1.6;
                white-space: pre-wrap;
                word-wrap: break-word;
                font-family: 'Monaco', 'Courier New', monospace;
                font-size: 13px;
                background: white;
                padding: 12px;
                border-radius: 4px;
                border: 1px solid #e2e8f0;
            }
            
            #graph-container {
                flex: 1;
                position: relative;
                background: white;
                min-height: 0;
                overflow: hidden;
            }
            
            #mynetwork {
                width: 100%;
                height: 100%;
            }
            
            #info-panel {
                width: 40%;
                max-width: 600px;
                background: white;
                overflow-y: auto;
                padding: 20px;
                box-shadow: -2px 0 10px rgba(0,0,0,0.1);
            }
            
            #info-panel.hidden {
                display: none;
            }
            
            .info-header {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                padding: 15px;
                border-radius: 8px;
                margin-bottom: 20px;
            }
            
            .info-header h2 {
                margin: 0;
                font-size: 24px;
            }
            
            .info-header .node-type {
                opacity: 0.9;
                font-size: 14px;
                margin-top: 5px;
            }
            
            .field-group {
                background: #f8f9fa;
                border-left: 4px solid #667eea;
                padding: 15px;
                margin-bottom: 15px;
                border-radius: 4px;
            }
            
            .field-name {
                font-weight: 600;
                color: #2d3748;
                margin-bottom: 8px;
                font-size: 14px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
            
            .field-value {
                color: #4a5568;
                line-height: 1.6;
                white-space: pre-wrap;
                word-wrap: break-word;
                font-family: 'Monaco', 'Courier New', monospace;
                font-size: 13px;
            }
            
            .field-value.code {
                color: #4a5568;
                padding: 12px;
                border-radius: 4px;
                overflow-x: auto;
            }
            
            .sub-dict {
                background: #ffffff;
                border: 1px solid #e2e8f0;
                border-radius: 4px;
                padding: 10px;
                margin: 8px 0;
                box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            }
            
            .sub-dict-title {
                font-weight: 600;
                color: #4a5568;
                margin-bottom: 8px;
                font-size: 12px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                border-bottom: 1px solid #e2e8f0;
                padding-bottom: 4px;
            }
            
            .sub-dict-content {
                color: #2d3748;
                line-height: 1.5;
                font-size: 12px;
            }
            
            .placeholder {
                text-align: center;
                color: #718096;
                padding: 40px;
                font-size: 18px;
            }
            
            .placeholder-icon {
                font-size: 48px;
                margin-bottom: 20px;
                opacity: 0.3;
            }
            
            #toggle-panel {
                position: absolute;
                right: 10px;
                top: 10px;
                z-index: 1000;
                background: #667eea;
                color: white;
                border: none;
                padding: 10px 20px;
                border-radius: 5px;
                cursor: pointer;
                font-size: 14px;
                transition: background 0.3s;
            }
            
            #toggle-panel:hover {
                background: #764ba2;
            }
            
            .legend {
                position: absolute;
                top: 20px;
                left: 20px;
                background: white;
                padding: 15px;
                border-radius: 8px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
                z-index: 100;
                max-width: 300px;
            }
            
            .legend-section {
                margin-bottom: 15px;
            }
            
            .legend-section:last-child {
                margin-bottom: 0;
            }
            
            .legend-title {
                font-weight: 600;
                font-size: 12px;
                color: #2d3748;
                margin-bottom: 8px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                border-bottom: 1px solid #e2e8f0;
                padding-bottom: 4px;
            }
            
            .legend-item {
                display: flex;
                align-items: center;
                margin-bottom: 8px;
            }
            
            .legend-item:last-child {
                margin-bottom: 0;
            }
            
            .legend-color {
                width: 20px;
                height: 20px;
                margin-right: 10px;
                border-radius: 3px;
            }
            
            .resizer {
                background: #ddd;
                cursor: col-resize;
                width: 4px;
                height: 100%;
                position: absolute;
                right: 0;
                top: 0;
                z-index: 1000;
            }
            
            .resizer:hover {
                background: #bbb;
            }
            
            .resizer-vertical {
                background: #ddd;
                cursor: row-resize;
                height: 4px;
                width: 100%;
                position: absolute;
                bottom: 0;
                left: 0;
                z-index: 1000;
            }
            
            .resizer-vertical:hover {
                background: #bbb;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div id="left-panel">
                <div id="proof-str-panel">
                    <div id="proof-str-title">Informal theorem and proof</div>
                    <div id="proof-str-content">Theorem: If $(A,N)$ is a normed vector space$,$ then
\begin{equation} \label{eq:8.1.1}
\rho(x,y)=N(x-y)
\end{equation}
is a metric on $A.$

Proof: From \part{a} with $u=x-y$, $\rho(x,y)=N(x-y)\ge0$, with equality
if and only if $x=y$.  From \part{b} with $u=x-y$   and $a=-1$,
$$
\rho(y,x)=N(y-x)=N(-(x-y))=N(x-y)=\rho(x,y).
$$
From \part{c} with $u=x-z$ and $v=z-y$,
$$
\rho(x,y)=N(x-y)\le N(x-z)+N(z-y)=\rho(x,z)+\rho(z,y).
$$
\vskip-2em
</div>
                    <div class="resizer-vertical" id="vertical-resizer"></div>
                </div>
                <div id="graph-container">
                    <button id="toggle-panel" onclick="togglePanel()">Toggle Info Panel</button>
                    <div class="legend">
                        <div class="legend-section">
                            <div class="legend-title">Node Types</div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #eba0a0;"></div>
                                <span>Theorem Conditions (tc)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #cfb795 ;"></div>
                                <span>Theorem Definitions (def)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #8dafcc;"></div>
                                <span>Lemmas (l)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #a3c2a8;"></div>
                                <span>Theorem Solutions (ts)</span>
                            </div>

                        </div>
                        <div class="legend-section">
                            <div class="legend-title">Verification Status</div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #fa2c07;"></div>
                                <span>Formalization failed</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #FFA500;"></div>
                                <span>Formalization passed</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #00ff00;"></div>
                                <span>Fully verified</span>
                            </div>
                        </div>
                    </div>
                    <div id="mynetwork"></div>
                </div>
            </div>
            
            <div class="resizer" id="horizontal-resizer"></div>
            
            <div id="info-panel">
                <div id="info-content">
                    <div class="placeholder">
                        <div class="placeholder-icon">📊</div>
                        <p>Click on a node to view its details</p>
                    </div>
                </div>
            </div>
        </div>
        
        <script type="text/javascript">
            // Store node information
            var nodeInfo = {"tc_1": {"id": "tc_1", "natural_language": "If $(A,N)$ is a normed vector space", "statement": "Premise:\n\u2022 Let (A,N) be a normed vector space, where A is a real vector space and N is a norm on A [tc_1].", "dependencies": [], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\nvariable (A : Type*) [NormedAddCommGroup A] [NormedSpace \u211d A]", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {}, "score": {"semantic_score": 0.75, "semantic_feedback": ["The Lean typeclass `[NormedSpace \u211d A]` correctly captures that A is a real vector space with the norm structure", "The natural language explicitly mentions 'N is a norm on A' as a separate entity, while Lean's `[NormedAddCommGroup A]` provides the norm implicitly through the typeclass system. The norm exists but isn't explicitly named 'N'", "The combination of `[NormedAddCommGroup A]` and `[NormedSpace \u211d A]` perfectly captures the concept of a normed vector space over the reals", "The Lean variable declaration with the appropriate typeclasses establishes the normed vector space structure as intended"]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "type": "condition"}, "def_1": {"id": "def_1", "natural_language": "$\\rho(x,y)=N(x-y)$ is a metric on $A.$", "statement": "We assume:\n\u2022 Let (A,N) be a normed vector space, where A is a real vector space and N is a norm on A [tc_1].\nDefinition:\n\u2022 A function \u03c1 is defined on A \u00d7 A by \u03c1(x,y) = N(x-y) for all x, y in A [def_1].", "dependencies": ["tc_1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem def_1 {A : Type*} [NormedAddCommGroup A] [NormedSpace \u211d A] :\n  let \u03c1 : A \u2192 A \u2192 \u211d := fun x y => \u2016x - y\u2016\n  \u2200 x y z : A, \n    (\u03c1 x y = 0 \u2194 x = y) \u2227 \n    (\u03c1 x y = \u03c1 y x) \u2227 \n    (\u03c1 x z \u2264 \u03c1 x y + \u03c1 y z) := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The Lean type classes [NormedAddCommGroup A] [NormedSpace \u211d A] correctly establish that (A,N) is a normed vector space", "The [NormedSpace \u211d A] type class correctly establishes that A is a real vector space", "The [NormedAddCommGroup A] type class correctly establishes that there is a norm on A (denoted by \u2016\u00b7\u2016 in Lean)", "The definition 'let \u03c1 : A \u2192 A \u2192 \u211d := fun x y => \u2016x - y\u2016' correctly captures the function \u03c1(x,y) = N(x-y), where \u2016\u00b7\u2016 represents the norm N", "The Lean theorem proves additional metric properties of \u03c1 that are not mentioned in the natural language but are logically consistent and follow from the definition. These extra properties do not contradict the natural language statement"]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "type": "definition"}, "l1": {"id": "l1", "natural_language": "From \\part{a} with $u=x-y$, $\\rho(x,y)=N(x-y)\\ge0$, with equality if and only if $x=y$.", "statement": "We assume:\n\u2022 (A,N) is a normed vector space [tc_1], which implies property (a) of norms: for all u in A, N(u) \u2265 0, with equality N(u) = 0 if and only if u = 0.\n\u2022 A function \u03c1 is defined on A \u00d7 A by \u03c1(x,y) = N(x-y) for all x, y in A [def_1].\nTherefore, we conclude:\n\u2022 For all x, y in A, \u03c1(x,y) \u2265 0, and (\u03c1(x,y) = 0 if and only if x = y) [l1].", "dependencies": ["tc_1", "def_1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l1 \n  {A : Type*} [NormedAddCommGroup A] [NormedSpace \u211d A]\n  (tc_1 : \u2200 u : A, \u2016u\u2016 \u2265 0 \u2227 (\u2016u\u2016 = 0 \u2194 u = 0)) :\n  let \u03c1 : A \u2192 A \u2192 \u211d := fun x y => \u2016x - y\u2016\n  \u2200 x y : A, \u03c1 x y \u2265 0 \u2227 (\u03c1 x y = 0 \u2194 x = y) := by sorry", "lean_pass": true, "error_msg": [], "tries": 2}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l1 \n  {A : Type*} [NormedAddCommGroup A] [NormedSpace \u211d A]\n  (tc_1 : \u2200 u : A, \u2016u\u2016 \u2265 0 \u2227 (\u2016u\u2016 = 0 \u2194 u = 0)) :\n  let \u03c1 : A \u2192 A \u2192 \u211d := fun x y => \u2016x - y\u2016\n  \u2200 x y : A, \u03c1 x y \u2265 0 \u2227 (\u03c1 x y = 0 \u2194 x = y) := by\n  intro \u03c1 x y\n  have h_nonneg : \u03c1 x y \u2265 0 := by\n    -- Prove that \u03c1 x y \u2265 0 using the property of the norm\n    dsimp only [\u03c1]\n    exact norm_nonneg (x - y)\n  \n  have h_zero_iff : (\u03c1 x y = 0 \u2194 x = y) := by\n    dsimp only [\u03c1]\n    constructor\n    \u00b7 -- Prove the forward direction: if \u2016x - y\u2016 = 0, then x = y\n      intro h\n      have h\u2081 : \u2016x - y\u2016 = 0 := h\n      have h\u2082 : x - y = 0 := by\n        -- Use the property of the norm to show that x - y = 0\n        have h\u2083 : \u2016x - y\u2016 = 0 := h\u2081\n        have h\u2084 : \u2016x - y\u2016 = 0 \u2194 x - y = 0 := by\n          apply Iff.intro\n          \u00b7 intro h\u2085\n            have h\u2086 := (tc_1 (x - y)).2\n            simp_all\n          \u00b7 intro h\u2085\n            simp [h\u2085]\n            <;>\n            (try simp_all) <;>\n            (try linarith) <;>\n            (try simp_all [norm_eq_zero]) <;>\n            (try aesop)\n        have h\u2085 := h\u2084.mp h\u2083\n        exact h\u2085\n      -- Since x - y = 0, we have x = y\n      have h\u2083 : x = y := by\n        have h\u2084 : x - y = 0 := h\u2082\n        have h\u2085 : x = y := by\n          -- Use the fact that x - y = 0 to show x = y\n          apply eq_of_sub_eq_zero\n          simpa using h\u2084\n        exact h\u2085\n      exact h\u2083\n    \u00b7 -- Prove the reverse direction: if x = y, then \u2016x - y\u2016 = 0\n      intro h\n      have h\u2081 : x = y := h\n      have h\u2082 : x - y = 0 := by\n        -- Substitute x = y into x - y\n        rw [h\u2081]\n        simp\n      -- Since x - y = 0, we have \u2016x - y\u2016 = 0\n      have h\u2083 : \u2016x - y\u2016 = 0 := by\n        rw [h\u2082]\n        simp\n      exact h\u2083\n  \n  exact \u27e8h_nonneg, h_zero_iff\u27e9", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The normed vector space structure is correctly represented using appropriate Mathlib typeclass instances", "The norm properties are correctly captured, though the explicit assumption tc_1 is technically redundant since these properties are already implied by NormedAddCommGroup", "The function \u03c1 definition perfectly translates the mathematical definition \u03c1(x,y) = N(x-y) using Lean's function syntax", "The conclusion statement correctly captures both the non-negativity and the equivalence condition for \u03c1(x,y) = 0"]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "lemma"}, "l2": {"id": "l2", "natural_language": "From \\part{b} with $u=x-y$ and $a=-1$,\n$$\n\\rho(y,x)=N(y-x)=N(-(x-y))=N(x-y)=\\rho(x,y).\n$$", "statement": "We assume:\n\u2022 (A,N) is a normed vector space [tc_1], which implies property (b) of norms: for all u in A and any scalar a, N(au) = |a|N(u).\n\u2022 A function \u03c1 is defined on A \u00d7 A by \u03c1(x,y) = N(x-y) for all x, y in A [def_1].\n\u2022 For all x, y in A, \u03c1(x,y) \u2265 0, and (\u03c1(x,y) = 0 if and only if x = y) [l1].\nTherefore, we conclude:\n\u2022 For all x, y in A, \u03c1(y,x) = \u03c1(x,y) [l2].", "dependencies": ["tc_1", "def_1", "l1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l2 \n  {A : Type*} [NormedAddCommGroup A] [NormedSpace \u211d A]\n  (\u03c1 : A \u2192 A \u2192 \u211d)\n  (h_\u03c1 : \u2200 x y : A, \u03c1 x y = \u2016x - y\u2016)\n  (l1 : \u2200 x y : A, \u03c1 x y \u2265 0 \u2227 (\u03c1 x y = 0 \u2194 x = y)) :\n  \u2200 x y : A, \u03c1 y x = \u03c1 x y := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l2 \n  {A : Type*} [NormedAddCommGroup A] [NormedSpace \u211d A]\n  (\u03c1 : A \u2192 A \u2192 \u211d)\n  (h_\u03c1 : \u2200 x y : A, \u03c1 x y = \u2016x - y\u2016)\n  (l1 : \u2200 x y : A, \u03c1 x y \u2265 0 \u2227 (\u03c1 x y = 0 \u2194 x = y)) :\n  \u2200 x y : A, \u03c1 y x = \u03c1 x y := by\n  have h_main : \u2200 (x y : A), \u03c1 y x = \u03c1 x y := by\n    intro x y\n    have h1 : \u03c1 y x = \u2016y - x\u2016 := by\n      rw [h_\u03c1]\n    have h2 : \u03c1 x y = \u2016x - y\u2016 := by\n      rw [h_\u03c1]\n    have h3 : \u2016y - x\u2016 = \u2016x - y\u2016 := by\n      have h4 : y - x = -(x - y) := by\n        abel\n      rw [h4]\n      -- Use the property of norms that \u2016-u\u2016 = \u2016u\u2016\n      rw [norm_neg]\n    rw [h1, h2, h3]\n  exact h_main", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 0, "semantic_feedback": ["The Lean formalization correctly captures the normed vector space structure. Using NormedAddCommGroup and NormedSpace over reals is the appropriate way to represent a normed vector space in Lean.", "The function definition is correctly formalized. The natural language defines \u03c1(x,y) = N(x-y), and Lean represents this as \u03c1 x y = \u2016x - y\u2016, where \u2016\u00b7\u2016 is the standard norm notation in Lean.", "The properties from l1 are perfectly captured. Both the non-negativity (\u03c1(x,y) \u2265 0) and the positive definiteness (\u03c1(x,y) = 0 \u2194 x = y) are correctly formalized using conjunction (\u2227) and biconditional (\u2194).", "The conclusion l2 about symmetry is correctly stated. The property \u03c1(y,x) = \u03c1(x,y) is faithfully represented in Lean syntax.", "The norm property (b) is implicitly included in the NormedSpace typeclass, which automatically provides the homogeneity property \u2016a \u2022 u\u2016 = |a| * \u2016u\u2016. This is mathematically equivalent to the stated property.", "Wrong dependencies in Lean4 tactics!"]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "lemma"}, "l3": {"id": "l3", "natural_language": "From \\part{c} with $u=x-z$ and $v=z-y$,\n$$\n\\rho(x,y)=N(x-y)\\le N(x-z)+N(z-y)=\\rho(x,z)+\\rho(z,y).\n$$", "statement": "We assume:\n\u2022 (A,N) is a normed vector space [tc_1], which implies property (c) of norms: for all u, v in A, N(u+v) \u2264 N(u) + N(v).\n\u2022 A function \u03c1 is defined on A \u00d7 A by \u03c1(x,y) = N(x-y) for all x, y in A [def_1].\n\u2022 For all x, y in A, \u03c1(x,y) \u2265 0, and (\u03c1(x,y) = 0 if and only if x = y) [l1].\n\u2022 For all x, y in A, \u03c1(y,x) = \u03c1(x,y) [l2].\nTherefore, we conclude:\n\u2022 For all x, y, z in A, \u03c1(x,y) \u2264 \u03c1(x,z) + \u03c1(z,y) [l3].", "dependencies": ["tc_1", "def_1", "l1", "l2"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l3\n  {A : Type*} [NormedAddCommGroup A] [NormedSpace \u211d A]\n  (\u03c1 : A \u2192 A \u2192 \u211d)\n  (h_\u03c1 : \u2200 x y : A, \u03c1 x y = \u2016x - y\u2016)\n  (l1 : \u2200 x y : A, \u03c1 x y \u2265 0 \u2227 (\u03c1 x y = 0 \u2194 x = y))\n  (l2 : \u2200 x y : A, \u03c1 y x = \u03c1 x y)\n  (tc_1 : \u2200 u v : A, \u2016u + v\u2016 \u2264 \u2016u\u2016 + \u2016v\u2016) :\n  \u2200 x y z : A, \u03c1 x y \u2264 \u03c1 x z + \u03c1 z y := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l3\n  {A : Type*} [NormedAddCommGroup A] [NormedSpace \u211d A]\n  (\u03c1 : A \u2192 A \u2192 \u211d)\n  (h_\u03c1 : \u2200 x y : A, \u03c1 x y = \u2016x - y\u2016)\n  (l1 : \u2200 x y : A, \u03c1 x y \u2265 0 \u2227 (\u03c1 x y = 0 \u2194 x = y))\n  (l2 : \u2200 x y : A, \u03c1 y x = \u03c1 x y)\n  (tc_1 : \u2200 u v : A, \u2016u + v\u2016 \u2264 \u2016u\u2016 + \u2016v\u2016) :\n  \u2200 x y z : A, \u03c1 x y \u2264 \u03c1 x z + \u03c1 z y := by\n  intro x y z\n  have h_sum : (x - z) + (z - y) = x - y := by\n    abel\n    <;> simp [sub_eq_add_neg]\n    <;> abel\n  \n  have h_norm : \u2016x - y\u2016 = \u2016(x - z) + (z - y)\u2016 := by\n    rw [h_sum]\n    <;>\n    simp [h_\u03c1]\n    <;>\n    ring_nf\n    <;>\n    simp_all [h_\u03c1]\n    <;>\n    linarith\n  \n  have h_triangle : \u2016(x - z) + (z - y)\u2016 \u2264 \u2016x - z\u2016 + \u2016z - y\u2016 := by\n    have h\u2081 : \u2016(x - z) + (z - y)\u2016 \u2264 \u2016x - z\u2016 + \u2016z - y\u2016 := by\n      -- Use the triangle inequality for norms\n      calc\n        \u2016(x - z) + (z - y)\u2016 \u2264 \u2016x - z\u2016 + \u2016z - y\u2016 := by\n          -- Apply the given triangle inequality property `tc_1`\n          have h\u2082 := tc_1 (x - z) (z - y)\n          simpa using h\u2082\n        _ = \u2016x - z\u2016 + \u2016z - y\u2016 := by rfl\n    -- The result follows directly from the calculation above\n    exact h\u2081\n  \n  have h_combined : \u2016x - y\u2016 \u2264 \u2016x - z\u2016 + \u2016z - y\u2016 := by\n    calc\n      \u2016x - y\u2016 = \u2016(x - z) + (z - y)\u2016 := by rw [h_norm]\n      _ \u2264 \u2016x - z\u2016 + \u2016z - y\u2016 := h_triangle\n  \n  have h_final : \u03c1 x y \u2264 \u03c1 x z + \u03c1 z y := by\n    have h\u2081 : \u03c1 x y = \u2016x - y\u2016 := by rw [h_\u03c1]\n    have h\u2082 : \u03c1 x z = \u2016x - z\u2016 := by rw [h_\u03c1]\n    have h\u2083 : \u03c1 z y = \u2016z - y\u2016 := by\n      have h\u2084 : \u03c1 z y = \u2016z - y\u2016 := by rw [h_\u03c1]\n      exact h\u2084\n    rw [h\u2081, h\u2082, h\u2083]\n    exact h_combined\n  \n  exact h_final", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 0, "semantic_feedback": ["The Lean formalization correctly captures the normed vector space structure using appropriate type classes. The use of NormedAddCommGroup and NormedSpace over reals is the standard way to represent this in Lean.", "The triangle inequality property is correctly formalized using the norm notation \u2016\u00b7\u2016, which directly corresponds to the norm N mentioned in natural language.", "The function definition is accurately captured as a hypothesis stating the relationship between \u03c1 and the norm of differences.", "Both the non-negativity condition and the equivalence between zero distance and equality are correctly formalized using conjunction and biconditional.", "The symmetry property is precisely captured with the correct variable order matching the natural language statement.", "The conclusion (triangle inequality for \u03c1) is correctly stated as the theorem goal, maintaining the exact logical structure from the natural language.", "Wrong dependencies in Lean4 tactics!"]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "lemma"}, "ts_1": {"id": "ts_1", "natural_language": "From \\part{a} with $u=x-y$, $\\rho(x,y)=N(x-y)\\ge0$, with equality\nif and only if $x=y$.  From \\part{b} with $u=x-y$   and $a=-1$,\n$$\n\\rho(y,x)=N(y-x)=N(-(x-y))=N(x-y)=\\rho(x,y).\n$$\nFrom \\part{c} with $u=x-z$ and $v=z-y$,\n$$\n\\rho(x,y)=N(x-y)\\le N(x-z)+N(z-y)=\\rho(x,z)+\\rho(z,y).\n$$", "statement": "We assume:\n\u2022 (A,N) is a normed vector space [tc_1].\n\u2022 A function \u03c1 is defined on A \u00d7 A by \u03c1(x,y) = N(x-y) for all x, y in A [def_1].\n\u2022 For all x, y in A, \u03c1(x,y) \u2265 0, and (\u03c1(x,y) = 0 if and only if x = y) [l1].\n\u2022 For all x, y in A, \u03c1(y,x) = \u03c1(x,y) [l2].\n\u2022 For all x, y, z in A, \u03c1(x,y) \u2264 \u03c1(x,z) + \u03c1(z,y) [l3].\nTherefore, we conclude:\n\u2022 The function \u03c1 is a metric on A [ts_1].", "dependencies": ["tc_1", "def_1", "l1", "l2", "l3"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem ts_1\n  {A : Type*} [NormedAddCommGroup A] [NormedSpace \u211d A]\n  (\u03c1 : A \u2192 A \u2192 \u211d)\n  (h_\u03c1 : \u2200 x y : A, \u03c1 x y = \u2016x - y\u2016)\n  (l1 : \u2200 x y : A, \u03c1 x y \u2265 0 \u2227 (\u03c1 x y = 0 \u2194 x = y))\n  (l2 : \u2200 x y : A, \u03c1 y x = \u03c1 x y)\n  (l3 : \u2200 x y z : A, \u03c1 x y \u2264 \u03c1 x z + \u03c1 z y) :\n  -- \u03c1 satisfies the metric axioms\n  (\u2200 x y : A, \u03c1 x y \u2265 0 \u2227 (\u03c1 x y = 0 \u2194 x = y)) \u2227\n  (\u2200 x y : A, \u03c1 y x = \u03c1 x y) \u2227\n  (\u2200 x y z : A, \u03c1 x y \u2264 \u03c1 x z + \u03c1 z y) := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem ts_1\n  {A : Type*} [NormedAddCommGroup A] [NormedSpace \u211d A]\n  (\u03c1 : A \u2192 A \u2192 \u211d)\n  (h_\u03c1 : \u2200 x y : A, \u03c1 x y = \u2016x - y\u2016)\n  (l1 : \u2200 x y : A, \u03c1 x y \u2265 0 \u2227 (\u03c1 x y = 0 \u2194 x = y))\n  (l2 : \u2200 x y : A, \u03c1 y x = \u03c1 x y)\n  (l3 : \u2200 x y z : A, \u03c1 x y \u2264 \u03c1 x z + \u03c1 z y) :\n  (\u2200 x y : A, \u03c1 x y \u2265 0 \u2227 (\u03c1 x y = 0 \u2194 x = y)) \u2227\n  (\u2200 x y : A, \u03c1 y x = \u03c1 x y) \u2227\n  (\u2200 x y z : A, \u03c1 x y \u2264 \u03c1 x z + \u03c1 z y) := by\n  have h_main : (\u2200 x y : A, \u03c1 x y \u2265 0 \u2227 (\u03c1 x y = 0 \u2194 x = y)) \u2227 (\u2200 x y : A, \u03c1 y x = \u03c1 x y) \u2227 (\u2200 x y z : A, \u03c1 x y \u2264 \u03c1 x z + \u03c1 z y) := by\n    refine' \u27e8_, _, _\u27e9\n    \u00b7 -- Prove the first part: \u2200 x y : A, \u03c1 x y \u2265 0 \u2227 (\u03c1 x y = 0 \u2194 x = y)\n      exact l1\n    \u00b7 -- Prove the second part: \u2200 x y : A, \u03c1 y x = \u03c1 x y\n      exact l2\n    \u00b7 -- Prove the third part: \u2200 x y z : A, \u03c1 x y \u2264 \u03c1 x z + \u03c1 z y\n      exact l3\n  \n  exact h_main", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The Lean formalization accurately captures all components of the natural language statement. The normed vector space structure is properly encoded, the function \u03c1 is correctly defined in terms of the norm, all three metric axioms (non-negativity with zero iff equal, symmetry, and triangle inequality) are faithfully translated, and the conclusion correctly identifies these as the defining properties of a metric. The formalization is mathematically sound and complete."]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "solution"}};
            
            // Create nodes and edges
            var nodes = new vis.DataSet([{"id": "tc_1", "label": "tc_1", "color": {"background": "#eba0a0", "border": "#00ff00", "highlight": {"background": "#eba0a0", "border": "#00ff00"}}, "shape": "box", "size": 30, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "def_1", "label": "def_1", "color": {"background": "#cfb795", "border": "#00ff00", "highlight": {"background": "#cfb795", "border": "#00ff00"}}, "shape": "box", "size": 30, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l1", "label": "l1", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l2", "label": "l2", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l3", "label": "l3", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "ts_1", "label": "ts_1", "color": {"background": "#a3c2a8", "border": "#00ff00", "highlight": {"background": "#a3c2a8", "border": "#00ff00"}}, "shape": "star", "size": 40, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}]);
            var edges = new vis.DataSet([{"from": "tc_1", "to": "def_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "l1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "l2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "l3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_1", "to": "l1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_1", "to": "l2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_1", "to": "l3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_1", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "l2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "l3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l2", "to": "l3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l2", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l3", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}]);
            
            // Create network
            var container = document.getElementById('mynetwork');
            var data = {
                nodes: nodes,
                edges: edges
            };
            
            var options = {
                physics: {
                    enabled: true,
                    solver: 'hierarchicalRepulsion',
                    hierarchicalRepulsion: {
                        centralGravity: 0.0,
                        springLength: 200,
                        springConstant: 0.01,
                        nodeDistance: 150,
                        damping: 0.09
                    }
                },
                edges: {
                    smooth: {
                        type: 'continuous',
                        forceDirection: 'none'
                    },
                    color: {
                        color: '#666666',
                        highlight: '#666666',
                        hover: '#666666'
                    },
                    width: 2
                },
                interaction: {
                    hover: true,
                    tooltipDelay: 100,
                    navigationButtons: true,
                    keyboard: true
                },
                nodes: {
                    font: {
                        size: 14,
                        color: '#000000'
                    },
                    labelHighlightBold: false,
                    chosen: false,
                    shapeProperties: {
                        useBorderWithImage: false
                    },
                    scaling: {
                        label: {
                            enabled: true,
                            min: 8,
                            max: 20,
                            maxVisible: 20,
                            drawThreshold: 5
                        }
                    }
                }
            };
            
            var network = new vis.Network(container, data, options);
            
            // Format field value for display
            function formatFieldValue(value, fieldName) {
                if (value === null || value === undefined) {
                    return 'N/A';
                }
                
                // Handle objects (dictionaries) as sub-boxes
                if (typeof value === 'object' && !Array.isArray(value)) {
                    var html = '';
                    for (var key in value) {
                        if (value.hasOwnProperty(key)) {
                            var subValue = value[key];
                            var subValueStr = '';
                            
                            if (typeof subValue === 'object' &&
                                    !Array.isArray(subValue)) {
                                // Nested object - show as JSON
                                subValueStr = JSON.stringify(subValue, null, 2);
                            } else if (Array.isArray(subValue)) {
                                // Array - show as JSON
                                subValueStr = JSON.stringify(subValue, null, 2);
                            } else {
                                // Primitive value
                                subValueStr = String(subValue);
                            }
                            
                            // Replace escaped newlines and tabs with actual characters
                            subValueStr = subValueStr.replace(/\\n/g, '\n');
                            subValueStr = subValueStr.replace(/\\t/g, '\t');
                            subValueStr = subValueStr.replace(/\t/g, '\t');
                            
                            html += '<div class="sub-dict">';
                            html += '<div class="sub-dict-title">' + key + '</div>';
                            html += '<div class="sub-dict-content">' + subValueStr + '</div>';
                            html += '</div>';
                        }
                    }
                    return html;
                }
                
                // Convert to string for primitive values and arrays
                var strValue = String(value);
                
                // Handle arrays
                if (Array.isArray(value)) {
                    strValue = JSON.stringify(value, null, 2);
                }
                
                // Replace escaped newlines and tabs with actual characters
                strValue = strValue.replace(/\\n/g, '\n');
                strValue = strValue.replace(/\\t/g, '\t');
                strValue = strValue.replace(/\t/g, '\t');
                
                return strValue;
            }
            
            // Handle node click events
            network.on("click", function(params) {
                if (params.nodes.length > 0) {
                    var nodeId = params.nodes[0];
                    var info = nodeInfo[nodeId];
                    
                    if (info) {
                        var html = '<div class="info-header">';
                        html += '<h2>' + nodeId + '</h2>';
                        var nodeType = info.type || 'unknown';
                        var capitalizedType = nodeType.charAt(0).toUpperCase() +
                            nodeType.slice(1);
                        html += '<div class="node-type">Type: ' + capitalizedType +
                            '</div>';
                        html += '</div>';
                        
                        // Add all fields
                        for (var key in info) {
                            if (key === 'type' || key === 'id') continue;
                            
                            var fieldName = key.replace(/_/g, ' ')
                                .replace(/\b\w/g, function(l) {
                                    return l.toUpperCase();
                                });
                            var fieldValue = formatFieldValue(info[key], fieldName);
                            
                            if (fieldValue && fieldValue !== 'N/A') {
                                // Special formatting for code fields
                                var isCode = key.includes('code') ||
                                    key.includes('lean') ||
                                    key.includes('statement');
                                
                                html += '<div class="field-group">';
                                html += '<div class="field-name">' + fieldName +
                                    '</div>';
                                html += '<div class="field-value' +
                                    (isCode ? ' code' : '') + '">' +
                                    fieldValue + '</div>';
                                html += '</div>';
                            }
                        }
                        
                        document.getElementById('info-content')
                            .innerHTML = html;
                    }
                }
            });
            
            // Toggle panel function
            function togglePanel() {
                var panel = document.getElementById('info-panel');
                panel.classList.toggle('hidden');
                
                // Resize network when panel is toggled
                setTimeout(function() {
                    network.fit();
                }, 300);
            }
            
            // Initial network fit
            network.once('stabilized', function() {
                network.fit();
            });
            
            // Resizable panels functionality
            function makeResizable() {
                const verticalResizer = document.getElementById('vertical-resizer');
                const horizontalResizer = document.getElementById('horizontal-resizer');
                const proofPanel = document.getElementById('proof-str-panel');
                const graphContainer = document.getElementById('graph-container');
                const infoPanel = document.getElementById('info-panel');
                const leftPanel = document.getElementById('left-panel');
                
                let isVerticalResizing = false;
                let isHorizontalResizing = false;
                
                // Vertical resizer (between proof panel and graph)
                verticalResizer.addEventListener('mousedown', function(e) {
                    isVerticalResizing = true;
                    document.addEventListener('mousemove', verticalResize);
                    document.addEventListener('mouseup', stopVerticalResize);
                    e.preventDefault();
                });
                
                function verticalResize(e) {
                    if (!isVerticalResizing) return;
                    
                    const containerHeight = leftPanel.offsetHeight;
                    const newHeight = e.clientY - leftPanel.offsetTop;
                    const minHeight = 100;
                    const maxHeight = containerHeight - 100;
                    
                    if (newHeight >= minHeight && newHeight <= maxHeight) {
                        proofPanel.style.height = newHeight + 'px';
                        graphContainer.style.height = (containerHeight - newHeight) + 'px';
                        network.fit();
                    }
                }
                
                function stopVerticalResize() {
                    isVerticalResizing = false;
                    document.removeEventListener('mousemove', verticalResize);
                    document.removeEventListener('mouseup', stopVerticalResize);
                }
                
                // Horizontal resizer (between left and right panels)
                horizontalResizer.addEventListener('mousedown', function(e) {
                    isHorizontalResizing = true;
                    document.addEventListener('mousemove', horizontalResize);
                    document.addEventListener('mouseup', stopHorizontalResize);
                    e.preventDefault();
                });
                
                function horizontalResize(e) {
                    if (!isHorizontalResizing) return;
                    
                    const containerWidth = document.querySelector('.container').offsetWidth;
                    const newWidth = e.clientX - leftPanel.offsetLeft;
                    const minWidth = 300;
                    const maxWidth = containerWidth - 300;
                    
                    if (newWidth >= minWidth && newWidth <= maxWidth) {
                        leftPanel.style.flex = 'none';
                        leftPanel.style.width = newWidth + 'px';
                        infoPanel.style.width = (containerWidth - newWidth) + 'px';
                        network.fit();
                    }
                }
                
                function stopHorizontalResize() {
                    isHorizontalResizing = false;
                    document.removeEventListener('mousemove', horizontalResize);
                    document.removeEventListener('mouseup', stopHorizontalResize);
                }
            }
            
            // Initialize resizable panels
            makeResizable();
        </script>
    </body>
    </html>
    