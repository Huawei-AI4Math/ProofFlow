
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Proof Graph Visualization</title>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
        <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.css" rel="stylesheet" type="text/css" />
        <style>
            body {
                margin: 0;
                padding: 0;
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
                height: 100vh;
                overflow: hidden;
            }
            
            .container {
                display: flex;
                height: 100vh;
                background: #f0f0f0;
            }
            
            #left-panel {
                flex: 1;
                display: flex;
                flex-direction: column;
                background: white;
                border-right: 2px solid #ddd;
                height: 100vh;
                overflow: hidden;
            }
            
            #proof-str-panel {
                background: #f8f9fa;
                border-bottom: 2px solid #ddd;
                padding: 15px;
                height: 200px;
                overflow-y: auto;
                flex-shrink: 0;
            }
            
            #proof-str-title {
                font-weight: 600;
                color: #2d3748;
                margin-bottom: 10px;
                font-size: 14px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
            
            #proof-str-content {
                color: #4a5568;
                line-height: 1.6;
                white-space: pre-wrap;
                word-wrap: break-word;
                font-family: 'Monaco', 'Courier New', monospace;
                font-size: 13px;
                background: white;
                padding: 12px;
                border-radius: 4px;
                border: 1px solid #e2e8f0;
            }
            
            #graph-container {
                flex: 1;
                position: relative;
                background: white;
                min-height: 0;
                overflow: hidden;
            }
            
            #mynetwork {
                width: 100%;
                height: 100%;
            }
            
            #info-panel {
                width: 40%;
                max-width: 600px;
                background: white;
                overflow-y: auto;
                padding: 20px;
                box-shadow: -2px 0 10px rgba(0,0,0,0.1);
            }
            
            #info-panel.hidden {
                display: none;
            }
            
            .info-header {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                padding: 15px;
                border-radius: 8px;
                margin-bottom: 20px;
            }
            
            .info-header h2 {
                margin: 0;
                font-size: 24px;
            }
            
            .info-header .node-type {
                opacity: 0.9;
                font-size: 14px;
                margin-top: 5px;
            }
            
            .field-group {
                background: #f8f9fa;
                border-left: 4px solid #667eea;
                padding: 15px;
                margin-bottom: 15px;
                border-radius: 4px;
            }
            
            .field-name {
                font-weight: 600;
                color: #2d3748;
                margin-bottom: 8px;
                font-size: 14px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
            
            .field-value {
                color: #4a5568;
                line-height: 1.6;
                white-space: pre-wrap;
                word-wrap: break-word;
                font-family: 'Monaco', 'Courier New', monospace;
                font-size: 13px;
            }
            
            .field-value.code {
                color: #4a5568;
                padding: 12px;
                border-radius: 4px;
                overflow-x: auto;
            }
            
            .sub-dict {
                background: #ffffff;
                border: 1px solid #e2e8f0;
                border-radius: 4px;
                padding: 10px;
                margin: 8px 0;
                box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            }
            
            .sub-dict-title {
                font-weight: 600;
                color: #4a5568;
                margin-bottom: 8px;
                font-size: 12px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                border-bottom: 1px solid #e2e8f0;
                padding-bottom: 4px;
            }
            
            .sub-dict-content {
                color: #2d3748;
                line-height: 1.5;
                font-size: 12px;
            }
            
            .placeholder {
                text-align: center;
                color: #718096;
                padding: 40px;
                font-size: 18px;
            }
            
            .placeholder-icon {
                font-size: 48px;
                margin-bottom: 20px;
                opacity: 0.3;
            }
            
            #toggle-panel {
                position: absolute;
                right: 10px;
                top: 10px;
                z-index: 1000;
                background: #667eea;
                color: white;
                border: none;
                padding: 10px 20px;
                border-radius: 5px;
                cursor: pointer;
                font-size: 14px;
                transition: background 0.3s;
            }
            
            #toggle-panel:hover {
                background: #764ba2;
            }
            
            .legend {
                position: absolute;
                top: 20px;
                left: 20px;
                background: white;
                padding: 15px;
                border-radius: 8px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
                z-index: 100;
                max-width: 300px;
            }
            
            .legend-section {
                margin-bottom: 15px;
            }
            
            .legend-section:last-child {
                margin-bottom: 0;
            }
            
            .legend-title {
                font-weight: 600;
                font-size: 12px;
                color: #2d3748;
                margin-bottom: 8px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                border-bottom: 1px solid #e2e8f0;
                padding-bottom: 4px;
            }
            
            .legend-item {
                display: flex;
                align-items: center;
                margin-bottom: 8px;
            }
            
            .legend-item:last-child {
                margin-bottom: 0;
            }
            
            .legend-color {
                width: 20px;
                height: 20px;
                margin-right: 10px;
                border-radius: 3px;
            }
            
            .resizer {
                background: #ddd;
                cursor: col-resize;
                width: 4px;
                height: 100%;
                position: absolute;
                right: 0;
                top: 0;
                z-index: 1000;
            }
            
            .resizer:hover {
                background: #bbb;
            }
            
            .resizer-vertical {
                background: #ddd;
                cursor: row-resize;
                height: 4px;
                width: 100%;
                position: absolute;
                bottom: 0;
                left: 0;
                z-index: 1000;
            }
            
            .resizer-vertical:hover {
                background: #bbb;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div id="left-panel">
                <div id="proof-str-panel">
                    <div id="proof-str-title">Informal theorem and proof</div>
                    <div id="proof-str-content">Theorem: Suppose~$n$ is the area of a right
triangle with rational side lengths $a, b, c$, with
$a\leq b<c$.
Let $A=(c/2)^2$.  Then
$$A-n, \quad A,\, 	ext{ and } A+n$$
are all perfect squares of rational numbers.

Proof: We have
\begin{eqnarray*}
a^2+b^2&=&c^2\\
\frac{1}{2}ab&=&n
\end{eqnarray*}
Add or subtract $4$ times the second equation to the first to get
\begin{eqnarray*}
a^2\pm2ab +b^2&=&c^2\pm 4n\\
(a\pm b)^2 &=& c^2 \pm 4n\\
\left(\frac{a\pm b}{2}\right)^2 &=&
   \left( \frac{c}{2}\right)^2 \pm n \\
  &=& A \pm n
\end{eqnarray*}
</div>
                    <div class="resizer-vertical" id="vertical-resizer"></div>
                </div>
                <div id="graph-container">
                    <button id="toggle-panel" onclick="togglePanel()">Toggle Info Panel</button>
                    <div class="legend">
                        <div class="legend-section">
                            <div class="legend-title">Node Types</div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #eba0a0;"></div>
                                <span>Theorem Conditions (tc)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #cfb795 ;"></div>
                                <span>Theorem Definitions (def)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #8dafcc;"></div>
                                <span>Lemmas (l)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #a3c2a8;"></div>
                                <span>Theorem Solutions (ts)</span>
                            </div>

                        </div>
                        <div class="legend-section">
                            <div class="legend-title">Verification Status</div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #fa2c07;"></div>
                                <span>Formalization failed</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #FFA500;"></div>
                                <span>Formalization passed</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #00ff00;"></div>
                                <span>Fully verified</span>
                            </div>
                        </div>
                    </div>
                    <div id="mynetwork"></div>
                </div>
            </div>
            
            <div class="resizer" id="horizontal-resizer"></div>
            
            <div id="info-panel">
                <div id="info-content">
                    <div class="placeholder">
                        <div class="placeholder-icon">ðŸ“Š</div>
                        <p>Click on a node to view its details</p>
                    </div>
                </div>
            </div>
        </div>
        
        <script type="text/javascript">
            // Store node information
            var nodeInfo = {"tc_1": {"id": "tc_1", "natural_language": "Suppose~$n$ is the area of a right triangle with rational side lengths $a, b, c$, with $a\\leq b<c$.", "statement": "Premise:\n\u2022 $n$ is the area of a right triangle with rational side lengths $a, b, c$, with $a \\leq b < c$ [tc_1].", "dependencies": [], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\nvariable (a b c n : \u211a)\n(tc_1 : a \u2264 b \u2227 b < c \u2227 2 * n = a * b)", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {}, "score": {"semantic_score": 0.0, "semantic_feedback": ["The natural language states that n is the area of a right triangle, but the Lean formalization uses 2 * n = a * b, which means n is half the area (since the area of a right triangle is (1/2) * base * height = (1/2) * a * b). This is a significant mathematical difference.", "The ordering constraint a \u2264 b < c is perfectly captured in the Lean formalization as 'a \u2264 b \u2227 b < c'.", "The rational number requirement is perfectly captured by declaring all variables as type \u211a (rationals) in Lean.", "The Lean formalization is missing the Pythagorean theorem constraint (a\u00b2 + b\u00b2 = c\u00b2) that defines a right triangle. The formula 2 * n = a * b only relates to the area calculation but doesn't ensure the triangle is actually a right triangle."]}, "error_report": {"error_type": "Formalizer", "error_report": "Formalization is likely incorrect: semantic score is 0.0, below threshold 0.6.\nScorer feedback: ['The natural language states that n is the area of a right triangle, but the Lean formalization uses 2 * n = a * b, which means n is half the area (since the area of a right triangle is (1/2) * base * height = (1/2) * a * b). This is a significant mathematical difference.', \"The ordering constraint a \u2264 b < c is perfectly captured in the Lean formalization as 'a \u2264 b \u2227 b < c'.\", 'The rational number requirement is perfectly captured by declaring all variables as type \u211a (rationals) in Lean.', \"The Lean formalization is missing the Pythagorean theorem constraint (a\u00b2 + b\u00b2 = c\u00b2) that defines a right triangle. The formula 2 * n = a * b only relates to the area calculation but doesn't ensure the triangle is actually a right triangle.\"]"}, "type": "condition"}, "def_1": {"id": "def_1", "natural_language": "Let $A=(c/2)^2$.", "statement": "Definition:\n\u2022 $A = (c/2)^2$ [def_1].", "dependencies": ["tc_1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem def_1 \n  (a b c n A : \u211a)\n  (h_triangle : a^2 + b^2 = c^2)\n  (h_area : n = (1/2) * a * b)\n  (h_order : a \u2264 b \u2227 b < c)\n  (h_A : A = (c/2)^2) :\n  \u2203 (x y z : \u211a), A - n = x^2 \u2227 A = y^2 \u2227 A + n = z^2 := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {}, "score": {"semantic_score": 0.0, "semantic_feedback": ["The natural language states there are no conditions since this is just a definition, but the Lean theorem introduces multiple conditions (triangle relation, area definition, ordering constraint) that are not mentioned in the natural language definition.", "The natural language presents A = (c/2)^2 as the main definition/conclusion, but the Lean theorem treats this as a hypothesis and instead concludes with an existence statement about rational numbers x, y, z with specific properties. This completely changes the logical structure from a simple definition to a theorem with a complex conclusion."]}, "error_report": {"error_type": "Formalizer", "error_report": "Formalization is likely incorrect: semantic score is 0.0, below threshold 0.6.\nScorer feedback: ['The natural language states there are no conditions since this is just a definition, but the Lean theorem introduces multiple conditions (triangle relation, area definition, ordering constraint) that are not mentioned in the natural language definition.', 'The natural language presents A = (c/2)^2 as the main definition/conclusion, but the Lean theorem treats this as a hypothesis and instead concludes with an existence statement about rational numbers x, y, z with specific properties. This completely changes the logical structure from a simple definition to a theorem with a complex conclusion.']"}, "type": "definition"}, "l1": {"id": "l1", "natural_language": "a^2+b^2=c^2", "statement": "We assume:\n\u2022 $n$ is the area of a right triangle with rational side lengths $a, b, c$, with $a \\leq b < c$ [tc_1].\n\u2022 $A = (c/2)^2$ [def_1].\nTherefore, we conclude:\n\u2022 $a^2 + b^2 = c^2$ [l1].", "dependencies": ["tc_1", "def_1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem tc1\n  (a b c n A : \u211a)\n  (h_triangle : a^2 + b^2 = c^2)\n  (h_area : n = (1/2) * a * b)\n  (h_order : a \u2264 b \u2227 b < c)\n  (h_A : A = (c/2)^2) :\n  \u2203 (x y z : \u211a), A - n = x^2 \u2227 A = y^2 \u2227 A + n = z^2 := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem tc1\n  (a b c n A : \u211a)\n  (h_triangle : a^2 + b^2 = c^2)\n  (h_area : n = (1/2) * a * b)\n  (h_order : a \u2264 b \u2227 b < c)\n  (h_A : A = (c/2)^2) :\n  \u2203 (x y z : \u211a), A - n = x^2 \u2227 A = y^2 \u2227 A + n = z^2 := by\n  have h_y : A = (c / 2 : \u211a)^2 := by\n    rw [h_A]\n    <;> norm_cast\n    <;> ring_nf\n    <;> field_simp\n    <;> ring_nf\n  \n  have h_z : A + n = ((a + b) / 2 : \u211a)^2 := by\n    have h\u2081 : A + n = (c / 2 : \u211a)^2 + n := by rw [h_y]\n    rw [h\u2081]\n    have h\u2082 : n = (1 / 2 : \u211a) * a * b := h_area\n    rw [h\u2082]\n    have h\u2083 : (c : \u211a)^2 = a^2 + b^2 := by\n      norm_cast at h_triangle \u22a2\n      <;> linarith\n    have h\u2084 : (c : \u211a) ^ 2 + 2 * a * b = (a + b) ^ 2 := by\n      calc\n        (c : \u211a) ^ 2 + 2 * a * b = a ^ 2 + b ^ 2 + 2 * a * b := by rw [h\u2083]\n        _ = (a + b) ^ 2 := by ring\n    have h\u2085 : (c : \u211a) / 2 * (c / 2 : \u211a) + (1 / 2 : \u211a) * a * b = ((a + b) / 2 : \u211a) ^ 2 := by\n      have h\u2085\u2081 : (c : \u211a) ^ 2 + 2 * a * b = (a + b) ^ 2 := h\u2084\n      have h\u2085\u2082 : (c : \u211a) / 2 * (c / 2 : \u211a) = (c : \u211a) ^ 2 / 4 := by ring\n      rw [h\u2085\u2082]\n      have h\u2085\u2083 : (c : \u211a) ^ 2 / 4 + (1 / 2 : \u211a) * a * b = ((a + b) / 2 : \u211a) ^ 2 := by\n        calc\n          (c : \u211a) ^ 2 / 4 + (1 / 2 : \u211a) * a * b = ((c : \u211a) ^ 2 + 2 * a * b) / 4 := by ring\n          _ = ((a + b) ^ 2) / 4 := by\n            rw [h\u2084]\n            <;> ring_nf\n          _ = ((a + b) / 2 : \u211a) ^ 2 := by ring\n      linarith\n    nlinarith\n  \n  have h_x : A - n = ((a - b) / 2 : \u211a)^2 := by\n    have h\u2081 : A - n = (c / 2 : \u211a)^2 - n := by\n      rw [h_y]\n      <;> ring_nf\n    rw [h\u2081]\n    have h\u2082 : n = (1 / 2 : \u211a) * a * b := h_area\n    rw [h\u2082]\n    have h\u2083 : (c : \u211a)^2 = a^2 + b^2 := by\n      norm_cast at h_triangle \u22a2\n      <;> linarith\n    have h\u2084 : (c : \u211a) ^ 2 - 2 * a * b = (a - b) ^ 2 := by\n      calc\n        (c : \u211a) ^ 2 - 2 * a * b = a ^ 2 + b ^ 2 - 2 * a * b := by rw [h\u2083]\n        _ = (a - b) ^ 2 := by ring\n    have h\u2085 : (c : \u211a) / 2 * (c / 2 : \u211a) - (1 / 2 : \u211a) * a * b = ((a - b) / 2 : \u211a) ^ 2 := by\n      have h\u2085\u2081 : (c : \u211a) ^ 2 - 2 * a * b = (a - b) ^ 2 := h\u2084\n      have h\u2085\u2082 : (c : \u211a) / 2 * (c / 2 : \u211a) = (c : \u211a) ^ 2 / 4 := by ring\n      rw [h\u2085\u2082]\n      have h\u2085\u2083 : (c : \u211a) ^ 2 / 4 - (1 / 2 : \u211a) * a * b = ((a - b) / 2 : \u211a) ^ 2 := by\n        calc\n          (c : \u211a) ^ 2 / 4 - (1 / 2 : \u211a) * a * b = ((c : \u211a) ^ 2 - 2 * a * b) / 4 := by ring\n          _ = ((a - b) ^ 2) / 4 := by\n            rw [h\u2084]\n            <;> ring_nf\n          _ = ((a - b) / 2 : \u211a) ^ 2 := by ring\n      linarith\n    nlinarith\n  \n  have h_main : \u2203 (x y z : \u211a), A - n = x^2 \u2227 A = y^2 \u2227 A + n = z^2 := by\n    refine' \u27e8(a - b) / 2, c / 2, (a + b) / 2, _, _, _\u27e9\n    \u00b7 -- Prove A - n = ((a - b) / 2)^2\n      rw [h_x]\n      <;> ring_nf\n    \u00b7 -- Prove A = (c / 2)^2\n      rw [h_y]\n      <;> ring_nf\n    \u00b7 -- Prove A + n = ((a + b) / 2)^2\n      rw [h_z]\n      <;> ring_nf\n  \n  exact h_main", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 0.0, "semantic_feedback": ["Variable declarations and rational number requirements are correctly captured", "The logical structure is fundamentally different - the natural language treats a\u00b2 + b\u00b2 = c\u00b2 as a conclusion, while Lean treats it as a hypothesis. More critically, the Lean conclusion about perfect squares is completely absent from the natural language", "The area relationship n = (1/2) * a * b is appropriately formalized, even though the natural language doesn't explicitly state the formula", "The ordering constraint a \u2264 b < c is correctly represented in both versions", "The definition A = (c/2)\u00b2 matches perfectly, but the overall theorem statement in Lean is entirely different from what the natural language describes"]}, "error_report": {"error_type": "Formalizer", "error_report": "Formalization is likely incorrect: semantic score is 0.0, below threshold 0.6.\nScorer feedback: ['Variable declarations and rational number requirements are correctly captured', 'The logical structure is fundamentally different - the natural language treats a\u00b2 + b\u00b2 = c\u00b2 as a conclusion, while Lean treats it as a hypothesis. More critically, the Lean conclusion about perfect squares is completely absent from the natural language', \"The area relationship n = (1/2) * a * b is appropriately formalized, even though the natural language doesn't explicitly state the formula\", 'The ordering constraint a \u2264 b < c is correctly represented in both versions', 'The definition A = (c/2)\u00b2 matches perfectly, but the overall theorem statement in Lean is entirely different from what the natural language describes']"}, "solved_negation": null, "type": "lemma"}, "l2": {"id": "l2", "natural_language": "\\frac{1}{2}ab=n", "statement": "We assume:\n\u2022 $n$ is the area of a right triangle with rational side lengths $a, b, c$, with $a \\leq b < c$ [tc_1].\n\u2022 $A = (c/2)^2$ [def_1].\n\u2022 $a^2 + b^2 = c^2$ [l1].\nTherefore, we conclude:\n\u2022 $\\frac{1}{2}ab = n$ [l2].", "dependencies": ["tc_1", "def_1", "l1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l2 \n  (a b c n : \u211a)\n  (h_order : a \u2264 b \u2227 b < c)\n  (h_area : 2 * n = a * b)\n  (h_triangle : a^2 + b^2 = c^2) :\n  (1/2) * a * b = n := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l2 \n  (a b c n : \u211a)\n  (h_order : a \u2264 b \u2227 b < c)\n  (h_area : 2 * n = a * b)\n  (h_triangle : a^2 + b^2 = c^2) :\n  (1/2) * a * b = n := by\n  have h_main : (1/2 : \u211a) * (2 * n) = (1/2 : \u211a) * (a * b) := by\n    calc\n      (1 / 2 : \u211a) * (2 * n) = (1 / 2 : \u211a) * (a * b) := by\n        -- Use the given equation 2 * n = a * b to substitute\n        rw [show (2 : \u211a) * n = a * b by exact h_area]\n      _ = (1 / 2 : \u211a) * (a * b) := by rfl\n  \n  have h_left : (1/2 : \u211a) * (2 * n) = n := by\n    have h\u2081 : (1 / 2 : \u211a) * (2 * n) = n := by\n      ring_nf at h_main \u22a2\n      <;> linarith\n    exact h\u2081\n  \n  have h_right : (1/2 : \u211a) * (a * b) = (1/2 : \u211a) * a * b := by\n    ring_nf\n    <;>\n    (try norm_num) <;>\n    (try linarith) <;>\n    (try ring_nf at *) <;>\n    (try field_simp at *) <;>\n    (try nlinarith)\n    <;>\n    simp_all [mul_assoc]\n    <;>\n    ring_nf\n    <;>\n    linarith\n  \n  have h_final : (1/2 : \u211a) * a * b = n := by\n    calc\n      (1 / 2 : \u211a) * a * b = (1 / 2 : \u211a) * (a * b) := by ring\n      _ = (1 / 2 : \u211a) * (a * b) := by rfl\n      _ = (1 / 2 : \u211a) * (2 * n) := by\n        -- Use the given equation 2 * n = a * b to substitute\n        rw [show (a * b : \u211a) = 2 * n by\n          linarith]\n      _ = n := by\n        -- Simplify the expression to get n\n        linarith\n  \n  exact h_final", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["Variable types correctly specified as rational numbers matching the natural language requirement", "Ordering constraint a \u2264 b < c is exactly preserved in the Lean formalization", "Area relationship is correctly captured - the hypothesis 2*n = a*b is mathematically equivalent to n being the area (1/2)*a*b", "Pythagorean theorem a^2 + b^2 = c^2 is exactly matched", "The conclusion (1/2)*a*b = n perfectly matches the natural language statement, with only notational differences in multiplication operators"]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "lemma"}, "l3": {"id": "l3", "natural_language": "Add or subtract $4$ times the second equation to the first to get\n\\begin{eqnarray*}\na^2\\pm2ab +b^2&=&c^2\\pm 4n\\\\\n(a\\pm b)^2 &=& c^2 \\pm 4n\n\\end{eqnarray*}", "statement": "We assume:\n\u2022 $n$ is the area of a right triangle with rational side lengths $a, b, c$, with $a \\leq b < c$ [tc_1].\n\u2022 $A = (c/2)^2$ [def_1].\n\u2022 $a^2 + b^2 = c^2$ [l1].\n\u2022 $\\frac{1}{2}ab = n$ [l2].\nTherefore, we conclude:\n\u2022 $(a + b)^2 = c^2 + 4n$ and $(a-b)^2 = c^2 - 4n$ [l3].", "dependencies": ["tc_1", "def_1", "l1", "l2"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l3 \n  (a b c n A : \u211a)\n  (h_order : a \u2264 b \u2227 b < c)\n  (h_triangle : a^2 + b^2 = c^2)\n  (h_area : (1/2) * a * b = n)\n  (h_A : A = (c/2)^2) :\n  (a + b)^2 = c^2 + 4*n \u2227 (a - b)^2 = c^2 - 4*n := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l3 \n  (a b c n A : \u211a)\n  (h_order : a \u2264 b \u2227 b < c)\n  (h_triangle : a^2 + b^2 = c^2)\n  (h_area : (1/2) * a * b = n)\n  (h_A : A = (c/2)^2) :\n  (a + b)^2 = c^2 + 4*n \u2227 (a - b)^2 = c^2 - 4*n := by\n  have h_ab : a * b = 2 * n := by\n    have h1 : (1 / 2 : \u211a) * a * b = n := h_area\n    have h2 : a * b = 2 * n := by\n      -- Multiply both sides by 2 to eliminate the fraction\n      have h3 : (2 : \u211a) * ((1 / 2 : \u211a) * a * b) = (2 : \u211a) * n := by\n        rw [h1]\n      -- Simplify the left side\n      ring_nf at h3 \u22a2\n      <;> linarith\n    exact h2\n  \n  have h_sum_sq : (a + b)^2 = c^2 + 4*n := by\n    have h1 : (a + b)^2 = a^2 + 2 * (a * b) + b^2 := by ring\n    rw [h1]\n    have h2 : a^2 + b^2 = c^2 := h_triangle\n    have h3 : a * b = 2 * n := h_ab\n    have h4 : a^2 + 2 * (a * b) + b^2 = c^2 + 4 * n := by\n      calc\n        a^2 + 2 * (a * b) + b^2 = (a^2 + b^2) + 2 * (a * b) := by ring\n        _ = c^2 + 2 * (a * b) := by rw [h2]\n        _ = c^2 + 2 * (2 * n) := by rw [h3]\n        _ = c^2 + 4 * n := by ring\n    linarith\n  \n  have h_diff_sq : (a - b)^2 = c^2 - 4*n := by\n    have h1 : (a - b)^2 = a^2 - 2 * (a * b) + b^2 := by ring\n    rw [h1]\n    have h2 : a^2 + b^2 = c^2 := h_triangle\n    have h3 : a * b = 2 * n := h_ab\n    have h4 : a^2 - 2 * (a * b) + b^2 = c^2 - 4 * n := by\n      calc\n        a^2 - 2 * (a * b) + b^2 = (a^2 + b^2) - 2 * (a * b) := by ring\n        _ = c^2 - 2 * (a * b) := by rw [h2]\n        _ = c^2 - 2 * (2 * n) := by rw [h3]\n        _ = c^2 - 4 * n := by ring\n    linarith\n  \n  exact \u27e8h_sum_sq, h_diff_sq\u27e9", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The Lean formalization correctly and completely captures all mathematical content from the natural language. All variables are properly typed as rationals, all constraints (ordering, Pythagorean theorem, area formula, definition of A) are accurately represented, and the conclusion matches exactly. The formalization preserves the logical structure while using appropriate Lean syntax."]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "lemma"}, "l4": {"id": "l4", "natural_language": "\\left(\\frac{a\\pm b}{2}\\right)^2 = \n   \\left( \\frac{c}{2}\\right)^2 \\pm n \\\\\n  &=& A \\pm n", "statement": "We assume:\n\u2022 $n$ is the area of a right triangle with rational side lengths $a, b, c$, with $a \\leq b < c$ [tc_1].\n\u2022 $A = (c/2)^2$ [def_1].\n\u2022 $a^2 + b^2 = c^2$ [l1].\n\u2022 $\\frac{1}{2}ab = n$ [l2].\n\u2022 $(a + b)^2 = c^2 + 4n$ and $(a-b)^2 = c^2 - 4n$ [l3].\nTherefore, we conclude:\n\u2022 $(\\frac{a+b}{2})^2 = A+n$ and $(\\frac{a-b}{2})^2 = A-n$ [l4].", "dependencies": ["tc_1", "def_1", "l1", "l2", "l3"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l4\n  (a b c n A : \u211a)\n  (h_order : a \u2264 b \u2227 b < c)\n  (h_triangle : a^2 + b^2 = c^2)\n  (h_area : (1/2) * a * b = n)\n  (h_A : A = (c/2)^2)\n  (h_l3 : (a + b)^2 = c^2 + 4*n \u2227 (a - b)^2 = c^2 - 4*n) :\n  \u2203 (x y z : \u211a), A - n = x^2 \u2227 A = y^2 \u2227 A + n = z^2 := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l4\n  (a b c n A : \u211a)\n  (h_order : a \u2264 b \u2227 b < c)\n  (h_triangle : a^2 + b^2 = c^2)\n  (h_area : (1/2) * a * b = n)\n  (h_A : A = (c/2)^2)\n  (h_l3 : (a + b)^2 = c^2 + 4*n \u2227 (a - b)^2 = c^2 - 4*n) :\n  \u2203 (x y z : \u211a), A - n = x^2 \u2227 A = y^2 \u2227 A + n = z^2 := by\n  have h_x : A - n = ((a - b)/2)^2 := by\n    have h1 : (a - b)^2 = c^2 - 4*n := by\n      have h2 := h_l3.2\n      linarith\n    have h3 : A = (c/2)^2 := h_A\n    have h4 : A - n = (c/2)^2 - n := by rw [h3]\n    have h5 : (c/2 : \u211a)^2 - n = ((a - b)/2 : \u211a)^2 := by\n      have h6 : (a - b : \u211a)^2 = c^2 - 4*n := by\n        norm_num at h1 \u22a2\n        <;>\n        (try ring_nf at h1 \u22a2) <;>\n        (try linarith) <;>\n        (try nlinarith) <;>\n        (try simp_all [pow_two]) <;>\n        (try ring_nf at * <;> linarith)\n        <;>\n        (try nlinarith)\n        <;>\n        linarith\n      have h7 : (c : \u211a)^2 - 4 * n = (a - b : \u211a)^2 := by linarith\n      calc\n        (c / 2 : \u211a) ^ 2 - n = (c : \u211a) ^ 2 / 4 - n := by ring\n        _ = (c : \u211a) ^ 2 / 4 - (4 * n) / 4 := by ring\n        _ = ((c : \u211a) ^ 2 - 4 * n) / 4 := by ring\n        _ = ((a - b : \u211a) ^ 2) / 4 := by rw [h7]\n        _ = ((a - b : \u211a) / 2) ^ 2 := by ring\n        _ = ((a - b) / 2 : \u211a) ^ 2 := by norm_num\n    calc\n      A - n = (c/2 : \u211a)^2 - n := by rw [h3]\n      _ = ((a - b)/2 : \u211a)^2 := by rw [h5]\n      _ = ((a - b)/2)^2 := by norm_num\n  \n  have h_y : A = (c/2)^2 := by\n    rw [h_A]\n    <;> ring_nf\n    <;> norm_num\n  \n  have h_z : A + n = ((a + b)/2)^2 := by\n    have h\u2081 : (a + b) ^ 2 = c ^ 2 + 4 * n := h_l3.1\n    have h\u2082 : A = (c / 2) ^ 2 := h_A\n    have h\u2083 : A + n = (c / 2) ^ 2 + n := by rw [h\u2082]\n    have h\u2084 : (c / 2 : \u211a) ^ 2 + n = ((a + b) / 2 : \u211a) ^ 2 := by\n      have h\u2085 : (a + b : \u211a) ^ 2 = c ^ 2 + 4 * n := by\n        norm_cast at h\u2081 \u22a2\n        <;>\n        (try ring_nf at h\u2081 \u22a2) <;>\n        (try linarith) <;>\n        (try nlinarith) <;>\n        (try simp_all [pow_two]) <;>\n        (try ring_nf at * <;> linarith)\n        <;>\n        (try nlinarith)\n        <;>\n        linarith\n      have h\u2086 : (c : \u211a) ^ 2 + 4 * n = (a + b : \u211a) ^ 2 := by linarith\n      calc\n        (c / 2 : \u211a) ^ 2 + n = (c : \u211a) ^ 2 / 4 + n := by ring\n        _ = (c : \u211a) ^ 2 / 4 + (4 * n) / 4 := by ring\n        _ = ((c : \u211a) ^ 2 + 4 * n) / 4 := by ring\n        _ = ((a + b : \u211a) ^ 2) / 4 := by rw [h\u2086]\n        _ = ((a + b : \u211a) / 2) ^ 2 := by ring\n        _ = ((a + b) / 2 : \u211a) ^ 2 := by norm_num\n    calc\n      A + n = (c / 2 : \u211a) ^ 2 + n := by rw [h\u2083]\n      _ = ((a + b) / 2 : \u211a) ^ 2 := by rw [h\u2084]\n      _ = ((a + b) / 2) ^ 2 := by norm_num\n  \n  have h_main : \u2203 (x y z : \u211a), A - n = x^2 \u2227 A = y^2 \u2227 A + n = z^2 := by\n    refine' \u27e8(a - b)/2, c/2, (a + b)/2, _, _, _\u27e9\n    \u00b7 -- Prove A - n = ((a - b)/2)^2\n      rw [h_x]\n      <;> ring_nf\n      <;> norm_num\n    \u00b7 -- Prove A = (c/2)^2\n      rw [h_y]\n      <;> ring_nf\n      <;> norm_num\n    \u00b7 -- Prove A + n = ((a + b)/2)^2\n      rw [h_z]\n      <;> ring_nf\n      <;> norm_num\n  \n  exact h_main", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 0.0, "semantic_feedback": ["The premises and hypotheses in the Lean formalization correctly capture all the assumptions from the natural language, including the ordering constraints, Pythagorean theorem, area definition, and derived relations from l3.", "The conclusion in the Lean formalization is fundamentally different from the natural language. The natural language states specific equalities ((a+b)/2)\u00b2 = A+n and ((a-b)/2)\u00b2 = A-n, while the Lean version only claims existence of some rationals x, y, z whose squares equal A-n, A, and A+n respectively. This misses the key mathematical content about the specific expressions (a+b)/2 and (a-b)/2."]}, "error_report": {"error_type": "Formalizer", "error_report": "Formalization is likely incorrect: semantic score is 0.0, below threshold 0.6.\nScorer feedback: ['The premises and hypotheses in the Lean formalization correctly capture all the assumptions from the natural language, including the ordering constraints, Pythagorean theorem, area definition, and derived relations from l3.', 'The conclusion in the Lean formalization is fundamentally different from the natural language. The natural language states specific equalities ((a+b)/2)\u00b2 = A+n and ((a-b)/2)\u00b2 = A-n, while the Lean version only claims existence of some rationals x, y, z whose squares equal A-n, A, and A+n respectively. This misses the key mathematical content about the specific expressions (a+b)/2 and (a-b)/2.']"}, "solved_negation": null, "type": "lemma"}, "ts_1": {"id": "ts_1", "natural_language": "Let $A=(c/2)^2$.", "statement": "We assume:\n\u2022 $n$ is the area of a right triangle with rational side lengths $a, b, c$, with $a \\leq b < c$ [tc_1].\n\u2022 $A = (c/2)^2$ [def_1].\n\u2022 $a^2 + b^2 = c^2$ [l1].\n\u2022 $\\frac{1}{2}ab = n$ [l2].\n\u2022 $(a + b)^2 = c^2 + 4n$ and $(a-b)^2 = c^2 - 4n$ [l3].\n\u2022 $(\\frac{a+b}{2})^2 = A+n$ and $(\\frac{a-b}{2})^2 = A-n$ [l4].\nTherefore, we conclude:\n\u2022 $A$ is a perfect square of a rational number [ts_1].", "dependencies": ["tc_1", "def_1", "l1", "l2", "l3", "l4"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem ts_1 \n  (a b c n A : \u211a)\n  (h_order : a \u2264 b \u2227 b < c)\n  (h_triangle : a^2 + b^2 = c^2)\n  (h_area : (1/2) * a * b = n)\n  (h_A : A = (c/2)^2)\n  (h_l3 : (a + b)^2 = c^2 + 4*n \u2227 (a - b)^2 = c^2 - 4*n)\n  (h_l4 : \u2203 (x y z : \u211a), A - n = x^2 \u2227 A = y^2 \u2227 A + n = z^2) :\n  \u2203 (x : \u211a), A = x^2 := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem ts_1 \n  (a b c n A : \u211a)\n  (h_order : a \u2264 b \u2227 b < c)\n  (h_triangle : a^2 + b^2 = c^2)\n  (h_area : (1/2) * a * b = n)\n  (h_A : A = (c/2)^2)\n  (h_l3 : (a + b)^2 = c^2 + 4*n \u2227 (a - b)^2 = c^2 - 4*n)\n  (h_l4 : \u2203 (x y z : \u211a), A - n = x^2 \u2227 A = y^2 \u2227 A + n = z^2) :\n  \u2203 (x : \u211a), A = x^2 := by\n  have h_main : \u2203 (x : \u211a), A = x^2 := by\n    obtain \u27e8x, y, z, h1, h2, h3\u27e9 := h_l4\n    refine' \u27e8y, _\u27e9\n    -- We directly use the fact that A = y^2 from the hypothesis h_l4\n    linarith\n  \n  exact h_main", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 0.0, "semantic_feedback": ["Variable types and ordering constraint correctly captured", "Pythagorean theorem correctly formalized", "Area formula correctly formalized", "Definition of A correctly formalized", "Derived quadratic relations correctly formalized", "h_l4 incorrectly assumes A = y^2 as a hypothesis, making the theorem trivial. The natural language states ((a+b)/2)\u00b2 = A+n and ((a-b)/2)\u00b2 = A-n, which should be encoded as separate equalities, not as an existential statement that assumes A is already a perfect square", "Conclusion correctly states that A is a perfect square"]}, "error_report": {"error_type": "Formalizer", "error_report": "Formalization is likely incorrect: semantic score is 0.0, below threshold 0.6.\nScorer feedback: ['Variable types and ordering constraint correctly captured', 'Pythagorean theorem correctly formalized', 'Area formula correctly formalized', 'Definition of A correctly formalized', 'Derived quadratic relations correctly formalized', 'h_l4 incorrectly assumes A = y^2 as a hypothesis, making the theorem trivial. The natural language states ((a+b)/2)\u00b2 = A+n and ((a-b)/2)\u00b2 = A-n, which should be encoded as separate equalities, not as an existential statement that assumes A is already a perfect square', 'Conclusion correctly states that A is a perfect square']"}, "solved_negation": null, "type": "solution"}, "ts_2": {"id": "ts_2", "natural_language": "  &=& A \\pm n", "statement": "We assume:\n\u2022 $n$ is the area of a right triangle with rational side lengths $a, b, c$, with $a \\leq b < c$ [tc_1].\n\u2022 $A = (c/2)^2$ [def_1].\n\u2022 $a^2 + b^2 = c^2$ [l1].\n\u2022 $\\frac{1}{2}ab = n$ [l2].\n\u2022 $(a + b)^2 = c^2 + 4n$ and $(a-b)^2 = c^2 - 4n$ [l3].\n\u2022 $(\\frac{a+b}{2})^2 = A+n$ and $(\\frac{a-b}{2})^2 = A-n$ [l4].\n\u2022 $A$ is a perfect square of a rational number [ts_1].\nTherefore, we conclude:\n\u2022 $A-n$ is a perfect square of a rational number [ts_2].", "dependencies": ["tc_1", "def_1", "l1", "l2", "l3", "l4", "ts_1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem ts_2\n  (a b c n A : \u211a)\n  (h_order : a \u2264 b \u2227 b < c)\n  (h_triangle : a^2 + b^2 = c^2)\n  (h_area : (1/2) * a * b = n)\n  (h_A : A = (c/2)^2)\n  (h_l3 : (a + b)^2 = c^2 + 4*n \u2227 (a - b)^2 = c^2 - 4*n)\n  (h_l4 : \u2203 (x y z : \u211a), A - n = x^2 \u2227 A = y^2 \u2227 A + n = z^2)\n  (h_l4 : \u2203 (x y z : \u211a), A - n = x^2 \u2227 A = y^2 \u2227 A + n = z^2) :\n  \u2203 (x : \u211a), A - n = x^2 := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem ts_2\n  (a b c n A : \u211a)\n  (h_order : a \u2264 b \u2227 b < c)\n  (h_triangle : a^2 + b^2 = c^2)\n  (h_area : (1/2) * a * b = n)\n  (h_A : A = (c/2)^2)\n  (h_l3 : (a + b)^2 = c^2 + 4*n \u2227 (a - b)^2 = c^2 - 4*n)\n  (h_l4 : \u2203 (x y z : \u211a), A - n = x^2 \u2227 A = y^2 \u2227 A + n = z^2)\n  (h_l4 : \u2203 (x y z : \u211a), A - n = x^2 \u2227 A = y^2 \u2227 A + n = z^2) :\n  \u2203 (x : \u211a), A - n = x^2 := by\n  have h_main : \u2203 (x : \u211a), A - n = x^2 := by\n    obtain \u27e8x, y, z, h1, h2, h3\u27e9 := h_l4\n    exact \u27e8x, by linarith\u27e9\n  \n  exact h_main", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 0.0, "semantic_feedback": ["Variable types and ordering constraint correctly captured", "Definition of A correctly formalized", "Pythagorean theorem correctly stated", "Area formula correctly expressed with proper multiplication notation", "Both equations in l3 correctly captured with conjunction", "The natural language l4 equations ((a+b)/2)^2 = A+n and ((a-b)/2)^2 = A-n are missing. Instead, the Lean code assumes existence of rational square roots directly, which is a different and stronger assumption. Also, h_l4 is duplicated.", "Perfect square condition for A is correctly captured within the existential statement", "Conclusion correctly states that A-n is a perfect square of a rational number"]}, "error_report": {"error_type": "Formalizer", "error_report": "Formalization is likely incorrect: semantic score is 0.0, below threshold 0.6.\nScorer feedback: ['Variable types and ordering constraint correctly captured', 'Definition of A correctly formalized', 'Pythagorean theorem correctly stated', 'Area formula correctly expressed with proper multiplication notation', 'Both equations in l3 correctly captured with conjunction', 'The natural language l4 equations ((a+b)/2)^2 = A+n and ((a-b)/2)^2 = A-n are missing. Instead, the Lean code assumes existence of rational square roots directly, which is a different and stronger assumption. Also, h_l4 is duplicated.', 'Perfect square condition for A is correctly captured within the existential statement', 'Conclusion correctly states that A-n is a perfect square of a rational number']"}, "solved_negation": null, "type": "solution"}, "ts_3": {"id": "ts_3", "natural_language": "  &=& A \\pm n", "statement": "We assume:\n\u2022 $n$ is the area of a right triangle with rational side lengths $a, b, c$, with $a \\leq b < c$ [tc_1].\n\u2022 $A = (c/2)^2$ [def_1].\n\u2022 $a^2 + b^2 = c^2$ [l1].\n\u2022 $\\frac{1}{2}ab = n$ [l2].\n\u2022 $(a + b)^2 = c^2 + 4n$ and $(a-b)^2 = c^2 - 4n$ [l3].\n\u2022 $(\\frac{a+b}{2})^2 = A+n$ and $(\\frac{a-b}{2})^2 = A-n$ [l4].\n\u2022 $A$ is a perfect square of a rational number [ts_1].\n\u2022 $A-n$ is a perfect square of a rational number [ts_2].\nTherefore, we conclude:\n\u2022 $A+n$ is a perfect square of a rational number [ts_3].", "dependencies": ["tc_1", "def_1", "l1", "l2", "l3", "l4", "ts_1", "ts_2"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem ts_3\n  (a b c n A : \u211a)\n  (h_order : a \u2264 b \u2227 b < c)\n  (h_triangle : a^2 + b^2 = c^2)\n  (h_area : (1/2) * a * b = n)\n  (h_A : A = (c/2)^2)\n  (h_l3 : (a + b)^2 = c^2 + 4*n \u2227 (a - b)^2 = c^2 - 4*n)\n  (h_l4 : \u2203 (x y z : \u211a), A - n = x^2 \u2227 A = y^2 \u2227 A + n = z^2)\n  (h_ts_1 : \u2203 (x : \u211a), A = x^2)\n  (h_ts_2 : \u2203 (x : \u211a), A - n = x^2) :\n  \u2203 (x : \u211a), A + n = x^2 := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem ts_3\n  (a b c n A : \u211a)\n  (h_order : a \u2264 b \u2227 b < c)\n  (h_triangle : a^2 + b^2 = c^2)\n  (h_area : (1/2) * a * b = n)\n  (h_A : A = (c/2)^2)\n  (h_l3 : (a + b)^2 = c^2 + 4*n \u2227 (a - b)^2 = c^2 - 4*n)\n  (h_l4 : \u2203 (x y z : \u211a), A - n = x^2 \u2227 A = y^2 \u2227 A + n = z^2)\n  (h_ts_1 : \u2203 (x : \u211a), A = x^2)\n  (h_ts_2 : \u2203 (x : \u211a), A - n = x^2) :\n  \u2203 (x : \u211a), A + n = x^2 := by\n  have h_main : \u2203 (x : \u211a), A + n = x^2 := by\n    obtain \u27e8x, y, z, h1, h2, h3\u27e9 := h_l4\n    refine' \u27e8z, _\u27e9\n    -- We directly use the third part of the conjunction from h_l4 to get A + n = z^2\n    linarith\n  \n  exact h_main", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 0.0, "semantic_feedback": ["Variable types and ordering constraint correctly captured", "Definition of A correctly formalized", "Pythagorean theorem correctly stated", "Area formula correctly expressed", "Derived relations l3 correctly formalized", "The hypothesis h_l4 incorrectly assumes A+n=z^2 (which is the conclusion) instead of formalizing the natural language statement l4: ((a+b)/2)^2 = A+n and ((a-b)/2)^2 = A-n. Additionally, the natural language l4 is missing as a separate hypothesis.", "Perfect square condition for A correctly stated", "Perfect square condition for A-n correctly stated", "The conclusion is correct, but the proof becomes trivial due to the problematic h_l4 assumption that already contains A+n=z^2"]}, "error_report": {"error_type": "Formalizer", "error_report": "Formalization is likely incorrect: semantic score is 0.0, below threshold 0.6.\nScorer feedback: ['Variable types and ordering constraint correctly captured', 'Definition of A correctly formalized', 'Pythagorean theorem correctly stated', 'Area formula correctly expressed', 'Derived relations l3 correctly formalized', 'The hypothesis h_l4 incorrectly assumes A+n=z^2 (which is the conclusion) instead of formalizing the natural language statement l4: ((a+b)/2)^2 = A+n and ((a-b)/2)^2 = A-n. Additionally, the natural language l4 is missing as a separate hypothesis.', 'Perfect square condition for A correctly stated', 'Perfect square condition for A-n correctly stated', 'The conclusion is correct, but the proof becomes trivial due to the problematic h_l4 assumption that already contains A+n=z^2']"}, "solved_negation": null, "type": "solution"}};
            
            // Create nodes and edges
            var nodes = new vis.DataSet([{"id": "tc_1", "label": "tc_1", "color": {"background": "#eba0a0", "border": "#00ff00", "highlight": {"background": "#eba0a0", "border": "#00ff00"}}, "shape": "box", "size": 30, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "def_1", "label": "def_1", "color": {"background": "#cfb795", "border": "#00ff00", "highlight": {"background": "#cfb795", "border": "#00ff00"}}, "shape": "box", "size": 30, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l1", "label": "l1", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l2", "label": "l2", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l3", "label": "l3", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l4", "label": "l4", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "ts_1", "label": "ts_1", "color": {"background": "#a3c2a8", "border": "#00ff00", "highlight": {"background": "#a3c2a8", "border": "#00ff00"}}, "shape": "star", "size": 40, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "ts_2", "label": "ts_2", "color": {"background": "#a3c2a8", "border": "#00ff00", "highlight": {"background": "#a3c2a8", "border": "#00ff00"}}, "shape": "star", "size": 40, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "ts_3", "label": "ts_3", "color": {"background": "#a3c2a8", "border": "#00ff00", "highlight": {"background": "#a3c2a8", "border": "#00ff00"}}, "shape": "star", "size": 40, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}]);
            var edges = new vis.DataSet([{"from": "tc_1", "to": "def_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "l1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "l2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "l3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "l4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "ts_2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "ts_3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_1", "to": "l1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_1", "to": "l2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_1", "to": "l3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_1", "to": "l4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_1", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_1", "to": "ts_2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "def_1", "to": "ts_3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "l2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "l3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "l4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "ts_2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "ts_3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l2", "to": "l3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l2", "to": "l4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l2", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l2", "to": "ts_2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l2", "to": "ts_3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l3", "to": "l4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l3", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l3", "to": "ts_2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l3", "to": "ts_3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l4", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l4", "to": "ts_2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l4", "to": "ts_3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "ts_1", "to": "ts_2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "ts_1", "to": "ts_3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "ts_2", "to": "ts_3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}]);
            
            // Create network
            var container = document.getElementById('mynetwork');
            var data = {
                nodes: nodes,
                edges: edges
            };
            
            var options = {
                physics: {
                    enabled: true,
                    solver: 'hierarchicalRepulsion',
                    hierarchicalRepulsion: {
                        centralGravity: 0.0,
                        springLength: 200,
                        springConstant: 0.01,
                        nodeDistance: 150,
                        damping: 0.09
                    }
                },
                edges: {
                    smooth: {
                        type: 'continuous',
                        forceDirection: 'none'
                    },
                    color: {
                        color: '#666666',
                        highlight: '#666666',
                        hover: '#666666'
                    },
                    width: 2
                },
                interaction: {
                    hover: true,
                    tooltipDelay: 100,
                    navigationButtons: true,
                    keyboard: true
                },
                nodes: {
                    font: {
                        size: 14,
                        color: '#000000'
                    },
                    labelHighlightBold: false,
                    chosen: false,
                    shapeProperties: {
                        useBorderWithImage: false
                    },
                    scaling: {
                        label: {
                            enabled: true,
                            min: 8,
                            max: 20,
                            maxVisible: 20,
                            drawThreshold: 5
                        }
                    }
                }
            };
            
            var network = new vis.Network(container, data, options);
            
            // Format field value for display
            function formatFieldValue(value, fieldName) {
                if (value === null || value === undefined) {
                    return 'N/A';
                }
                
                // Handle objects (dictionaries) as sub-boxes
                if (typeof value === 'object' && !Array.isArray(value)) {
                    var html = '';
                    for (var key in value) {
                        if (value.hasOwnProperty(key)) {
                            var subValue = value[key];
                            var subValueStr = '';
                            
                            if (typeof subValue === 'object' &&
                                    !Array.isArray(subValue)) {
                                // Nested object - show as JSON
                                subValueStr = JSON.stringify(subValue, null, 2);
                            } else if (Array.isArray(subValue)) {
                                // Array - show as JSON
                                subValueStr = JSON.stringify(subValue, null, 2);
                            } else {
                                // Primitive value
                                subValueStr = String(subValue);
                            }
                            
                            // Replace escaped newlines and tabs with actual characters
                            subValueStr = subValueStr.replace(/\\n/g, '\n');
                            subValueStr = subValueStr.replace(/\\t/g, '\t');
                            subValueStr = subValueStr.replace(/\t/g, '\t');
                            
                            html += '<div class="sub-dict">';
                            html += '<div class="sub-dict-title">' + key + '</div>';
                            html += '<div class="sub-dict-content">' + subValueStr + '</div>';
                            html += '</div>';
                        }
                    }
                    return html;
                }
                
                // Convert to string for primitive values and arrays
                var strValue = String(value);
                
                // Handle arrays
                if (Array.isArray(value)) {
                    strValue = JSON.stringify(value, null, 2);
                }
                
                // Replace escaped newlines and tabs with actual characters
                strValue = strValue.replace(/\\n/g, '\n');
                strValue = strValue.replace(/\\t/g, '\t');
                strValue = strValue.replace(/\t/g, '\t');
                
                return strValue;
            }
            
            // Handle node click events
            network.on("click", function(params) {
                if (params.nodes.length > 0) {
                    var nodeId = params.nodes[0];
                    var info = nodeInfo[nodeId];
                    
                    if (info) {
                        var html = '<div class="info-header">';
                        html += '<h2>' + nodeId + '</h2>';
                        var nodeType = info.type || 'unknown';
                        var capitalizedType = nodeType.charAt(0).toUpperCase() +
                            nodeType.slice(1);
                        html += '<div class="node-type">Type: ' + capitalizedType +
                            '</div>';
                        html += '</div>';
                        
                        // Add all fields
                        for (var key in info) {
                            if (key === 'type' || key === 'id') continue;
                            
                            var fieldName = key.replace(/_/g, ' ')
                                .replace(/\b\w/g, function(l) {
                                    return l.toUpperCase();
                                });
                            var fieldValue = formatFieldValue(info[key], fieldName);
                            
                            if (fieldValue && fieldValue !== 'N/A') {
                                // Special formatting for code fields
                                var isCode = key.includes('code') ||
                                    key.includes('lean') ||
                                    key.includes('statement');
                                
                                html += '<div class="field-group">';
                                html += '<div class="field-name">' + fieldName +
                                    '</div>';
                                html += '<div class="field-value' +
                                    (isCode ? ' code' : '') + '">' +
                                    fieldValue + '</div>';
                                html += '</div>';
                            }
                        }
                        
                        document.getElementById('info-content')
                            .innerHTML = html;
                    }
                }
            });
            
            // Toggle panel function
            function togglePanel() {
                var panel = document.getElementById('info-panel');
                panel.classList.toggle('hidden');
                
                // Resize network when panel is toggled
                setTimeout(function() {
                    network.fit();
                }, 300);
            }
            
            // Initial network fit
            network.once('stabilized', function() {
                network.fit();
            });
            
            // Resizable panels functionality
            function makeResizable() {
                const verticalResizer = document.getElementById('vertical-resizer');
                const horizontalResizer = document.getElementById('horizontal-resizer');
                const proofPanel = document.getElementById('proof-str-panel');
                const graphContainer = document.getElementById('graph-container');
                const infoPanel = document.getElementById('info-panel');
                const leftPanel = document.getElementById('left-panel');
                
                let isVerticalResizing = false;
                let isHorizontalResizing = false;
                
                // Vertical resizer (between proof panel and graph)
                verticalResizer.addEventListener('mousedown', function(e) {
                    isVerticalResizing = true;
                    document.addEventListener('mousemove', verticalResize);
                    document.addEventListener('mouseup', stopVerticalResize);
                    e.preventDefault();
                });
                
                function verticalResize(e) {
                    if (!isVerticalResizing) return;
                    
                    const containerHeight = leftPanel.offsetHeight;
                    const newHeight = e.clientY - leftPanel.offsetTop;
                    const minHeight = 100;
                    const maxHeight = containerHeight - 100;
                    
                    if (newHeight >= minHeight && newHeight <= maxHeight) {
                        proofPanel.style.height = newHeight + 'px';
                        graphContainer.style.height = (containerHeight - newHeight) + 'px';
                        network.fit();
                    }
                }
                
                function stopVerticalResize() {
                    isVerticalResizing = false;
                    document.removeEventListener('mousemove', verticalResize);
                    document.removeEventListener('mouseup', stopVerticalResize);
                }
                
                // Horizontal resizer (between left and right panels)
                horizontalResizer.addEventListener('mousedown', function(e) {
                    isHorizontalResizing = true;
                    document.addEventListener('mousemove', horizontalResize);
                    document.addEventListener('mouseup', stopHorizontalResize);
                    e.preventDefault();
                });
                
                function horizontalResize(e) {
                    if (!isHorizontalResizing) return;
                    
                    const containerWidth = document.querySelector('.container').offsetWidth;
                    const newWidth = e.clientX - leftPanel.offsetLeft;
                    const minWidth = 300;
                    const maxWidth = containerWidth - 300;
                    
                    if (newWidth >= minWidth && newWidth <= maxWidth) {
                        leftPanel.style.flex = 'none';
                        leftPanel.style.width = newWidth + 'px';
                        infoPanel.style.width = (containerWidth - newWidth) + 'px';
                        network.fit();
                    }
                }
                
                function stopHorizontalResize() {
                    isHorizontalResizing = false;
                    document.removeEventListener('mousemove', horizontalResize);
                    document.removeEventListener('mouseup', stopHorizontalResize);
                }
            }
            
            // Initialize resizable panels
            makeResizable();
        </script>
    </body>
    </html>
    