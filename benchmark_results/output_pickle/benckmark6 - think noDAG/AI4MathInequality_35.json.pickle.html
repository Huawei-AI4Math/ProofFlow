
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Proof Graph Visualization</title>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
        <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.css" rel="stylesheet" type="text/css" />
        <style>
            body {
                margin: 0;
                padding: 0;
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
                height: 100vh;
                overflow: hidden;
            }
            
            .container {
                display: flex;
                height: 100vh;
                background: #f0f0f0;
            }
            
            #left-panel {
                flex: 1;
                display: flex;
                flex-direction: column;
                background: white;
                border-right: 2px solid #ddd;
                height: 100vh;
                overflow: hidden;
            }
            
            #proof-str-panel {
                background: #f8f9fa;
                border-bottom: 2px solid #ddd;
                padding: 15px;
                height: 200px;
                overflow-y: auto;
                flex-shrink: 0;
            }
            
            #proof-str-title {
                font-weight: 600;
                color: #2d3748;
                margin-bottom: 10px;
                font-size: 14px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
            
            #proof-str-content {
                color: #4a5568;
                line-height: 1.6;
                white-space: pre-wrap;
                word-wrap: break-word;
                font-family: 'Monaco', 'Courier New', monospace;
                font-size: 13px;
                background: white;
                padding: 12px;
                border-radius: 4px;
                border: 1px solid #e2e8f0;
            }
            
            #graph-container {
                flex: 1;
                position: relative;
                background: white;
                min-height: 0;
                overflow: hidden;
            }
            
            #mynetwork {
                width: 100%;
                height: 100%;
            }
            
            #info-panel {
                width: 40%;
                max-width: 600px;
                background: white;
                overflow-y: auto;
                padding: 20px;
                box-shadow: -2px 0 10px rgba(0,0,0,0.1);
            }
            
            #info-panel.hidden {
                display: none;
            }
            
            .info-header {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                padding: 15px;
                border-radius: 8px;
                margin-bottom: 20px;
            }
            
            .info-header h2 {
                margin: 0;
                font-size: 24px;
            }
            
            .info-header .node-type {
                opacity: 0.9;
                font-size: 14px;
                margin-top: 5px;
            }
            
            .field-group {
                background: #f8f9fa;
                border-left: 4px solid #667eea;
                padding: 15px;
                margin-bottom: 15px;
                border-radius: 4px;
            }
            
            .field-name {
                font-weight: 600;
                color: #2d3748;
                margin-bottom: 8px;
                font-size: 14px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
            
            .field-value {
                color: #4a5568;
                line-height: 1.6;
                white-space: pre-wrap;
                word-wrap: break-word;
                font-family: 'Monaco', 'Courier New', monospace;
                font-size: 13px;
            }
            
            .field-value.code {
                color: #4a5568;
                padding: 12px;
                border-radius: 4px;
                overflow-x: auto;
            }
            
            .sub-dict {
                background: #ffffff;
                border: 1px solid #e2e8f0;
                border-radius: 4px;
                padding: 10px;
                margin: 8px 0;
                box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            }
            
            .sub-dict-title {
                font-weight: 600;
                color: #4a5568;
                margin-bottom: 8px;
                font-size: 12px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                border-bottom: 1px solid #e2e8f0;
                padding-bottom: 4px;
            }
            
            .sub-dict-content {
                color: #2d3748;
                line-height: 1.5;
                font-size: 12px;
            }
            
            .placeholder {
                text-align: center;
                color: #718096;
                padding: 40px;
                font-size: 18px;
            }
            
            .placeholder-icon {
                font-size: 48px;
                margin-bottom: 20px;
                opacity: 0.3;
            }
            
            #toggle-panel {
                position: absolute;
                right: 10px;
                top: 10px;
                z-index: 1000;
                background: #667eea;
                color: white;
                border: none;
                padding: 10px 20px;
                border-radius: 5px;
                cursor: pointer;
                font-size: 14px;
                transition: background 0.3s;
            }
            
            #toggle-panel:hover {
                background: #764ba2;
            }
            
            .legend {
                position: absolute;
                top: 20px;
                left: 20px;
                background: white;
                padding: 15px;
                border-radius: 8px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
                z-index: 100;
                max-width: 300px;
            }
            
            .legend-section {
                margin-bottom: 15px;
            }
            
            .legend-section:last-child {
                margin-bottom: 0;
            }
            
            .legend-title {
                font-weight: 600;
                font-size: 12px;
                color: #2d3748;
                margin-bottom: 8px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                border-bottom: 1px solid #e2e8f0;
                padding-bottom: 4px;
            }
            
            .legend-item {
                display: flex;
                align-items: center;
                margin-bottom: 8px;
            }
            
            .legend-item:last-child {
                margin-bottom: 0;
            }
            
            .legend-color {
                width: 20px;
                height: 20px;
                margin-right: 10px;
                border-radius: 3px;
            }
            
            .resizer {
                background: #ddd;
                cursor: col-resize;
                width: 4px;
                height: 100%;
                position: absolute;
                right: 0;
                top: 0;
                z-index: 1000;
            }
            
            .resizer:hover {
                background: #bbb;
            }
            
            .resizer-vertical {
                background: #ddd;
                cursor: row-resize;
                height: 4px;
                width: 100%;
                position: absolute;
                bottom: 0;
                left: 0;
                z-index: 1000;
            }
            
            .resizer-vertical:hover {
                background: #bbb;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div id="left-panel">
                <div id="proof-str-panel">
                    <div id="proof-str-title">Informal theorem and proof</div>
                    <div id="proof-str-content">Theorem: Prove that for all positive real numbers $a, b, c, d$ such that $abcd = 1$, the following inequality holds:
$$ (1 + a^2)(1 + b^2)(1 + c^2)(1 + d^2) \\geq (a + b + c + d)^2 $$

Proof: Let $a, b, c, d$ be positive real numbers such that $abcd=1$. To prove $(1+a^2)(1+b^2)(1+c^2)(1+d^2) \ge (a+b+c+d)^2$, we first apply the Cauchy-Schwarz inequality by setting $X=(1, a, b, ab)$ and $Y=(c, 1, d, cd)$, which gives $(1+a^2)(1+b^2)(1+c^2)(1+d^2) \ge (a+c+bd+abcd)^2$. Since $abcd=1$, this reduces to $(1+a^2)(1+b^2)(1+c^2)(1+d^2) \ge (a+c+bd+1)^2$. The remaining step is to show $a+c+bd+1 \ge a+b+c+d$, which is equivalent to $bd+1 \ge b+d$. This holds because $(b-1)(d-1) \ge 0$ for some choice of two variables $b$ and $d$, which is always possible given that $abcd=1$. Combining these, we obtain $(1+a^2)(1+b^2)(1+c^2)(1+d^2) \ge (a+b+c+d)^2$, completing the proof.
</div>
                    <div class="resizer-vertical" id="vertical-resizer"></div>
                </div>
                <div id="graph-container">
                    <button id="toggle-panel" onclick="togglePanel()">Toggle Info Panel</button>
                    <div class="legend">
                        <div class="legend-section">
                            <div class="legend-title">Node Types</div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #eba0a0;"></div>
                                <span>Theorem Conditions (tc)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #cfb795 ;"></div>
                                <span>Theorem Definitions (def)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #8dafcc;"></div>
                                <span>Lemmas (l)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #a3c2a8;"></div>
                                <span>Theorem Solutions (ts)</span>
                            </div>

                        </div>
                        <div class="legend-section">
                            <div class="legend-title">Verification Status</div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #fa2c07;"></div>
                                <span>Formalization failed</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #FFA500;"></div>
                                <span>Formalization passed</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #00ff00;"></div>
                                <span>Fully verified</span>
                            </div>
                        </div>
                    </div>
                    <div id="mynetwork"></div>
                </div>
            </div>
            
            <div class="resizer" id="horizontal-resizer"></div>
            
            <div id="info-panel">
                <div id="info-content">
                    <div class="placeholder">
                        <div class="placeholder-icon">ðŸ“Š</div>
                        <p>Click on a node to view its details</p>
                    </div>
                </div>
            </div>
        </div>
        
        <script type="text/javascript">
            // Store node information
            var nodeInfo = {"tc_1": {"id": "tc_1", "natural_language": "Let $a, b, c, d$ be positive real numbers", "statement": "Premise:\n\u2022 a, b, c, d are positive real numbers [tc_1].", "dependencies": [], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\nvariable (a b c d : \u211d)\n(tc_1 : 0 < a \u2227 0 < b \u2227 0 < c \u2227 0 < d)", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The Lean formalization correctly declares a, b, c, d as real numbers and states that they are all positive through the conjunction 0 < a \u2227 0 < b \u2227 0 < c \u2227 0 < d, which perfectly captures the condition that they are positive real numbers", "The Lean formalization contains no conclusions, which matches the natural language statement that explicitly notes no conclusions are derived in this premise step"]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "type": "condition"}, "tc_2": {"id": "tc_2", "natural_language": "such that $abcd=1$.", "statement": "Premise:\n\u2022 a, b, c, d are positive real numbers [tc_1].\n\u2022 abcd = 1 [tc_2].", "dependencies": ["tc_1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\nvariable (a b c d : \u211d)\n(tc_1 : 0 < a \u2227 0 < b \u2227 0 < c \u2227 0 < d)\n(tc_2 : a * b * c * d = 1)", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The Lean formalization correctly captures that a, b, c, d are positive real numbers through the variable declaration and the positivity constraint tc_1", "The Lean formalization correctly captures the constraint abcd = 1 using explicit multiplication notation"]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "type": "condition"}, "l1": {"id": "l1", "natural_language": "we first apply the Cauchy-Schwarz inequality by setting $X=(1, a, b, ab)$ and $Y=(c, 1, d, cd)$, which gives $(1+a^2)(1+b^2)(1+c^2)(1+d^2) \\ge (a+c+bd+abcd)^2$.", "statement": "We assume:\n\u2022 a, b, c, d are positive real numbers [tc_1].\n\u2022 abcd = 1 [tc_2].\nTherefore, we conclude:\n\u2022 The Cauchy-Schwarz inequality on vectors $X=(1, a, b, ab)$ and $Y=(c, 1, d, cd)$ implies $\\|X\\|^2 \\|Y\\|^2 \\ge (X \\cdot Y)^2$, which expands to $(1+a^2)(1+b^2)(1+c^2)(1+d^2) \\ge (a+c+bd+abcd)^2$ [l1].", "dependencies": ["tc_1", "tc_2"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l1 (a b c d : \u211d) (ha : 0 < a) (hb : 0 < b) (hc : 0 < c) (hd : 0 < d) \n  (h_constraint : a * b * c * d = 1) : \n  (1 + a^2) * (1 + b^2) * (1 + c^2) * (1 + d^2) \u2265 (a + c + b * d + a * b * c * d)^2 := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l1 (a b c d : \u211d) (ha : 0 < a) (hb : 0 < b) (hc : 0 < c) (hd : 0 < d) \n  (h_constraint : a * b * c * d = 1) : \n  (1 + a^2) * (1 + b^2) * (1 + c^2) * (1 + d^2) \u2265 (a + c + b * d + a * b * c * d)^2 := by\n  have h_main_ineq : \u2200 (x1 x2 x3 x4 y1 y2 y3 y4 : \u211d), (x1*y1 + x2*y2 + x3*y3 + x4*y4)^2 \u2264 (x1^2 + x2^2 + x3^2 + x4^2)*(y1^2 + y2^2 + y3^2 + y4^2) := by\n    intro x1 x2 x3 x4 y1 y2 y3 y4\n    have h1 : 0 \u2264 (x1*y2 - x2*y1)^2 + (x1*y3 - x3*y1)^2 + (x1*y4 - x4*y1)^2 + (x2*y3 - x3*y2)^2 + (x2*y4 - x4*y2)^2 + (x3*y4 - x4*y3)^2 := by positivity\n    nlinarith [sq_nonneg (x1*y1 + x2*y2 + x3*y3 + x4*y4)]\n  \n  have h_apply_ineq : (1*c + a*1 + b*d + (a*b)*(c*d))^2 \u2264 (1^2 + a^2 + b^2 + (a*b)^2)*(c^2 + 1^2 + d^2 + (c*d)^2) := by\n    have h1 : (1*c + a*1 + b*d + (a*b)*(c*d))^2 \u2264 (1^2 + a^2 + b^2 + (a*b)^2)*(c^2 + 1^2 + d^2 + (c*d)^2) := by\n      have h2 := h_main_ineq 1 a b (a*b) c 1 d (c*d)\n      ring_nf at h2 \u22a2\n      <;> nlinarith\n    exact h1\n  \n  have h_simplify_left : (1*c + a*1 + b*d + (a*b)*(c*d))^2 = (a + c + b*d + a*b*c*d)^2 := by\n    have h\u2081 : 1 * c + a * 1 + b * d + (a * b) * (c * d) = a + c + b * d + a * b * c * d := by\n      ring_nf\n      <;>\n      nlinarith [ha, hb, hc, hd]\n    rw [h\u2081]\n    <;>\n    ring_nf\n    <;>\n    nlinarith [ha, hb, hc, hd]\n  \n  have h_simplify_right : (1^2 + a^2 + b^2 + (a*b)^2) = (1 + a^2)*(1 + b^2) := by\n    have h\u2081 : (1^2 + a^2 + b^2 + (a*b)^2) = (1 + a^2)*(1 + b^2) := by\n      ring_nf\n      <;>\n      nlinarith [ha, hb, hc, hd]\n    rw [h\u2081]\n  \n  have h_simplify_right' : (c^2 + 1^2 + d^2 + (c*d)^2) = (1 + c^2)*(1 + d^2) := by\n    have h\u2081 : (c^2 + 1^2 + d^2 + (c*d)^2) = (1 + c^2)*(1 + d^2) := by\n      ring_nf\n      <;>\n      nlinarith [ha, hb, hc, hd]\n    rw [h\u2081]\n  \n  have h_combine : (a + c + b*d + a*b*c*d)^2 \u2264 (1 + a^2)*(1 + b^2)*(1 + c^2)*(1 + d^2) := by\n    calc\n      (a + c + b * d + a * b * c * d) ^ 2 = (1 * c + a * 1 + b * d + (a * b) * (c * d)) ^ 2 := by\n        have h\u2081 : 1 * c + a * 1 + b * d + (a * b) * (c * d) = a + c + b * d + a * b * c * d := by\n          ring_nf\n          <;> nlinarith [ha, hb, hc, hd]\n        rw [h\u2081]\n      _ \u2264 (1 ^ 2 + a ^ 2 + b ^ 2 + (a * b) ^ 2) * (c ^ 2 + 1 ^ 2 + d ^ 2 + (c * d) ^ 2) := by\n        exact h_apply_ineq\n      _ = (1 + a ^ 2) * (1 + b ^ 2) * (c ^ 2 + 1 ^ 2 + d ^ 2 + (c * d) ^ 2) := by\n        have h\u2082 : (1 ^ 2 + a ^ 2 + b ^ 2 + (a * b) ^ 2) = (1 + a ^ 2) * (1 + b ^ 2) := by\n          ring_nf\n          <;> nlinarith [ha, hb, hc, hd]\n        rw [h\u2082]\n        <;> ring_nf\n      _ = (1 + a ^ 2) * (1 + b ^ 2) * ((1 + c ^ 2) * (1 + d ^ 2)) := by\n        have h\u2083 : (c ^ 2 + 1 ^ 2 + d ^ 2 + (c * d) ^ 2) = (1 + c ^ 2) * (1 + d ^ 2) := by\n          ring_nf\n          <;> nlinarith [ha, hb, hc, hd]\n        rw [h\u2083]\n        <;> ring_nf\n      _ = (1 + a ^ 2) * (1 + b ^ 2) * (1 + c ^ 2) * (1 + d ^ 2) := by ring\n      _ = (1 + a ^ 2) * (1 + b ^ 2) * (1 + c ^ 2) * (1 + d ^ 2) := by rfl\n  \n  have h_final : (1 + a^2) * (1 + b^2) * (1 + c^2) * (1 + d^2) \u2265 (a + c + b * d + a * b * c * d)^2 := by\n    have h\u2081 : (a + c + b * d + a * b * c * d) ^ 2 \u2264 (1 + a ^ 2) * (1 + b ^ 2) * (1 + c ^ 2) * (1 + d ^ 2) := by\n      exact h_combine\n    linarith\n  \n  exact h_final", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 0.67, "semantic_feedback": ["Variable declarations and constraints are correctly captured with proper types and positivity conditions.", "The Lean formalization omits the explicit Cauchy-Schwarz vector construction and intermediate steps described in the natural language, jumping directly to the final expanded inequality. While mathematically equivalent, it doesn't capture the derivation method.", "The final algebraic inequality is perfectly translated with correct mathematical operators and structure."]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "lemma"}, "l2": {"id": "l2", "natural_language": "Since $abcd=1$, this reduces to $(1+a^2)(1+b^2)(1+c^2)(1+d^2) \\ge (a+c+bd+1)^2$.", "statement": "We assume:\n\u2022 a, b, c, d are positive real numbers [tc_1].\n\u2022 abcd = 1 [tc_2].\n\u2022 $(1+a^2)(1+b^2)(1+c^2)(1+d^2) \\ge (a+c+bd+abcd)^2$ [l1].\nTherefore, we conclude:\n\u2022 $(1+a^2)(1+b^2)(1+c^2)(1+d^2) \\ge (a+c+bd+1)^2$ [l2].", "dependencies": ["tc_1", "tc_2", "l1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l2 (a b c d : \u211d) (ha : 0 < a) (hb : 0 < b) (hc : 0 < c) (hd : 0 < d) \n  (h_constraint : a * b * c * d = 1) \n  (h_l1 : (1 + a^2) * (1 + b^2) * (1 + c^2) * (1 + d^2) \u2265 (a + c + b * d + a * b * c * d)^2) :\n  (1 + a^2) * (1 + b^2) * (1 + c^2) * (1 + d^2) \u2265 (a + c + b * d + 1)^2 := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l2 (a b c d : \u211d) (ha : 0 < a) (hb : 0 < b) (hc : 0 < c) (hd : 0 < d) \n  (h_constraint : a * b * c * d = 1) \n  (h_l1 : (1 + a^2) * (1 + b^2) * (1 + c^2) * (1 + d^2) \u2265 (a + c + b * d + a * b * c * d)^2) :\n  (1 + a^2) * (1 + b^2) * (1 + c^2) * (1 + d^2) \u2265 (a + c + b * d + 1)^2 := by\n  have h_main : (a + c + b * d + a * b * c * d)^2 = (a + c + b * d + 1)^2 := by\n    have h1 : a * b * c * d = 1 := h_constraint\n    have h2 : a + c + b * d + a * b * c * d = a + c + b * d + 1 := by\n      calc\n        a + c + b * d + a * b * c * d = a + c + b * d + (a * b * c * d) := by ring\n        _ = a + c + b * d + 1 := by rw [h1]\n        _ = a + c + b * d + 1 := by ring\n    rw [h2]\n    <;>\n    ring\n  \n  have h_final : (1 + a^2) * (1 + b^2) * (1 + c^2) * (1 + d^2) \u2265 (a + c + b * d + 1)^2 := by\n    calc\n      (1 + a ^ 2) * (1 + b ^ 2) * (1 + c ^ 2) * (1 + d ^ 2) \u2265 (a + c + b * d + a * b * c * d) ^ 2 := h_l1\n      _ = (a + c + b * d + 1) ^ 2 := by rw [h_main]\n  \n  exact h_final", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["Variable declarations and positivity constraints are correctly formalized with appropriate Lean syntax", "The product constraint abcd = 1 is accurately captured with explicit multiplication", "The premise inequality l1 is correctly formalized with proper operator precedence and parentheses", "The conclusion l2 correctly represents the target inequality to be proven", "The overall logical structure properly captures the inference from assumptions to conclusion, with the mathematical relationship between premise and conclusion being sound"]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "lemma"}, "l3": {"id": "l3", "natural_language": "The remaining step is to show $a+c+bd+1 \\ge a+b+c+d$, which is equivalent to $bd+1 \\ge b+d$.", "statement": "We assume:\n\u2022 a, b, c, d are positive real numbers [tc_1].\n\u2022 abcd = 1 [tc_2].\n\u2022 $(1+a^2)(1+b^2)(1+c^2)(1+d^2) \\ge (a+c+bd+1)^2$ [l2].\nTherefore, we conclude:\n\u2022 The inequality $a+c+bd+1 \\ge a+b+c+d$ is equivalent to $bd+1 \\ge b+d$ [l3].", "dependencies": ["tc_1", "tc_2", "l1", "l2"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l3 \n  (a b c d : \u211d) \n  (tc_1 : 0 < a \u2227 0 < b \u2227 0 < c \u2227 0 < d)\n  (tc_2 : a * b * c * d = 1)\n  (l2 : (1 + a^2) * (1 + b^2) * (1 + c^2) * (1 + d^2) \u2265 (a + c + b * d + 1)^2) :\n  (a + c + b * d + 1 \u2265 a + b + c + d \u2194 b * d + 1 \u2265 b + d) := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l3 \n  (a b c d : \u211d) \n  (tc_1 : 0 < a \u2227 0 < b \u2227 0 < c \u2227 0 < d)\n  (tc_2 : a * b * c * d = 1)\n  (l2 : (1 + a^2) * (1 + b^2) * (1 + c^2) * (1 + d^2) \u2265 (a + c + b * d + 1)^2) :\n  (a + c + b * d + 1 \u2265 a + b + c + d \u2194 b * d + 1 \u2265 b + d) := by\n  have h_forward : a + c + b * d + 1 \u2265 a + b + c + d \u2192 b * d + 1 \u2265 b + d := by\n    intro h\n    have h\u2081 : b * d + 1 \u2265 b + d := by\n      -- Subtract (a + c) from both sides of the inequality\n      linarith\n    exact h\u2081\n  \n  have h_backward : b * d + 1 \u2265 b + d \u2192 a + c + b * d + 1 \u2265 a + b + c + d := by\n    intro h\n    have h\u2081 : a + c + b * d + 1 \u2265 a + b + c + d := by\n      -- Add (a + c) to both sides of the inequality\n      linarith\n    exact h\u2081\n  \n  have h_main : (a + c + b * d + 1 \u2265 a + b + c + d \u2194 b * d + 1 \u2265 b + d) := by\n    constructor\n    \u00b7 -- Prove the forward direction: if a + c + b * d + 1 \u2265 a + b + c + d, then b * d + 1 \u2265 b + d\n      intro h\n      exact h_forward h\n    \u00b7 -- Prove the backward direction: if b * d + 1 \u2265 b + d, then a + c + b * d + 1 \u2265 a + b + c + d\n      intro h\n      exact h_backward h\n  \n  exact h_main", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["Variable declarations and positivity constraints are correctly captured with proper conjunction of inequalities", "The product constraint abcd = 1 is exactly translated to Lean multiplication syntax", "The inequality l2 is precisely formalized with correct operator precedence and grouping", "The equivalence statement is correctly expressed using biconditional, capturing the logical relationship between the two inequalities"]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "lemma"}, "l4": {"id": "l4", "natural_language": "This holds because $(b-1)(d-1) \\ge 0$ for some choice of two variables $b$ and $d$, which is always possible given that $abcd=1$.", "statement": "We assume:\n\u2022 a, b, c, d are positive real numbers [tc_1].\n\u2022 abcd = 1 [tc_2].\n\u2022 $(1+a^2)(1+b^2)(1+c^2)(1+d^2) \\ge (a+c+bd+1)^2$ [l2].\n\u2022 $a+c+bd+1 \\ge a+b+c+d$ is equivalent to $bd+1 \\ge b+d$ [l3].\nTherefore, we conclude:\n\u2022 $bd+1 \\ge b+d$ [l4].", "dependencies": ["tc_1", "tc_2", "l1", "l2", "l3"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l4 (a b c d : \u211d) (ha : 0 < a) (hb : 0 < b) (hc : 0 < c) (hd : 0 < d) \n  (h_constraint : a * b * c * d = 1) : \n  (1 + a^2) * (1 + b^2) * (1 + c^2) * (1 + d^2) \u2265 (a + b + c + d)^2 := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l4 (a b c d : \u211d) (ha : 0 < a) (hb : 0 < b) (hc : 0 < c) (hd : 0 < d) \n  (h_constraint : a * b * c * d = 1) : \n  (1 + a^2) * (1 + b^2) * (1 + c^2) * (1 + d^2) \u2265 (a + b + c + d)^2 := by\n  have h_sum_pairs : a^2*b^2 + a^2*c^2 + a^2*d^2 + b^2*c^2 + b^2*d^2 + c^2*d^2 + 6 \u2265 2*(a*b + a*c + a*d + b*c + b*d + c*d) := by\n    have h\u2081 : a^2*b^2 + 1 \u2265 2*a*b := by\n      have h\u2081\u2080 : 0 \u2264 (a*b - 1)^2 := sq_nonneg (a*b - 1)\n      nlinarith\n    have h\u2082 : a^2*c^2 + 1 \u2265 2*a*c := by\n      have h\u2082\u2080 : 0 \u2264 (a*c - 1)^2 := sq_nonneg (a*c - 1)\n      nlinarith\n    have h\u2083 : a^2*d^2 + 1 \u2265 2*a*d := by\n      have h\u2083\u2080 : 0 \u2264 (a*d - 1)^2 := sq_nonneg (a*d - 1)\n      nlinarith\n    have h\u2084 : b^2*c^2 + 1 \u2265 2*b*c := by\n      have h\u2084\u2080 : 0 \u2264 (b*c - 1)^2 := sq_nonneg (b*c - 1)\n      nlinarith\n    have h\u2085 : b^2*d^2 + 1 \u2265 2*b*d := by\n      have h\u2085\u2080 : 0 \u2264 (b*d - 1)^2 := sq_nonneg (b*d - 1)\n      nlinarith\n    have h\u2086 : c^2*d^2 + 1 \u2265 2*c*d := by\n      have h\u2086\u2080 : 0 \u2264 (c*d - 1)^2 := sq_nonneg (c*d - 1)\n      nlinarith\n    nlinarith\n  \n  have h_expand_main : (1 + a^2) * (1 + b^2) * (1 + c^2) * (1 + d^2) = 1 + (a^2 + b^2 + c^2 + d^2) + (a^2*b^2 + a^2*c^2 + a^2*d^2 + b^2*c^2 + b^2*d^2 + c^2*d^2) + (a^2*b^2*c^2 + a^2*b^2*d^2 + a^2*c^2*d^2 + b^2*c^2*d^2) + a^2*b^2*c^2*d^2 := by\n    ring_nf\n    <;>\n    (try simp [mul_assoc])\n    <;>\n    (try ring_nf)\n    <;>\n    (try nlinarith [ha, hb, hc, hd, h_constraint])\n    <;>\n    (try linarith)\n  \n  have h_expand_square : (a + b + c + d)^2 = (a^2 + b^2 + c^2 + d^2) + 2*(a*b + a*c + a*d + b*c + b*d + c*d) := by\n    ring_nf\n    <;>\n    (try simp [add_assoc])\n    <;>\n    (try ring_nf)\n    <;>\n    (try nlinarith [ha, hb, hc, hd, h_constraint])\n    <;>\n    (try linarith)\n  \n  have h_main_diff : (1 + a^2) * (1 + b^2) * (1 + c^2) * (1 + d^2) - (a + b + c + d)^2 \u2265 -4 + (a^2*b^2*c^2 + a^2*b^2*d^2 + a^2*c^2*d^2 + b^2*c^2*d^2) := by\n    have h\u2081 : (1 + a^2) * (1 + b^2) * (1 + c^2) * (1 + d^2) - (a + b + c + d)^2 = 1 + (a^2*b^2 + a^2*c^2 + a^2*d^2 + b^2*c^2 + b^2*d^2 + c^2*d^2) + (a^2*b^2*c^2 + a^2*b^2*d^2 + a^2*c^2*d^2 + b^2*c^2*d^2) + a^2*b^2*c^2*d^2 - 2*(a*b + a*c + a*d + b*c + b*d + c*d) := by\n      rw [h_expand_main, h_expand_square]\n      <;> ring_nf\n      <;>\n      (try simp [add_assoc])\n      <;>\n      (try ring_nf)\n      <;>\n      (try nlinarith [ha, hb, hc, hd, h_constraint])\n      <;>\n      (try linarith)\n    rw [h\u2081]\n    have h\u2082 : a^2*b^2*c^2*d^2 = 1 := by\n      calc\n        a^2 * b^2 * c^2 * d^2 = (a * b * c * d)^2 := by ring\n        _ = 1^2 := by rw [h_constraint]\n        _ = 1 := by norm_num\n    have h\u2083 : 1 + (a^2*b^2 + a^2*c^2 + a^2*d^2 + b^2*c^2 + b^2*d^2 + c^2*d^2) + (a^2*b^2*c^2 + a^2*b^2*d^2 + a^2*c^2*d^2 + b^2*c^2*d^2) + a^2*b^2*c^2*d^2 - 2*(a*b + a*c + a*d + b*c + b*d + c*d) \u2265 -4 + (a^2*b^2*c^2 + a^2*b^2*d^2 + a^2*c^2*d^2 + b^2*c^2*d^2) := by\n      nlinarith [h_sum_pairs]\n    linarith\n  \n  have h_ab_cd : a*b + c*d \u2265 2 := by\n    have h\u2081 : 0 < a * b := mul_pos ha hb\n    have h\u2082 : 0 < c * d := mul_pos hc hd\n    have h\u2083 : 0 < a * b * (c * d) := by positivity\n    have h\u2084 : a * b * (c * d) = 1 := by\n      calc\n        a * b * (c * d) = a * b * c * d := by ring\n        _ = 1 := h_constraint\n    have h\u2085 : a * b + c * d \u2265 2 := by\n      nlinarith [sq_nonneg (a * b - c * d), sq_nonneg (a * b - 1), sq_nonneg (c * d - 1)]\n    exact h\u2085\n  \n  have h_ac_bd : a*c + b*d \u2265 2 := by\n    have h\u2081 : 0 < a * c := mul_pos ha hc\n    have h\u2082 : 0 < b * d := mul_pos hb hd\n    have h\u2083 : 0 < a * c * (b * d) := by positivity\n    have h\u2084 : a * c * (b * d) = 1 := by\n      calc\n        a * c * (b * d) = a * b * c * d := by ring\n        _ = 1 := h_constraint\n    have h\u2085 : a * c + b * d \u2265 2 := by\n      nlinarith [sq_nonneg (a * c - b * d), sq_nonneg (a * c - 1), sq_nonneg (b * d - 1)]\n    exact h\u2085\n  \n  have h_sum_ab : a*b + c*d + a*c + b*d \u2265 4 := by\n    linarith [h_ab_cd, h_ac_bd]\n  \n  have h_sum_triples : a^2*b^2*c^2 + a^2*b^2*d^2 + a^2*c^2*d^2 + b^2*c^2*d^2 \u2265 4 := by\n    have h\u2081 : 0 < a * b := mul_pos ha hb\n    have h\u2082 : 0 < a * c := mul_pos ha hc\n    have h\u2083 : 0 < a * d := mul_pos ha hd\n    have h\u2084 : 0 < b * c := mul_pos hb hc\n    have h\u2085 : 0 < b * d := mul_pos hb hd\n    have h\u2086 : 0 < c * d := mul_pos hc hd\n    have h\u2087 : a * b * c * d = 1 := h_constraint\n    have h\u2088 : a ^ 2 * b ^ 2 * (c ^ 2 + d ^ 2) + c ^ 2 * d ^ 2 * (a ^ 2 + b ^ 2) \u2265 2 * (a * b) + 2 * (c * d) := by\n      have h\u2088\u2081 : a ^ 2 * b ^ 2 * (c ^ 2 + d ^ 2) \u2265 2 * a ^ 2 * b ^ 2 * (c * d) := by\n        have h\u2088\u2081\u2081 : c ^ 2 + d ^ 2 \u2265 2 * (c * d) := by\n          nlinarith [sq_nonneg (c - d)]\n        have h\u2088\u2081\u2082 : 0 \u2264 a ^ 2 * b ^ 2 := by positivity\n        nlinarith\n      have h\u2088\u2082 : c ^ 2 * d ^ 2 * (a ^ 2 + b ^ 2) \u2265 2 * c ^ 2 * d ^ 2 * (a * b) := by\n        have h\u2088\u2082\u2081 : a ^ 2 + b ^ 2 \u2265 2 * (a * b) := by\n          nlinarith [sq_nonneg (a - b)]\n        have h\u2088\u2082\u2082 : 0 \u2264 c ^ 2 * d ^ 2 := by positivity\n        nlinarith\n      have h\u2088\u2083 : 2 * a ^ 2 * b ^ 2 * (c * d) + 2 * c ^ 2 * d ^ 2 * (a * b) = 2 * (a * b) + 2 * (c * d) := by\n        have h\u2088\u2083\u2081 : a * b * c * d = 1 := h_constraint\n        have h\u2088\u2083\u2082 : a ^ 2 * b ^ 2 * (c * d) = (a * b) * (a * b * c * d) := by ring\n        have h\u2088\u2083\u2083 : c ^ 2 * d ^ 2 * (a * b) = (c * d) * (a * b * c * d) := by ring\n        calc\n          2 * a ^ 2 * b ^ 2 * (c * d) + 2 * c ^ 2 * d ^ 2 * (a * b) = 2 * (a ^ 2 * b ^ 2 * (c * d)) + 2 * (c ^ 2 * d ^ 2 * (a * b)) := by ring\n          _ = 2 * ((a * b) * (a * b * c * d)) + 2 * ((c * d) * (a * b * c * d)) := by\n            rw [h\u2088\u2083\u2082, h\u2088\u2083\u2083]\n            <;> ring\n          _ = 2 * ((a * b) * 1) + 2 * ((c * d) * 1) := by rw [h\u2088\u2083\u2081]\n          _ = 2 * (a * b) + 2 * (c * d) := by ring\n      nlinarith\n    have h\u2089 : a ^ 2 * c ^ 2 * (b ^ 2 + d ^ 2) + b ^ 2 * d ^ 2 * (a ^ 2 + c ^ 2) \u2265 2 * (a * c) + 2 * (b * d) := by\n      have h\u2089\u2081 : a ^ 2 * c ^ 2 * (b ^ 2 + d ^ 2) \u2265 2 * a ^ 2 * c ^ 2 * (b * d) := by\n        have h\u2089\u2081\u2081 : b ^ 2 + d ^ 2 \u2265 2 * (b * d) := by\n          nlinarith [sq_nonneg (b - d)]\n        have h\u2089\u2081\u2082 : 0 \u2264 a ^ 2 * c ^ 2 := by positivity\n        nlinarith\n      have h\u2089\u2082 : b ^ 2 * d ^ 2 * (a ^ 2 + c ^ 2) \u2265 2 * b ^ 2 * d ^ 2 * (a * c) := by\n        have h\u2089\u2082\u2081 : a ^ 2 + c ^ 2 \u2265 2 * (a * c) := by\n          nlinarith [sq_nonneg (a - c)]\n        have h\u2089\u2082\u2082 : 0 \u2264 b ^ 2 * d ^ 2 := by positivity\n        nlinarith\n      have h\u2089\u2083 : 2 * a ^ 2 * c ^ 2 * (b * d) + 2 * b ^ 2 * d ^ 2 * (a * c) = 2 * (a * c) + 2 * (b * d) := by\n        have h\u2089\u2083\u2081 : a * b * c * d = 1 := h_constraint\n        have h\u2089\u2083\u2082 : a ^ 2 * c ^ 2 * (b * d) = (a * c) * (a * b * c * d) := by ring\n        have h\u2089\u2083\u2083 : b ^ 2 * d ^ 2 * (a * c) = (b * d) * (a * b * c * d) := by ring\n        calc\n          2 * a ^ 2 * c ^ 2 * (b * d) + 2 * b ^ 2 * d ^ 2 * (a * c) = 2 * (a ^ 2 * c ^ 2 * (b * d)) + 2 * (b ^ 2 * d ^ 2 * (a * c)) := by ring\n          _ = 2 * ((a * c) * (a * b * c * d)) + 2 * ((b * d) * (a * b * c * d)) := by\n            rw [h\u2089\u2083\u2082, h\u2089\u2083\u2083]\n            <;> ring\n          _ = 2 * ((a * c) * 1) + 2 * ((b * d) * 1) := by rw [h\u2089\u2083\u2081]\n          _ = 2 * (a * c) + 2 * (b * d) := by ring\n      nlinarith\n    have h\u2081\u2080 : 2 * (a ^ 2 * b ^ 2 * c ^ 2 + a ^ 2 * b ^ 2 * d ^ 2 + a ^ 2 * c ^ 2 * d ^ 2 + b ^ 2 * c ^ 2 * d ^ 2) \u2265 2 * (a * b + c * d + a * c + b * d) := by\n      have h\u2081\u2080\u2081 : a ^ 2 * b ^ 2 * (c ^ 2 + d ^ 2) + c ^ 2 * d ^ 2 * (a ^ 2 + b ^ 2) + (a ^ 2 * c ^ 2 * (b ^ 2 + d ^ 2) + b ^ 2 * d ^ 2 * (a ^ 2 + c ^ 2)) \u2265 2 * (a * b) + 2 * (c * d) + 2 * (a * c) + 2 * (b * d) := by\n        linarith [h\u2088, h\u2089]\n      have h\u2081\u2080\u2082 : a ^ 2 * b ^ 2 * (c ^ 2 + d ^ 2) + c ^ 2 * d ^ 2 * (a ^ 2 + b ^ 2) + (a ^ 2 * c ^ 2 * (b ^ 2 + d ^ 2) + b ^ 2 * d ^ 2 * (a ^ 2 + c ^ 2)) = 2 * (a ^ 2 * b ^ 2 * c ^ 2 + a ^ 2 * b ^ 2 * d ^ 2 + a ^ 2 * c ^ 2 * d ^ 2 + b ^ 2 * c ^ 2 * d ^ 2) := by\n        ring_nf\n        <;>\n        (try simp [add_assoc])\n        <;>\n        (try ring_nf)\n        <;>\n        (try nlinarith [ha, hb, hc, hd, h_constraint])\n        <;>\n        (try linarith)\n      linarith\n    nlinarith [h_sum_ab]\n  \n  have h_final : (1 + a^2) * (1 + b^2) * (1 + c^2) * (1 + d^2) \u2265 (a + b + c + d)^2 := by\n    have h\u2081 : (1 + a^2) * (1 + b^2) * (1 + c^2) * (1 + d^2) - (a + b + c + d)^2 \u2265 -4 + (a^2*b^2*c^2 + a^2*b^2*d^2 + a^2*c^2*d^2 + b^2*c^2*d^2) := h_main_diff\n    have h\u2082 : a^2*b^2*c^2 + a^2*b^2*d^2 + a^2*c^2*d^2 + b^2*c^2*d^2 \u2265 4 := h_sum_triples\n    have h\u2083 : (1 + a^2) * (1 + b^2) * (1 + c^2) * (1 + d^2) - (a + b + c + d)^2 \u2265 0 := by\n      linarith\n    linarith\n  \n  exact h_final", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 3}, "score": {"semantic_score": 0, "semantic_feedback": ["The Lean formalization has a major inconsistency in the main inequality. The natural language specifies the right-hand side as (a+c+bd+1)\u00b2, but the Lean code uses (a+b+c+d)\u00b2. This completely changes the mathematical statement being proved. Additionally, the Lean formalization is missing the equivalence statement, the logical reasoning chain, and the actual conclusion bd+1 \u2265 b+d that the natural language is trying to establish.", "Wrong dependencies in Lean4 tactics!"]}, "error_report": {"error_type": "Formalizer", "error_report": "Formalization is likely incorrect: semantic score is 0.0, below threshold 0.6.\nScorer feedback: ['The Lean formalization has a major inconsistency in the main inequality. The natural language specifies the right-hand side as (a+c+bd+1)\u00b2, but the Lean code uses (a+b+c+d)\u00b2. This completely changes the mathematical statement being proved. Additionally, the Lean formalization is missing the equivalence statement, the logical reasoning chain, and the actual conclusion bd+1 \u2265 b+d that the natural language is trying to establish.']"}, "solved_negation": null, "type": "lemma"}, "l5": {"id": "l5", "natural_language": "The remaining step is to show $a+c+bd+1 \\ge a+b+c+d$", "statement": "We assume:\n\u2022 a, b, c, d are positive real numbers [tc_1].\n\u2022 abcd = 1 [tc_2].\n\u2022 $(1+a^2)(1+b^2)(1+c^2)(1+d^2) \\ge (a+c+bd+1)^2$ [l2].\n\u2022 The inequality $a+c+bd+1 \\ge a+b+c+d$ is equivalent to $bd+1 \\ge b+d$ [l3].\n\u2022 $bd+1 \\ge b+d$ [l4].\nTherefore, we conclude:\n\u2022 $a+c+bd+1 \\ge a+b+c+d$ [l5].", "dependencies": ["tc_1", "tc_2", "l1", "l2", "l3", "l4"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l5 \n  (a b c d : \u211d) \n  (ha : 0 < a) (hb : 0 < b) (hc : 0 < c) (hd : 0 < d)\n  (h_constraint : a * b * c * d = 1)\n  (l1 : (1 + a^2) * (1 + b^2) * (1 + c^2) * (1 + d^2) \u2265 (a + b + c + d)^2)\n  (l2 : (1 + a^2) * (1 + b^2) * (1 + c^2) * (1 + d^2) \u2265 (a + c + b * d + 1)^2)\n  (l3 : (a + c + b * d + 1 \u2265 a + b + c + d \u2194 b * d + 1 \u2265 b + d))\n  (l4 : b * d + 1 \u2265 b + d) :\n  a + c + b * d + 1 \u2265 a + b + c + d := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l5 \n  (a b c d : \u211d) \n  (ha : 0 < a) (hb : 0 < b) (hc : 0 < c) (hd : 0 < d)\n  (h_constraint : a * b * c * d = 1)\n  (l1 : (1 + a^2) * (1 + b^2) * (1 + c^2) * (1 + d^2) \u2265 (a + b + c + d)^2)\n  (l2 : (1 + a^2) * (1 + b^2) * (1 + c^2) * (1 + d^2) \u2265 (a + c + b * d + 1)^2)\n  (l3 : (a + c + b * d + 1 \u2265 a + b + c + d \u2194 b * d + 1 \u2265 b + d))\n  (l4 : b * d + 1 \u2265 b + d) :\n  a + c + b * d + 1 \u2265 a + b + c + d := by\n  have h_main : a + c + b * d + 1 \u2265 a + b + c + d := by\n    have h5 : a + c + b * d + 1 \u2265 a + b + c + d \u2194 b * d + 1 \u2265 b + d := l3\n    have h6 : b * d + 1 \u2265 b + d := l4\n    have h7 : a + c + b * d + 1 \u2265 a + b + c + d := by\n      -- Use the equivalence to deduce the desired inequality\n      have h8 : b * d + 1 \u2265 b + d := h6\n      have h9 : (a + c + b * d + 1 \u2265 a + b + c + d) \u2194 (b * d + 1 \u2265 b + d) := h5\n      have h10 : a + c + b * d + 1 \u2265 a + b + c + d := by\n        -- Since b * d + 1 \u2265 b + d is true, we can use the equivalence to get the other side\n        have h11 : b * d + 1 \u2265 b + d := h8\n        have h12 : (a + c + b * d + 1 \u2265 a + b + c + d) \u2194 (b * d + 1 \u2265 b + d) := h9\n        -- Use the equivalence to get the desired inequality\n        have h13 : a + c + b * d + 1 \u2265 a + b + c + d := by\n          -- Since b * d + 1 \u2265 b + d is true, we can use the equivalence to get the other side\n          apply (h12.mpr)\n          exact h11\n        exact h13\n      exact h10\n    exact h7\n  exact h_main", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The Lean formalization correctly captures all components from the natural language. The positivity conditions, constraint equation, inequalities, equivalence statement, and conclusion all match perfectly. There is one extra assumption (l1) in the Lean code that wasn't mentioned in the natural language, but this is acceptable as it represents additional logically consistent information that doesn't contradict or interfere with the stated problem. The mathematical expressions, logical relationships, and overall structure are faithfully preserved."]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "lemma"}, "l6": {"id": "l6", "natural_language": "Combining these, we obtain...", "statement": "We assume:\n\u2022 a, b, c, d are positive real numbers [tc_1].\n\u2022 abcd = 1 [tc_2].\n\u2022 $(1+a^2)(1+b^2)(1+c^2)(1+d^2) \\ge (a+c+bd+1)^2$ [l2].\n\u2022 $a+c+bd+1 \\ge a+b+c+d$ [l5].\nTherefore, we conclude:\n\u2022 $(a+c+bd+1)^2 \\ge (a+b+c+d)^2$ [l6].", "dependencies": ["tc_1", "tc_2", "l1", "l2", "l3", "l4", "l5"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l6 \n  (a b c d : \u211d) \n  (ha : 0 < a) (hb : 0 < b) (hc : 0 < c) (hd : 0 < d)\n  (h_constraint : a * b * c * d = 1)\n  (h_l1 : (1 + a^2) * (1 + b^2) * (1 + c^2) * (1 + d^2) \u2265 (a + b + c + d)^2)\n  (h_l2 : (1 + a^2) * (1 + b^2) * (1 + c^2) * (1 + d^2) \u2265 (a + c + b * d + 1)^2)\n  (h_l3 : (a + c + b * d + 1 \u2265 a + b + c + d \u2194 b * d + 1 \u2265 b + d))\n  (h_l4 : b * d + 1 \u2265 b + d)\n  (h_l5 : a + c + b * d + 1 \u2265 a + b + c + d) :\n  (a + c + b * d + 1)^2 \u2265 (a + b + c + d)^2 := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l6 \n  (a b c d : \u211d) \n  (ha : 0 < a) (hb : 0 < b) (hc : 0 < c) (hd : 0 < d)\n  (h_constraint : a * b * c * d = 1)\n  (h_l1 : (1 + a^2) * (1 + b^2) * (1 + c^2) * (1 + d^2) \u2265 (a + b + c + d)^2)\n  (h_l2 : (1 + a^2) * (1 + b^2) * (1 + c^2) * (1 + d^2) \u2265 (a + c + b * d + 1)^2)\n  (h_l3 : (a + c + b * d + 1 \u2265 a + b + c + d \u2194 b * d + 1 \u2265 b + d))\n  (h_l4 : b * d + 1 \u2265 b + d)\n  (h_l5 : a + c + b * d + 1 \u2265 a + b + c + d) :\n  (a + c + b * d + 1)^2 \u2265 (a + b + c + d)^2 := by\n  have h_sum_nonneg : 0 \u2264 a + b + c + d := by\n    have h\u2081 : 0 < a + b + c + d := by linarith [ha, hb, hc, hd]\n    linarith\n  \n  have h_main_ineq : (a + b + c + d)^2 \u2264 (a + c + b * d + 1)^2 := by\n    have h\u2081 : a + b + c + d \u2264 a + c + b * d + 1 := by\n      linarith [h_l5]\n    have h\u2082 : 0 \u2264 a + b + c + d := h_sum_nonneg\n    have h\u2083 : 0 \u2264 a + c + b * d + 1 := by\n      nlinarith [mul_pos ha hc, mul_pos hb hd, ha, hb, hc, hd]\n    -- Use the fact that if x \u2264 y and x, y \u2265 0, then x\u00b2 \u2264 y\u00b2\n    nlinarith [sq_nonneg (a + b + c + d - (a + c + b * d + 1))]\n  \n  have h_final : (a + c + b * d + 1)^2 \u2265 (a + b + c + d)^2 := by\n    linarith [h_main_ineq]\n  \n  exact h_final", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["Variable declarations and positivity constraints are correctly formalized", "The constraint equation abcd = 1 is accurately captured", "The first inequality l2 is correctly translated with proper operator precedence", "The second inequality l5 is accurately formalized", "The conclusion l6 correctly captures the desired inequality. The extra hypotheses h_l1, h_l3, and h_l4 provide additional context without contradicting the natural language statement"]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "lemma"}, "ts_1": {"id": "ts_1", "natural_language": "Combining these, we obtain $(1+a^2)(1+b^2)(1+c^2)(1+d^2) \\ge (a+b+c+d)^2$, completing the proof.", "statement": "We assume:\n\u2022 a, b, c, d are positive real numbers [tc_1].\n\u2022 abcd = 1 [tc_2].\n\u2022 $(1+a^2)(1+b^2)(1+c^2)(1+d^2) \\ge (a+c+bd+1)^2$ [l2].\n\u2022 $a+c+bd+1 \\ge a+b+c+d$ [l5].\n\u2022 $(a+c+bd+1)^2 \\ge (a+b+c+d)^2$ [l6].\nTherefore, we conclude:\n\u2022 $(1+a^2)(1+b^2)(1+c^2)(1+d^2) \\ge (a+b+c+d)^2$ [ts_1].", "dependencies": ["tc_1", "tc_2", "l1", "l2", "l3", "l4", "l5", "l6"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem ts_1 (a b c d : \u211d) (ha : 0 < a) (hb : 0 < b) (hc : 0 < c) (hd : 0 < d) \n  (h_constraint : a * b * c * d = 1) : \n  (1 + a^2) * (1 + b^2) * (1 + c^2) * (1 + d^2) \u2265 (a + b + c + d)^2 := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem ts_1 (a b c d : \u211d) (ha : 0 < a) (hb : 0 < b) (hc : 0 < c) (hd : 0 < d) \n  (h_constraint : a * b * c * d = 1) : \n  (1 + a^2) * (1 + b^2) * (1 + c^2) * (1 + d^2) \u2265 (a + b + c + d)^2 := by\n  have h\u2081 : a^2 * b^2 * c^2 + a^2 * b^2 * d^2 + a^2 * c^2 * d^2 + b^2 * c^2 * d^2 \u2265 4 := by\n    have h\u2081\u2080 : 0 \u2264 (a * b * c - a * b * d)^2 := sq_nonneg _\n    have h\u2081\u2081 : 0 \u2264 (a * c * d - b * c * d)^2 := sq_nonneg _\n    have h\u2081\u2082 : a^2 * b^2 * c^2 + a^2 * b^2 * d^2 \u2265 2 * a^2 * b^2 * c * d := by\n      nlinarith [h\u2081\u2080]\n    have h\u2081\u2083 : a^2 * c^2 * d^2 + b^2 * c^2 * d^2 \u2265 2 * a * b * c^2 * d^2 := by\n      nlinarith [h\u2081\u2081]\n    have h\u2081\u2084 : a^2 * b^2 * c^2 + a^2 * b^2 * d^2 + a^2 * c^2 * d^2 + b^2 * c^2 * d^2 \u2265 2 * a^2 * b^2 * c * d + 2 * a * b * c^2 * d^2 := by\n      linarith\n    have h\u2081\u2085 : 2 * a^2 * b^2 * c * d = 2 * a * b := by\n      have h\u2081\u2085\u2081 : a * b * c * d = 1 := h_constraint\n      have h\u2081\u2085\u2082 : a * b > 0 := mul_pos ha hb\n      have h\u2081\u2085\u2083 : c * d = 1 / (a * b) := by\n        have h\u2081\u2085\u2084 : a * b * (c * d) = 1 := by linarith\n        field_simp [h\u2081\u2085\u2082.ne'] at h\u2081\u2085\u2084 \u22a2\n        <;> nlinarith\n      calc\n        2 * a^2 * b^2 * c * d = 2 * (a * b)^2 * (c * d) := by ring\n        _ = 2 * (a * b)^2 * (1 / (a * b)) := by rw [h\u2081\u2085\u2083]\n        _ = 2 * (a * b) := by\n          field_simp [h\u2081\u2085\u2082.ne']\n          <;> ring\n          <;> field_simp [h\u2081\u2085\u2082.ne']\n          <;> nlinarith\n        _ = 2 * a * b := by ring\n    have h\u2081\u2086 : 2 * a * b * c^2 * d^2 = 2 / (a * b) := by\n      have h\u2081\u2086\u2081 : a * b * c * d = 1 := h_constraint\n      have h\u2081\u2086\u2082 : a * b > 0 := mul_pos ha hb\n      have h\u2081\u2086\u2083 : c * d = 1 / (a * b) := by\n        have h\u2081\u2086\u2084 : a * b * (c * d) = 1 := by linarith\n        field_simp [h\u2081\u2086\u2082.ne'] at h\u2081\u2086\u2084 \u22a2\n        <;> nlinarith\n      calc\n        2 * a * b * c^2 * d^2 = 2 * (a * b) * (c * d)^2 := by ring\n        _ = 2 * (a * b) * (1 / (a * b))^2 := by rw [h\u2081\u2086\u2083]\n        _ = 2 / (a * b) := by\n          field_simp [h\u2081\u2086\u2082.ne']\n          <;> ring\n          <;> field_simp [h\u2081\u2086\u2082.ne']\n          <;> nlinarith\n    have h\u2081\u2087 : 2 * a^2 * b^2 * c * d + 2 * a * b * c^2 * d^2 = 2 * a * b + 2 / (a * b) := by\n      rw [h\u2081\u2085, h\u2081\u2086]\n      <;> ring\n    have h\u2081\u2088 : a^2 * b^2 * c^2 + a^2 * b^2 * d^2 + a^2 * c^2 * d^2 + b^2 * c^2 * d^2 \u2265 2 * a * b + 2 / (a * b) := by\n      linarith\n    have h\u2081\u2089 : 2 * a * b + 2 / (a * b) \u2265 4 := by\n      have h\u2081\u2089\u2081 : 0 < a * b := mul_pos ha hb\n      field_simp [h\u2081\u2089\u2081.ne']\n      rw [le_div_iff (by positivity)]\n      nlinarith [sq_nonneg (a * b - 1)]\n    linarith\n  \n  have h\u2082 : a^2 * b^2 + 1 \u2265 2 * a * b := by\n    have h\u2083 : 0 \u2264 (a * b - 1) ^ 2 := sq_nonneg _\n    nlinarith [sq_nonneg (a * b - 1)]\n  \n  have h\u2083 : a^2 * c^2 + 1 \u2265 2 * a * c := by\n    have h\u2084 : 0 \u2264 (a * c - 1) ^ 2 := sq_nonneg _\n    nlinarith [sq_nonneg (a * c - 1)]\n  \n  have h\u2084 : a^2 * d^2 + 1 \u2265 2 * a * d := by\n    have h\u2085 : 0 \u2264 (a * d - 1) ^ 2 := sq_nonneg _\n    nlinarith [sq_nonneg (a * d - 1)]\n  \n  have h\u2085 : b^2 * c^2 + 1 \u2265 2 * b * c := by\n    have h\u2086 : 0 \u2264 (b * c - 1) ^ 2 := sq_nonneg _\n    nlinarith [sq_nonneg (b * c - 1)]\n  \n  have h\u2086 : b^2 * d^2 + 1 \u2265 2 * b * d := by\n    have h\u2087 : 0 \u2264 (b * d - 1) ^ 2 := sq_nonneg _\n    nlinarith [sq_nonneg (b * d - 1)]\n  \n  have h\u2087 : c^2 * d^2 + 1 \u2265 2 * c * d := by\n    have h\u2088 : 0 \u2264 (c * d - 1) ^ 2 := sq_nonneg _\n    nlinarith [sq_nonneg (c * d - 1)]\n  \n  have h\u2088 : (a^2 * b^2 + a^2 * c^2 + a^2 * d^2 + b^2 * c^2 + b^2 * d^2 + c^2 * d^2) + 6 \u2265 2 * (a * b + a * c + a * d + b * c + b * d + c * d) := by\n    linarith [h\u2082, h\u2083, h\u2084, h\u2085, h\u2086, h\u2087]\n  \n  have h\u2089 : (1 + a^2) * (1 + b^2) * (1 + c^2) * (1 + d^2) \u2265 (a + b + c + d)^2 := by\n    have h\u2081\u2080 : (1 + a^2) * (1 + b^2) * (1 + c^2) * (1 + d^2) = 1 + (a^2 + b^2 + c^2 + d^2) + (a^2 * b^2 + a^2 * c^2 + a^2 * d^2 + b^2 * c^2 + b^2 * d^2 + c^2 * d^2) + (a^2 * b^2 * c^2 + a^2 * b^2 * d^2 + a^2 * c^2 * d^2 + b^2 * c^2 * d^2) + a^2 * b^2 * c^2 * d^2 := by\n      ring\n    rw [h\u2081\u2080]\n    have h\u2081\u2081 : a^2 * b^2 * c^2 * d^2 = 1 := by\n      calc\n        a ^ 2 * b ^ 2 * c ^ 2 * d ^ 2 = (a * b * c * d) ^ 2 := by ring\n        _ = 1 ^ 2 := by rw [h_constraint]\n        _ = 1 := by norm_num\n    have h\u2081\u2082 : (a + b + c + d)^2 = (a^2 + b^2 + c^2 + d^2) + 2 * (a * b + a * c + a * d + b * c + b * d + c * d) := by\n      ring\n    rw [h\u2081\u2082]\n    have h\u2081\u2083 : 1 + (a^2 + b^2 + c^2 + d^2) + (a^2 * b^2 + a^2 * c^2 + a^2 * d^2 + b^2 * c^2 + b^2 * d^2 + c^2 * d^2) + (a^2 * b^2 * c^2 + a^2 * b^2 * d^2 + a^2 * c^2 * d^2 + b^2 * c^2 * d^2) + a^2 * b^2 * c^2 * d^2 \u2265 (a^2 + b^2 + c^2 + d^2) + 2 * (a * b + a * c + a * d + b * c + b * d + c * d) := by\n      nlinarith [h\u2081, h\u2088]\n    linarith\n  \n  exact h\u2089", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 3}, "score": {"semantic_score": 0.0, "semantic_feedback": ["Variable declarations correctly capture that a, b, c, d are real numbers", "Positivity constraints correctly capture that all variables are positive real numbers", "Product constraint correctly captures the condition abcd = 1", "The Lean formalization is missing the intermediate assumptions [l2], [l5], and [l6] that are explicitly stated in the natural language as part of the logical argument structure", "The conclusion correctly captures the final inequality statement"]}, "error_report": {"error_type": "Formalizer", "error_report": "Formalization is likely incorrect: semantic score is 0.0, below threshold 0.6.\nScorer feedback: ['Variable declarations correctly capture that a, b, c, d are real numbers', 'Positivity constraints correctly capture that all variables are positive real numbers', 'Product constraint correctly captures the condition abcd = 1', 'The Lean formalization is missing the intermediate assumptions [l2], [l5], and [l6] that are explicitly stated in the natural language as part of the logical argument structure', 'The conclusion correctly captures the final inequality statement']"}, "solved_negation": null, "type": "solution"}};
            
            // Create nodes and edges
            var nodes = new vis.DataSet([{"id": "tc_1", "label": "tc_1", "color": {"background": "#eba0a0", "border": "#00ff00", "highlight": {"background": "#eba0a0", "border": "#00ff00"}}, "shape": "box", "size": 30, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "tc_2", "label": "tc_2", "color": {"background": "#eba0a0", "border": "#00ff00", "highlight": {"background": "#eba0a0", "border": "#00ff00"}}, "shape": "box", "size": 30, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l1", "label": "l1", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l2", "label": "l2", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l3", "label": "l3", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l4", "label": "l4", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l5", "label": "l5", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l6", "label": "l6", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "ts_1", "label": "ts_1", "color": {"background": "#a3c2a8", "border": "#00ff00", "highlight": {"background": "#a3c2a8", "border": "#00ff00"}}, "shape": "star", "size": 40, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}]);
            var edges = new vis.DataSet([{"from": "tc_1", "to": "tc_2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "l1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "l2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "l3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "l4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "l5", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "l6", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_2", "to": "l1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_2", "to": "l2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_2", "to": "l3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_2", "to": "l4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_2", "to": "l5", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_2", "to": "l6", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_2", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "l2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "l3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "l4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "l5", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "l6", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l2", "to": "l3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l2", "to": "l4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l2", "to": "l5", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l2", "to": "l6", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l2", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l3", "to": "l4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l3", "to": "l5", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l3", "to": "l6", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l3", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l4", "to": "l5", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l4", "to": "l6", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l4", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l5", "to": "l6", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l5", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l6", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}]);
            
            // Create network
            var container = document.getElementById('mynetwork');
            var data = {
                nodes: nodes,
                edges: edges
            };
            
            var options = {
                physics: {
                    enabled: true,
                    solver: 'hierarchicalRepulsion',
                    hierarchicalRepulsion: {
                        centralGravity: 0.0,
                        springLength: 200,
                        springConstant: 0.01,
                        nodeDistance: 150,
                        damping: 0.09
                    }
                },
                edges: {
                    smooth: {
                        type: 'continuous',
                        forceDirection: 'none'
                    },
                    color: {
                        color: '#666666',
                        highlight: '#666666',
                        hover: '#666666'
                    },
                    width: 2
                },
                interaction: {
                    hover: true,
                    tooltipDelay: 100,
                    navigationButtons: true,
                    keyboard: true
                },
                nodes: {
                    font: {
                        size: 14,
                        color: '#000000'
                    },
                    labelHighlightBold: false,
                    chosen: false,
                    shapeProperties: {
                        useBorderWithImage: false
                    },
                    scaling: {
                        label: {
                            enabled: true,
                            min: 8,
                            max: 20,
                            maxVisible: 20,
                            drawThreshold: 5
                        }
                    }
                }
            };
            
            var network = new vis.Network(container, data, options);
            
            // Format field value for display
            function formatFieldValue(value, fieldName) {
                if (value === null || value === undefined) {
                    return 'N/A';
                }
                
                // Handle objects (dictionaries) as sub-boxes
                if (typeof value === 'object' && !Array.isArray(value)) {
                    var html = '';
                    for (var key in value) {
                        if (value.hasOwnProperty(key)) {
                            var subValue = value[key];
                            var subValueStr = '';
                            
                            if (typeof subValue === 'object' &&
                                    !Array.isArray(subValue)) {
                                // Nested object - show as JSON
                                subValueStr = JSON.stringify(subValue, null, 2);
                            } else if (Array.isArray(subValue)) {
                                // Array - show as JSON
                                subValueStr = JSON.stringify(subValue, null, 2);
                            } else {
                                // Primitive value
                                subValueStr = String(subValue);
                            }
                            
                            // Replace escaped newlines and tabs with actual characters
                            subValueStr = subValueStr.replace(/\\n/g, '\n');
                            subValueStr = subValueStr.replace(/\\t/g, '\t');
                            subValueStr = subValueStr.replace(/\t/g, '\t');
                            
                            html += '<div class="sub-dict">';
                            html += '<div class="sub-dict-title">' + key + '</div>';
                            html += '<div class="sub-dict-content">' + subValueStr + '</div>';
                            html += '</div>';
                        }
                    }
                    return html;
                }
                
                // Convert to string for primitive values and arrays
                var strValue = String(value);
                
                // Handle arrays
                if (Array.isArray(value)) {
                    strValue = JSON.stringify(value, null, 2);
                }
                
                // Replace escaped newlines and tabs with actual characters
                strValue = strValue.replace(/\\n/g, '\n');
                strValue = strValue.replace(/\\t/g, '\t');
                strValue = strValue.replace(/\t/g, '\t');
                
                return strValue;
            }
            
            // Handle node click events
            network.on("click", function(params) {
                if (params.nodes.length > 0) {
                    var nodeId = params.nodes[0];
                    var info = nodeInfo[nodeId];
                    
                    if (info) {
                        var html = '<div class="info-header">';
                        html += '<h2>' + nodeId + '</h2>';
                        var nodeType = info.type || 'unknown';
                        var capitalizedType = nodeType.charAt(0).toUpperCase() +
                            nodeType.slice(1);
                        html += '<div class="node-type">Type: ' + capitalizedType +
                            '</div>';
                        html += '</div>';
                        
                        // Add all fields
                        for (var key in info) {
                            if (key === 'type' || key === 'id') continue;
                            
                            var fieldName = key.replace(/_/g, ' ')
                                .replace(/\b\w/g, function(l) {
                                    return l.toUpperCase();
                                });
                            var fieldValue = formatFieldValue(info[key], fieldName);
                            
                            if (fieldValue && fieldValue !== 'N/A') {
                                // Special formatting for code fields
                                var isCode = key.includes('code') ||
                                    key.includes('lean') ||
                                    key.includes('statement');
                                
                                html += '<div class="field-group">';
                                html += '<div class="field-name">' + fieldName +
                                    '</div>';
                                html += '<div class="field-value' +
                                    (isCode ? ' code' : '') + '">' +
                                    fieldValue + '</div>';
                                html += '</div>';
                            }
                        }
                        
                        document.getElementById('info-content')
                            .innerHTML = html;
                    }
                }
            });
            
            // Toggle panel function
            function togglePanel() {
                var panel = document.getElementById('info-panel');
                panel.classList.toggle('hidden');
                
                // Resize network when panel is toggled
                setTimeout(function() {
                    network.fit();
                }, 300);
            }
            
            // Initial network fit
            network.once('stabilized', function() {
                network.fit();
            });
            
            // Resizable panels functionality
            function makeResizable() {
                const verticalResizer = document.getElementById('vertical-resizer');
                const horizontalResizer = document.getElementById('horizontal-resizer');
                const proofPanel = document.getElementById('proof-str-panel');
                const graphContainer = document.getElementById('graph-container');
                const infoPanel = document.getElementById('info-panel');
                const leftPanel = document.getElementById('left-panel');
                
                let isVerticalResizing = false;
                let isHorizontalResizing = false;
                
                // Vertical resizer (between proof panel and graph)
                verticalResizer.addEventListener('mousedown', function(e) {
                    isVerticalResizing = true;
                    document.addEventListener('mousemove', verticalResize);
                    document.addEventListener('mouseup', stopVerticalResize);
                    e.preventDefault();
                });
                
                function verticalResize(e) {
                    if (!isVerticalResizing) return;
                    
                    const containerHeight = leftPanel.offsetHeight;
                    const newHeight = e.clientY - leftPanel.offsetTop;
                    const minHeight = 100;
                    const maxHeight = containerHeight - 100;
                    
                    if (newHeight >= minHeight && newHeight <= maxHeight) {
                        proofPanel.style.height = newHeight + 'px';
                        graphContainer.style.height = (containerHeight - newHeight) + 'px';
                        network.fit();
                    }
                }
                
                function stopVerticalResize() {
                    isVerticalResizing = false;
                    document.removeEventListener('mousemove', verticalResize);
                    document.removeEventListener('mouseup', stopVerticalResize);
                }
                
                // Horizontal resizer (between left and right panels)
                horizontalResizer.addEventListener('mousedown', function(e) {
                    isHorizontalResizing = true;
                    document.addEventListener('mousemove', horizontalResize);
                    document.addEventListener('mouseup', stopHorizontalResize);
                    e.preventDefault();
                });
                
                function horizontalResize(e) {
                    if (!isHorizontalResizing) return;
                    
                    const containerWidth = document.querySelector('.container').offsetWidth;
                    const newWidth = e.clientX - leftPanel.offsetLeft;
                    const minWidth = 300;
                    const maxWidth = containerWidth - 300;
                    
                    if (newWidth >= minWidth && newWidth <= maxWidth) {
                        leftPanel.style.flex = 'none';
                        leftPanel.style.width = newWidth + 'px';
                        infoPanel.style.width = (containerWidth - newWidth) + 'px';
                        network.fit();
                    }
                }
                
                function stopHorizontalResize() {
                    isHorizontalResizing = false;
                    document.removeEventListener('mousemove', horizontalResize);
                    document.removeEventListener('mouseup', stopHorizontalResize);
                }
            }
            
            // Initialize resizable panels
            makeResizable();
        </script>
    </body>
    </html>
    