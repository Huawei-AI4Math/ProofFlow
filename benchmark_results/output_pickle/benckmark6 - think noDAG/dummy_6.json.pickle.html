
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Proof Graph Visualization</title>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
        <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.css" rel="stylesheet" type="text/css" />
        <style>
            body {
                margin: 0;
                padding: 0;
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
                height: 100vh;
                overflow: hidden;
            }
            
            .container {
                display: flex;
                height: 100vh;
                background: #f0f0f0;
            }
            
            #left-panel {
                flex: 1;
                display: flex;
                flex-direction: column;
                background: white;
                border-right: 2px solid #ddd;
                height: 100vh;
                overflow: hidden;
            }
            
            #proof-str-panel {
                background: #f8f9fa;
                border-bottom: 2px solid #ddd;
                padding: 15px;
                height: 200px;
                overflow-y: auto;
                flex-shrink: 0;
            }
            
            #proof-str-title {
                font-weight: 600;
                color: #2d3748;
                margin-bottom: 10px;
                font-size: 14px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
            
            #proof-str-content {
                color: #4a5568;
                line-height: 1.6;
                white-space: pre-wrap;
                word-wrap: break-word;
                font-family: 'Monaco', 'Courier New', monospace;
                font-size: 13px;
                background: white;
                padding: 12px;
                border-radius: 4px;
                border: 1px solid #e2e8f0;
            }
            
            #graph-container {
                flex: 1;
                position: relative;
                background: white;
                min-height: 0;
                overflow: hidden;
            }
            
            #mynetwork {
                width: 100%;
                height: 100%;
            }
            
            #info-panel {
                width: 40%;
                max-width: 600px;
                background: white;
                overflow-y: auto;
                padding: 20px;
                box-shadow: -2px 0 10px rgba(0,0,0,0.1);
            }
            
            #info-panel.hidden {
                display: none;
            }
            
            .info-header {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                padding: 15px;
                border-radius: 8px;
                margin-bottom: 20px;
            }
            
            .info-header h2 {
                margin: 0;
                font-size: 24px;
            }
            
            .info-header .node-type {
                opacity: 0.9;
                font-size: 14px;
                margin-top: 5px;
            }
            
            .field-group {
                background: #f8f9fa;
                border-left: 4px solid #667eea;
                padding: 15px;
                margin-bottom: 15px;
                border-radius: 4px;
            }
            
            .field-name {
                font-weight: 600;
                color: #2d3748;
                margin-bottom: 8px;
                font-size: 14px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
            
            .field-value {
                color: #4a5568;
                line-height: 1.6;
                white-space: pre-wrap;
                word-wrap: break-word;
                font-family: 'Monaco', 'Courier New', monospace;
                font-size: 13px;
            }
            
            .field-value.code {
                color: #4a5568;
                padding: 12px;
                border-radius: 4px;
                overflow-x: auto;
            }
            
            .sub-dict {
                background: #ffffff;
                border: 1px solid #e2e8f0;
                border-radius: 4px;
                padding: 10px;
                margin: 8px 0;
                box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            }
            
            .sub-dict-title {
                font-weight: 600;
                color: #4a5568;
                margin-bottom: 8px;
                font-size: 12px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                border-bottom: 1px solid #e2e8f0;
                padding-bottom: 4px;
            }
            
            .sub-dict-content {
                color: #2d3748;
                line-height: 1.5;
                font-size: 12px;
            }
            
            .placeholder {
                text-align: center;
                color: #718096;
                padding: 40px;
                font-size: 18px;
            }
            
            .placeholder-icon {
                font-size: 48px;
                margin-bottom: 20px;
                opacity: 0.3;
            }
            
            #toggle-panel {
                position: absolute;
                right: 10px;
                top: 10px;
                z-index: 1000;
                background: #667eea;
                color: white;
                border: none;
                padding: 10px 20px;
                border-radius: 5px;
                cursor: pointer;
                font-size: 14px;
                transition: background 0.3s;
            }
            
            #toggle-panel:hover {
                background: #764ba2;
            }
            
            .legend {
                position: absolute;
                top: 20px;
                left: 20px;
                background: white;
                padding: 15px;
                border-radius: 8px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
                z-index: 100;
                max-width: 300px;
            }
            
            .legend-section {
                margin-bottom: 15px;
            }
            
            .legend-section:last-child {
                margin-bottom: 0;
            }
            
            .legend-title {
                font-weight: 600;
                font-size: 12px;
                color: #2d3748;
                margin-bottom: 8px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                border-bottom: 1px solid #e2e8f0;
                padding-bottom: 4px;
            }
            
            .legend-item {
                display: flex;
                align-items: center;
                margin-bottom: 8px;
            }
            
            .legend-item:last-child {
                margin-bottom: 0;
            }
            
            .legend-color {
                width: 20px;
                height: 20px;
                margin-right: 10px;
                border-radius: 3px;
            }
            
            .resizer {
                background: #ddd;
                cursor: col-resize;
                width: 4px;
                height: 100%;
                position: absolute;
                right: 0;
                top: 0;
                z-index: 1000;
            }
            
            .resizer:hover {
                background: #bbb;
            }
            
            .resizer-vertical {
                background: #ddd;
                cursor: row-resize;
                height: 4px;
                width: 100%;
                position: absolute;
                bottom: 0;
                left: 0;
                z-index: 1000;
            }
            
            .resizer-vertical:hover {
                background: #bbb;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div id="left-panel">
                <div id="proof-str-panel">
                    <div id="proof-str-title">Informal theorem and proof</div>
                    <div id="proof-str-content">Theorem: If $n$ is an odd integer, then $n^2 \equiv 1 \pmod{8}$.

Proof: Since $n$ is odd, we can write $n = 2k + 1$ for some integer $k$. Then $n^2 = (2k + 1)^2 = 4k^2 + 4k + 1$. We can factor this as $n^2 = 4k(k + 1) + 1$. Now, either $k$ is even or $k$ is odd. If $k$ is even, then $k + 1$ is odd, and if $k$ is odd, then $k + 1$ is even. In either case, $k(k + 1)$ is even, so $k(k + 1) = 2m$ for some integer $m$. Therefore $n^2 = 4(2m) + 1 = 8m + 1$, which means $n^2 \equiv 1 \pmod{8}$.
</div>
                    <div class="resizer-vertical" id="vertical-resizer"></div>
                </div>
                <div id="graph-container">
                    <button id="toggle-panel" onclick="togglePanel()">Toggle Info Panel</button>
                    <div class="legend">
                        <div class="legend-section">
                            <div class="legend-title">Node Types</div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #eba0a0;"></div>
                                <span>Theorem Conditions (tc)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #cfb795 ;"></div>
                                <span>Theorem Definitions (def)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #8dafcc;"></div>
                                <span>Lemmas (l)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #a3c2a8;"></div>
                                <span>Theorem Solutions (ts)</span>
                            </div>

                        </div>
                        <div class="legend-section">
                            <div class="legend-title">Verification Status</div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #fa2c07;"></div>
                                <span>Formalization failed</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #FFA500;"></div>
                                <span>Formalization passed</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFFFFF; border: 2px solid #00ff00;"></div>
                                <span>Fully verified</span>
                            </div>
                        </div>
                    </div>
                    <div id="mynetwork"></div>
                </div>
            </div>
            
            <div class="resizer" id="horizontal-resizer"></div>
            
            <div id="info-panel">
                <div id="info-content">
                    <div class="placeholder">
                        <div class="placeholder-icon">ðŸ“Š</div>
                        <p>Click on a node to view its details</p>
                    </div>
                </div>
            </div>
        </div>
        
        <script type="text/javascript">
            // Store node information
            var nodeInfo = {"tc_1": {"id": "tc_1", "natural_language": "If n is an odd integer", "statement": "Premise:\n\u2022 n is an odd integer [tc_1].", "dependencies": [], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\nvariable (n : \u2124)\n(tc_1 : Odd n)", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The Lean formalization correctly captures that n is an integer (\u2124) and that tc_1 represents the condition that n is odd. The semantic meaning is identical.", "The Lean formalization contains only variable declarations and premises with no conclusions to prove, which matches the natural language statement that no conclusions are derived in this premise step."]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "type": "condition"}, "l1": {"id": "l1", "natural_language": "Since n is odd, we can write n = 2k + 1 for some integer k.", "statement": "We assume:\n\u2022 n is an odd integer [tc_1].\nTherefore, we conclude:\n\u2022 There exists an integer k such that n = 2*k + 1 [l1].", "dependencies": ["tc_1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l1 \n  (n : \u2124) \n  (tc_1 : Odd n) :\n  \u2203 k : \u2124, n = 2 * k + 1 := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l1 \n  (n : \u2124) \n  (tc_1 : Odd n) :\n  \u2203 k : \u2124, n = 2 * k + 1 := by\n  have h_main : \u2203 (k : \u2124), n = 2 * k + 1 := by\n    -- Use the definition of Odd to get the integer m such that n = 2 * m + 1\n    cases' tc_1 with m hm\n    -- We have n = 2 * m + 1 from the definition of Odd\n    refine' \u27e8m, _\u27e9\n    -- Simplify the expression to match the required form\n    linarith\n  \n  -- The main statement directly gives us the result\n  exact h_main", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The variable declaration and assumption are correctly formalized. The integer type \u2124 properly represents 'integer' and 'Odd n' is the standard Lean predicate for expressing that n is odd.", "The existential conclusion is perfectly translated. The mathematical expression '2*k + 1' and the existential quantification over integer k are identical in meaning between the natural language and Lean formalization."]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "lemma"}, "l2": {"id": "l2", "natural_language": "Then n^2 = (2k + 1)^2 = 4k^2 + 4k + 1.", "statement": "We assume:\n\u2022 n is an odd integer [tc_1];\n\u2022 There exists an integer k such that n = 2*k + 1 [l1].\nTherefore, we conclude:\n\u2022 For the integer k from [l1], n^2 = 4*k^2 + 4*k + 1 [l2].", "dependencies": ["tc_1", "l1"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l2\n  (n : \u2124) (k : \u2124)\n  (tc_1 : Odd n)\n  (l1 : n = 2 * k + 1) :\n  n^2 = 4 * k^2 + 4 * k + 1 := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l2\n  (n : \u2124) (k : \u2124)\n  (tc_1 : Odd n)\n  (l1 : n = 2 * k + 1) :\n  n^2 = 4 * k^2 + 4 * k + 1 := by\n  have h_main : n^2 = 4 * k^2 + 4 * k + 1 := by\n    rw [l1]\n    ring_nf\n    <;>\n    (try norm_num) <;>\n    (try ring_nf at *) <;>\n    (try linarith)\n  \n  exact h_main", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The Lean formalization correctly captures all components of the natural language statement. The variable declarations, mathematical relationships, and logical structure are all properly represented. While there is some mathematical redundancy between the 'Odd n' condition and the explicit form 'n = 2*k + 1', this redundancy exists in the natural language statement as well, so the Lean formalization is faithful to the original. The conclusion equation is exactly translated, and the overall theorem structure preserves the logical flow from assumptions to conclusion."]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "lemma"}, "l3": {"id": "l3", "natural_language": "We can factor this as n^2 = 4k(k + 1) + 1.", "statement": "We assume:\n\u2022 n is an odd integer [tc_1];\n\u2022 There exists an integer k such that n = 2*k + 1 [l1];\n\u2022 For the integer k from [l1], n^2 = 4*k^2 + 4*k + 1 [l2].\nTherefore, we conclude:\n\u2022 For the integer k from [l1], n^2 = 4*k*(k + 1) + 1 [l3].", "dependencies": ["tc_1", "l1", "l2"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l3\n  (n : \u2124) (k : \u2124)\n  (tc_1 : Odd n)\n  (l1 : n = 2 * k + 1)\n  (l2 : n^2 = 4 * k^2 + 4 * k + 1) :\n  n^2 = 4 * k * (k + 1) + 1 := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l3\n  (n : \u2124) (k : \u2124)\n  (tc_1 : Odd n)\n  (l1 : n = 2 * k + 1)\n  (l2 : n^2 = 4 * k^2 + 4 * k + 1) :\n  n^2 = 4 * k * (k + 1) + 1 := by\n  have h_main : 4 * k^2 + 4 * k + 1 = 4 * k * (k + 1) + 1 := by\n    have h\u2080 : 4 * k * (k + 1) = 4 * k ^ 2 + 4 * k := by\n      ring\n    linarith\n  \n  have h_final : n^2 = 4 * k * (k + 1) + 1 := by\n    have h\u2081 : n ^ 2 = 4 * k ^ 2 + 4 * k + 1 := l2\n    have h\u2082 : 4 * k ^ 2 + 4 * k + 1 = 4 * k * (k + 1) + 1 := h_main\n    linarith\n  \n  exact h_final", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The Lean formalization correctly captures all the logical and mathematical content from the natural language. The transformation from existential quantification to direct assumption of a specific k is a standard and valid logical technique (skolemization). All mathematical equations, the odd integer condition, and the logical flow from premises to conclusion are accurately represented. The algebraic relationship between l2 and l3 is mathematically sound."]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "lemma"}, "l4": {"id": "l4", "natural_language": "Now, either k is even or k is odd. If k is even, then k + 1 is odd, and if k is odd, then k + 1 is even. In either case, k(k + 1) is even, so k(k + 1) = 2m for some integer m.", "statement": "We assume:\n\u2022 n is an odd integer [tc_1];\n\u2022 There exists an integer k such that n = 2*k + 1 [l1];\n\u2022 For the integer k from [l1], n^2 = 4*k^2 + 4*k + 1 [l2];\n\u2022 For the integer k from [l1], n^2 = 4*k*(k + 1) + 1 [l3].\nTherefore, we conclude:\n\u2022 For the integer k from [l1], k * (k + 1) is an even number, which means there exists an integer m such that k * (k + 1) = 2*m [l4].", "dependencies": ["tc_1", "l1", "l2", "l3"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l4\n  (n k : \u2124)\n  (tc_1 : Odd n)\n  (l1 : n = 2 * k + 1)\n  (l2 : n^2 = 4 * k^2 + 4 * k + 1)\n  (l3 : n^2 = 4 * k * (k + 1) + 1) :\n  Even (k * (k + 1)) := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l4\n  (n k : \u2124)\n  (tc_1 : Odd n)\n  (l1 : n = 2 * k + 1)\n  (l2 : n^2 = 4 * k^2 + 4 * k + 1)\n  (l3 : n^2 = 4 * k * (k + 1) + 1) :\n  Even (k * (k + 1)) := by\n  have h_main : Even (k * (k + 1)) := by\n    have h : k % 2 = 0 \u2228 k % 2 = 1 := by\n      have : k % 2 = 0 \u2228 k % 2 = 1 := by\n        have h\u2081 : k % 2 = 0 \u2228 k % 2 = 1 := by\n          omega\n        exact h\u2081\n      exact this\n    -- Case analysis on whether k is even or odd\n    cases h with\n    | inl h =>\n      -- Case: k is even\n      have h\u2081 : \u2203 m : \u2124, k = 2 * m := by\n        use k / 2\n        have h\u2082 : k % 2 = 0 := h\n        have h\u2083 : k = 2 * (k / 2) := by\n          have h\u2084 := Int.emod_add_ediv k 2\n          omega\n        exact h\u2083\n      -- Since k is even, k * (k + 1) is even\n      obtain \u27e8m, hm\u27e9 := h\u2081\n      have h\u2082 : k * (k + 1) = 2 * (m * (k + 1)) := by\n        rw [hm]\n        ring_nf\n        <;> simp [mul_assoc]\n        <;> ring_nf\n        <;> omega\n      have h\u2083 : Even (k * (k + 1)) := by\n        rw [h\u2082]\n        -- 2 * (m * (k + 1)) is clearly even\n        exact \u27e8m * (k + 1), by ring\u27e9\n      exact h\u2083\n    | inr h =>\n      -- Case: k is odd\n      have h\u2081 : \u2203 m : \u2124, k + 1 = 2 * m := by\n        use (k + 1) / 2\n        have h\u2082 : (k + 1) % 2 = 0 := by\n          have h\u2083 : k % 2 = 1 := h\n          omega\n        have h\u2083 : k + 1 = 2 * ((k + 1) / 2) := by\n          have h\u2084 := Int.emod_add_ediv (k + 1) 2\n          omega\n        exact h\u2083\n      -- Since k + 1 is even, k * (k + 1) is even\n      obtain \u27e8m, hm\u27e9 := h\u2081\n      have h\u2082 : k * (k + 1) = 2 * (k * m) := by\n        rw [hm]\n        ring_nf\n        <;> simp [mul_assoc]\n        <;> ring_nf\n        <;> omega\n      have h\u2083 : Even (k * (k + 1)) := by\n        rw [h\u2082]\n        -- 2 * (k * m) is clearly even\n        exact \u27e8k * m, by ring\u27e9\n      exact h\u2083\n  exact h_main", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 2}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The variable declarations and basic assumptions are correctly formalized. The oddness condition and the relationship n = 2*k + 1 are properly captured.", "The mathematical relationships for n^2 are accurately translated with correct algebraic expressions and proper operator precedence.", "The conclusion about evenness is correctly formalized. The Lean 'Even' predicate is mathematically equivalent to the natural language description of 'there exists an integer m such that k * (k + 1) = 2*m'."]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "lemma"}, "l5": {"id": "l5", "natural_language": "Therefore n^2 = 4(2m) + 1 = 8m + 1", "statement": "We assume:\n\u2022 n is an odd integer [tc_1];\n\u2022 There exists an integer k such that n = 2*k + 1 [l1];\n\u2022 For the integer k from [l1], n^2 = 4*k^2 + 4*k + 1 [l2];\n\u2022 For the integer k from [l1], n^2 = 4*k*(k + 1) + 1 [l3];\n\u2022 For the integer k from [l1], there exists an integer m such that k * (k + 1) = 2*m [l4].\nTherefore, we conclude:\n\u2022 For the integer m from [l4], n^2 = 8*m + 1 [l5].", "dependencies": ["tc_1", "l1", "l2", "l3", "l4"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l5\n  (n k m : \u2124)\n  (tc_1 : Odd n)\n  (l1 : n = 2 * k + 1)\n  (l2 : n^2 = 4 * k^2 + 4 * k + 1)\n  (l3 : n^2 = 4 * k * (k + 1) + 1)\n  (l4 : k * (k + 1) = 2 * m) :\n  n^2 = 8 * m + 1 := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem l5\n  (n k m : \u2124)\n  (tc_1 : Odd n)\n  (l1 : n = 2 * k + 1)\n  (l2 : n^2 = 4 * k^2 + 4 * k + 1)\n  (l3 : n^2 = 4 * k * (k + 1) + 1)\n  (l4 : k * (k + 1) = 2 * m) :\n  n^2 = 8 * m + 1 := by\n  have h_main : n^2 = 8 * m + 1 := by\n    have h5 : n^2 = 4 * (k * (k + 1)) + 1 := by\n      calc\n        n ^ 2 = 4 * k * (k + 1) + 1 := l3\n        _ = 4 * (k * (k + 1)) + 1 := by ring\n    have h6 : n^2 = 4 * (2 * m) + 1 := by\n      calc\n        n ^ 2 = 4 * (k * (k + 1)) + 1 := h5\n        _ = 4 * (2 * m) + 1 := by\n          rw [l4]\n          <;> ring\n    calc\n      n ^ 2 = 4 * (2 * m) + 1 := h6\n      _ = 8 * m + 1 := by ring\n  exact h_main", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The Lean formalization correctly captures that n is an odd integer using the Odd predicate", "The equation n = 2*k + 1 is identical in both versions", "The equation n^2 = 4*k^2 + 4*k + 1 is identical in both versions", "The equation n^2 = 4*k*(k + 1) + 1 is identical in both versions", "The existential quantification over m is properly handled by treating m as a parameter in the theorem statement, which is standard practice in Lean", "The conclusion n^2 = 8*m + 1 is identical in both versions"]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "lemma"}, "ts_1": {"id": "ts_1", "natural_language": "which means n^2 \\equiv 1 \\pmod{8}.", "statement": "We assume:\n\u2022 n is an odd integer [tc_1];\n\u2022 There exists an integer k such that n = 2*k + 1 [l1];\n\u2022 For the integer k from [l1], n^2 = 4*k^2 + 4*k + 1 [l2];\n\u2022 For the integer k from [l1], n^2 = 4*k*(k + 1) + 1 [l3];\n\u2022 For the integer k from [l1], there exists an integer m such that k * (k + 1) = 2*m [l4];\n\u2022 For the integer m from [l4], n^2 = 8*m + 1 [l5].\nTherefore, we conclude:\n\u2022 n^2 \u2261 1 [MOD 8] [ts_1].", "dependencies": ["tc_1", "l1", "l2", "l3", "l4", "l5"], "formalization": {"lean_code": "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem ts_1\n  (n k m : \u2124)\n  (tc_1 : Odd n)\n  (l1 : n = 2 * k + 1)\n  (l2 : n^2 = 4 * k^2 + 4 * k + 1)\n  (l3 : n^2 = 4 * k * (k + 1) + 1)\n  (l4 : k * (k + 1) = 2 * m)\n  (l5 : n^2 = 8 * m + 1) :\n  n^2 % 8 = 1 := by sorry", "lean_pass": true, "error_msg": [], "tries": 1}, "solved_lemma": {"lean_code": "import Mathlib\nimport Aesop\nset_option maxHeartbeats 0\nopen BigOperators Real Nat Topology Rat Filter\n\ntheorem ts_1\n  (n k m : \u2124)\n  (tc_1 : Odd n)\n  (l1 : n = 2 * k + 1)\n  (l2 : n^2 = 4 * k^2 + 4 * k + 1)\n  (l3 : n^2 = 4 * k * (k + 1) + 1)\n  (l4 : k * (k + 1) = 2 * m)\n  (l5 : n^2 = 8 * m + 1) :\n  n^2 % 8 = 1 := by\n  have h_main : n^2 % 8 = 1 := by\n    have h\u2081 : n^2 = 8 * m + 1 := l5\n    have h\u2082 : n^2 % 8 = 1 := by\n      rw [h\u2081]\n      -- Simplify (8 * m + 1) % 8\n      have h\u2083 : (8 * m + 1 : \u2124) % 8 = 1 := by\n        have h\u2084 : (8 * m : \u2124) % 8 = 0 := by\n          -- 8 * m is divisible by 8, so (8 * m) % 8 = 0\n          simp [Int.mul_emod, Int.emod_emod]\n        -- (8 * m + 1) % 8 = (0 + 1) % 8 = 1\n        omega\n      exact h\u2083\n    exact h\u2082\n  exact h_main", "lean_pass": true, "lean_verify": true, "error_msg": [], "tries": 1}, "score": {"semantic_score": 1.0, "semantic_feedback": ["The Lean formalization correctly captures all the mathematical content and logical structure from the natural language. While the natural language uses existential quantification for k and m, the Lean version treats them as parameters, which is logically equivalent and appropriate for theorem proving. All equations, conditions, and the final conclusion are accurately represented. The modular arithmetic notation n^2 % 8 = 1 correctly translates n^2 \u2261 1 [MOD 8]."]}, "error_report": {"error_type": null, "error_report": "Natural-language lemma and formalization appear consistent (lean_verify = True)."}, "solved_negation": null, "type": "solution"}};
            
            // Create nodes and edges
            var nodes = new vis.DataSet([{"id": "tc_1", "label": "tc_1", "color": {"background": "#eba0a0", "border": "#00ff00", "highlight": {"background": "#eba0a0", "border": "#00ff00"}}, "shape": "box", "size": 30, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l1", "label": "l1", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l2", "label": "l2", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l3", "label": "l3", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l4", "label": "l4", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "l5", "label": "l5", "color": {"background": "#8dafcc", "border": "#00ff00", "highlight": {"background": "#8dafcc", "border": "#00ff00"}}, "shape": "dot", "size": 25, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}, {"id": "ts_1", "label": "ts_1", "color": {"background": "#a3c2a8", "border": "#00ff00", "highlight": {"background": "#a3c2a8", "border": "#00ff00"}}, "shape": "star", "size": 40, "font": {"size": 14, "color": "#000000"}, "labelHighlightBold": false, "borderWidth": 3, "chosen": false}]);
            var edges = new vis.DataSet([{"from": "tc_1", "to": "l1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "l2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "l3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "l4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "l5", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "tc_1", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "l2", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "l3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "l4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "l5", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l1", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l2", "to": "l3", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l2", "to": "l4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l2", "to": "l5", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l2", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l3", "to": "l4", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l3", "to": "l5", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l3", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l4", "to": "l5", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l4", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}, {"from": "l5", "to": "ts_1", "arrows": "to", "color": {"color": "#666666", "highlight": "#666666", "hover": "#666666"}, "width": 2}]);
            
            // Create network
            var container = document.getElementById('mynetwork');
            var data = {
                nodes: nodes,
                edges: edges
            };
            
            var options = {
                physics: {
                    enabled: true,
                    solver: 'hierarchicalRepulsion',
                    hierarchicalRepulsion: {
                        centralGravity: 0.0,
                        springLength: 200,
                        springConstant: 0.01,
                        nodeDistance: 150,
                        damping: 0.09
                    }
                },
                edges: {
                    smooth: {
                        type: 'continuous',
                        forceDirection: 'none'
                    },
                    color: {
                        color: '#666666',
                        highlight: '#666666',
                        hover: '#666666'
                    },
                    width: 2
                },
                interaction: {
                    hover: true,
                    tooltipDelay: 100,
                    navigationButtons: true,
                    keyboard: true
                },
                nodes: {
                    font: {
                        size: 14,
                        color: '#000000'
                    },
                    labelHighlightBold: false,
                    chosen: false,
                    shapeProperties: {
                        useBorderWithImage: false
                    },
                    scaling: {
                        label: {
                            enabled: true,
                            min: 8,
                            max: 20,
                            maxVisible: 20,
                            drawThreshold: 5
                        }
                    }
                }
            };
            
            var network = new vis.Network(container, data, options);
            
            // Format field value for display
            function formatFieldValue(value, fieldName) {
                if (value === null || value === undefined) {
                    return 'N/A';
                }
                
                // Handle objects (dictionaries) as sub-boxes
                if (typeof value === 'object' && !Array.isArray(value)) {
                    var html = '';
                    for (var key in value) {
                        if (value.hasOwnProperty(key)) {
                            var subValue = value[key];
                            var subValueStr = '';
                            
                            if (typeof subValue === 'object' &&
                                    !Array.isArray(subValue)) {
                                // Nested object - show as JSON
                                subValueStr = JSON.stringify(subValue, null, 2);
                            } else if (Array.isArray(subValue)) {
                                // Array - show as JSON
                                subValueStr = JSON.stringify(subValue, null, 2);
                            } else {
                                // Primitive value
                                subValueStr = String(subValue);
                            }
                            
                            // Replace escaped newlines and tabs with actual characters
                            subValueStr = subValueStr.replace(/\\n/g, '\n');
                            subValueStr = subValueStr.replace(/\\t/g, '\t');
                            subValueStr = subValueStr.replace(/\t/g, '\t');
                            
                            html += '<div class="sub-dict">';
                            html += '<div class="sub-dict-title">' + key + '</div>';
                            html += '<div class="sub-dict-content">' + subValueStr + '</div>';
                            html += '</div>';
                        }
                    }
                    return html;
                }
                
                // Convert to string for primitive values and arrays
                var strValue = String(value);
                
                // Handle arrays
                if (Array.isArray(value)) {
                    strValue = JSON.stringify(value, null, 2);
                }
                
                // Replace escaped newlines and tabs with actual characters
                strValue = strValue.replace(/\\n/g, '\n');
                strValue = strValue.replace(/\\t/g, '\t');
                strValue = strValue.replace(/\t/g, '\t');
                
                return strValue;
            }
            
            // Handle node click events
            network.on("click", function(params) {
                if (params.nodes.length > 0) {
                    var nodeId = params.nodes[0];
                    var info = nodeInfo[nodeId];
                    
                    if (info) {
                        var html = '<div class="info-header">';
                        html += '<h2>' + nodeId + '</h2>';
                        var nodeType = info.type || 'unknown';
                        var capitalizedType = nodeType.charAt(0).toUpperCase() +
                            nodeType.slice(1);
                        html += '<div class="node-type">Type: ' + capitalizedType +
                            '</div>';
                        html += '</div>';
                        
                        // Add all fields
                        for (var key in info) {
                            if (key === 'type' || key === 'id') continue;
                            
                            var fieldName = key.replace(/_/g, ' ')
                                .replace(/\b\w/g, function(l) {
                                    return l.toUpperCase();
                                });
                            var fieldValue = formatFieldValue(info[key], fieldName);
                            
                            if (fieldValue && fieldValue !== 'N/A') {
                                // Special formatting for code fields
                                var isCode = key.includes('code') ||
                                    key.includes('lean') ||
                                    key.includes('statement');
                                
                                html += '<div class="field-group">';
                                html += '<div class="field-name">' + fieldName +
                                    '</div>';
                                html += '<div class="field-value' +
                                    (isCode ? ' code' : '') + '">' +
                                    fieldValue + '</div>';
                                html += '</div>';
                            }
                        }
                        
                        document.getElementById('info-content')
                            .innerHTML = html;
                    }
                }
            });
            
            // Toggle panel function
            function togglePanel() {
                var panel = document.getElementById('info-panel');
                panel.classList.toggle('hidden');
                
                // Resize network when panel is toggled
                setTimeout(function() {
                    network.fit();
                }, 300);
            }
            
            // Initial network fit
            network.once('stabilized', function() {
                network.fit();
            });
            
            // Resizable panels functionality
            function makeResizable() {
                const verticalResizer = document.getElementById('vertical-resizer');
                const horizontalResizer = document.getElementById('horizontal-resizer');
                const proofPanel = document.getElementById('proof-str-panel');
                const graphContainer = document.getElementById('graph-container');
                const infoPanel = document.getElementById('info-panel');
                const leftPanel = document.getElementById('left-panel');
                
                let isVerticalResizing = false;
                let isHorizontalResizing = false;
                
                // Vertical resizer (between proof panel and graph)
                verticalResizer.addEventListener('mousedown', function(e) {
                    isVerticalResizing = true;
                    document.addEventListener('mousemove', verticalResize);
                    document.addEventListener('mouseup', stopVerticalResize);
                    e.preventDefault();
                });
                
                function verticalResize(e) {
                    if (!isVerticalResizing) return;
                    
                    const containerHeight = leftPanel.offsetHeight;
                    const newHeight = e.clientY - leftPanel.offsetTop;
                    const minHeight = 100;
                    const maxHeight = containerHeight - 100;
                    
                    if (newHeight >= minHeight && newHeight <= maxHeight) {
                        proofPanel.style.height = newHeight + 'px';
                        graphContainer.style.height = (containerHeight - newHeight) + 'px';
                        network.fit();
                    }
                }
                
                function stopVerticalResize() {
                    isVerticalResizing = false;
                    document.removeEventListener('mousemove', verticalResize);
                    document.removeEventListener('mouseup', stopVerticalResize);
                }
                
                // Horizontal resizer (between left and right panels)
                horizontalResizer.addEventListener('mousedown', function(e) {
                    isHorizontalResizing = true;
                    document.addEventListener('mousemove', horizontalResize);
                    document.addEventListener('mouseup', stopHorizontalResize);
                    e.preventDefault();
                });
                
                function horizontalResize(e) {
                    if (!isHorizontalResizing) return;
                    
                    const containerWidth = document.querySelector('.container').offsetWidth;
                    const newWidth = e.clientX - leftPanel.offsetLeft;
                    const minWidth = 300;
                    const maxWidth = containerWidth - 300;
                    
                    if (newWidth >= minWidth && newWidth <= maxWidth) {
                        leftPanel.style.flex = 'none';
                        leftPanel.style.width = newWidth + 'px';
                        infoPanel.style.width = (containerWidth - newWidth) + 'px';
                        network.fit();
                    }
                }
                
                function stopHorizontalResize() {
                    isHorizontalResizing = false;
                    document.removeEventListener('mousemove', horizontalResize);
                    document.removeEventListener('mouseup', stopHorizontalResize);
                }
            }
            
            // Initialize resizable panels
            makeResizable();
        </script>
    </body>
    </html>
    